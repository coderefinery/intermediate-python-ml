

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NumPy and Pandas for biological data handling documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js"></script>
      <script src="_static/doctools.js"></script>
      <script src="_static/sphinx_highlight.js"></script>
      <script src="_static/clipboard.min.js"></script>
      <script src="_static/copybutton.js"></script>
      <script src="_static/minipres.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="_static/togglebutton.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
      <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
      <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
      <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
      <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            NumPy and Pandas for biological data handling
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Numpy for handling biological datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-0.Numpy_for_bioinformatics">Lesson plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-1.numpy_intro">Introduction to NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-2.NumPy_Data_Types">NumPy Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-3.Indexing_and_Slicing">Array Indexing and Slicing</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-4.Advance_indexing_filtering">NumPy Boolean Masking and Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-5.Essential_array_operations">Essential Array Operations with NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-6.Vectorized_Operations_in_NumPy">Vectorized Operations in NumPy: Beyond Python Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-6.1.Numpy_hands_on">Hands-on: RNA Expression Analysis - alternative method</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pandas for handling biological datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-7.Pandas_lesson plan">Lesson plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-8.Introduction_to_pandas">Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-9.Pandas_data_import_export">Data Import and Export in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-10.DataFrame_Manipulation">DataFrame Manipulation &amp; Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-11.Pandas_indexing_slicing">Indexing, Selection &amp; Slicing in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-12.Handling_Missing_Data">Handling Missing Data in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-13.Merging_DataFrames">Merging DataFrames in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-14.Pandas_summary_stats">Summary Statistics &amp; Aggregations in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-15.Hands-on_expression_count_analysis">Hands-on: RNA Expression Analysis - alternative method</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">NumPy and Pandas for biological data handling</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">NumPy and Pandas for biological data handling  documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/content/blob/main/content/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="numpy-and-pandas-fundamentals-for-handling-biological-datasets">
<h1>NumPy and Pandas fundamentals for handling biological datasets<a class="headerlink" href="#numpy-and-pandas-fundamentals-for-handling-biological-datasets" title="Link to this heading"></a></h1>
<div class="admonition-prerequisites prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Prerequisites</p>
<ul class="simple">
<li><p>Programming Fundamentals in Python</p>
<ul>
<li><p>Basic Python syntax and data structures</p></li>
<li><p>Functions and control flow</p></li>
<li><p>File handling in Python</p></li>
<li><p>Experience with Python IDEs and Jupyter notebooks</p></li>
</ul>
</li>
<li><p>Basic Biology Knowledge</p>
<ul>
<li><p>Basic genomics terminology</p></li>
<li><p>Familiarity with common bioinformatics file formats (FASTA, FASTQ)</p></li>
</ul>
</li>
</ul>
</div>
<section id="who-is-the-course-for">
<h2>Who is the course for?<a class="headerlink" href="#who-is-the-course-for" title="Link to this heading"></a></h2>
<p>Bioinformaticians and genomics researchers who want to enhance their data analysis capabilities by mastering NumPy and Pandas for efficient processing of genomic datasets</p>
</section>
<section id="about-the-course">
<h2>About the course<a class="headerlink" href="#about-the-course" title="Link to this heading"></a></h2>
<section id="overall-course-objective">
<h3>Overall Course Objective<a class="headerlink" href="#overall-course-objective" title="Link to this heading"></a></h3>
<p>By the end of this course, students will be able to effectively utilize NumPy and Pandas libraries to manipulate, analyze, and process complex numerical and tabular data in Python, demonstrating proficiency in advanced array operations, data structures, and data manipulation techniques. Additionally, students will apply these skills to real-world bioinformatics problems, gaining practical experience in genomics data analysis and handling.</p>
</section>
<section id="specific-learning-objectives">
<h3>Specific Learning Objectives<a class="headerlink" href="#specific-learning-objectives" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>After completing the NumPy section and hands-on exercises, students will be able to:</p>
<ul class="simple">
<li><p>Explain the purpose and advantages of using NumPy in scientific computing and data analysis</p></li>
<li><p>Create, manipulate, and efficiently implement NumPy arrays through advanced techniques including indexing, sorting, splitting, vectorized operations, and broadcasting</p></li>
</ul>
</li>
<li><p>After completing the Pandas section and hands-on exercises, students will be able to:</p>
<ul class="simple">
<li><p>Understand the relationship between Pandas and NumPy, and effectively use Pandas Series and DataFrames for data analysis</p></li>
<li><p>Perform advanced data manipulation techniques including indexing, filtering, handling missing data, and combining DataFrames through merging and concatenation</p></li>
</ul>
</li>
</ol>
</section>
<section id="overall-time-schedule">
<h3>Overall time schedule<a class="headerlink" href="#overall-time-schedule" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Numpy for Bioinformatics</p></td>
<td><p>3 Hours</p></td>
</tr>
<tr class="row-even"><td><p>Pandas for Bioinformatics</p></td>
<td><p>3 Hours</p></td>
</tr>
</tbody>
</table>
<div class="toctree-wrapper compound">
<span id="document-0.Numpy_for_bioinformatics"></span><section id="lesson-plan">
<h4>Lesson plan<a class="headerlink" href="#lesson-plan" title="Link to this heading"></a></h4>
<section id="overall-objectives">
<h5>Overall objectives<a class="headerlink" href="#overall-objectives" title="Link to this heading"></a></h5>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ol class="arabic simple">
<li><p>Understand the fundamentals of NumPy and its importance in scientific computing and bioinformatics</p></li>
<li><p>Develop proficiency in creating, manipulating, and performing operations on NumPy arrays</p></li>
<li><p>Apply NumPy’s computational capabilities to solve common bioinformatics data manipulation tasks</p></li>
<li><p>Compare the efficiency and syntax advantages of NumPy versus standard Python for numerical computation</p></li>
</ol>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>5 min teaching
</pre></div>
</div>
</div>
</section>
<section id="specific-objectives">
<h5>Specific Objectives<a class="headerlink" href="#specific-objectives" title="Link to this heading"></a></h5>
<p>By the end of this workshop, participants will be able to:</p>
<ol class="arabic simple">
<li><p>NumPy Foundations</p>
<ul class="simple">
<li><p>Explain NumPy’s purpose and advantages over standard Python lists</p></li>
<li><p>Describe how NumPy leverages contiguous memory allocation for improved performance</p></li>
</ul>
</li>
<li><p>Array Creation and Structure</p>
<ul class="simple">
<li><p>Create NumPy arrays of different dimensions from Python lists and other data sources</p></li>
<li><p>Generate arrays using built-in functions like <code class="docutils literal notranslate"><span class="pre">arange()</span></code>, <code class="docutils literal notranslate"><span class="pre">zeros()</span></code>, <code class="docutils literal notranslate"><span class="pre">ones()</span></code>, and <code class="docutils literal notranslate"><span class="pre">random.random()</span></code></p></li>
<li><p>Examine array attributes such as <code class="docutils literal notranslate"><span class="pre">shape</span></code>, <code class="docutils literal notranslate"><span class="pre">ndim</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, and <code class="docutils literal notranslate"><span class="pre">dtype</span></code></p></li>
</ul>
</li>
<li><p>Data Types</p>
<ul class="simple">
<li><p>Contrast Python and NumPy data types for numerical computation</p></li>
<li><p>Select appropriate NumPy data types for optimizing memory usage and computational precision</p></li>
<li><p>Understand and manage type coercion in array operations</p></li>
</ul>
</li>
<li><p>Indexing and Selection</p>
<ul class="simple">
<li><p>Access and manipulate array elements using basic indexing</p></li>
<li><p>Extract subsets of data using slicing operations in multiple dimensions</p></li>
<li><p>Apply boolean masking and advanced filtering techniques to arrays</p></li>
</ul>
</li>
<li><p>Array Operations</p>
<ul class="simple">
<li><p>Reshape and restructure arrays to better match analytical needs</p></li>
<li><p>Combine arrays using concatenation and splitting operations</p></li>
<li><p>Generate descriptive statistics using NumPy’s built-in functions</p></li>
</ul>
</li>
<li><p>Vectorization and Performance</p>
<ul class="simple">
<li><p>Implement vectorized operations to replace traditional Python loops</p></li>
<li><p>Apply broadcasting to perform operations between arrays of different shapes</p></li>
<li><p>Optimize calculations for working with large biological datasets</p></li>
</ul>
</li>
</ol>
</section>
</section>
<span id="document-1.numpy_intro"></span><section id="introduction-to-numpy">
<h4>Introduction to NumPy<a class="headerlink" href="#introduction-to-numpy" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>What is NumPy and why it’s important for bioinformatics</p></li>
<li><p>Performance advantages over Python lists</p></li>
<li><p>Foundation for other scientific libraries</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 15 min</p></li>
<li><p>Demo: 5 min</p></li>
<li><p>Exercise : 0 min (exercise would be skipped during live sessions)</p></li>
</ul>
</div>
<section id="what-is-numpy">
<h5>What is <code class="docutils literal notranslate"><span class="pre">numpy</span></code>?<a class="headerlink" href="#what-is-numpy" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code> is short for “Numerical Python”</p></li>
<li><p>Core python library for scientific computing</p></li>
<li><p>Useful for processing large quantities of same-type data</p></li>
<li><p>Foundation for:</p>
<ul>
<li><p>Data manipulation, analysis and visualization libraries (<code class="docutils literal notranslate"><span class="pre">Pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code>)</p></li>
<li><p>Machine learning libraries (<code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>, <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>, <code class="docutils literal notranslate"><span class="pre">PyTorch</span></code>)</p></li>
</ul>
</li>
<li><p>NumPy operations are written in compiled C, significantly speeding up mathematical operations</p></li>
</ul>
<p><img alt="Array programming with NumPy" src="_images/image.png" /></p>
<p><a class="reference external" href="https://doi.org/10.1038/s41586-020-2649-2">Ref: Array programming with NumPy</a></p>
</section>
<section id="why-numpy-is-essential-for-bioinformatics">
<h5>Why NumPy is Essential for Bioinformatics<a class="headerlink" href="#why-numpy-is-essential-for-bioinformatics" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Bioinformatics involves processing and analyzing vast amounts of biological data, from genomic sequences to protein structures</p></li>
<li><p>NumPy’s efficient N-dimensional arrays allow for fast and memory-efficient processing of these large datasets</p>
<ul>
<li><p>C-optimized operations: NumPy’s compiled C backend makes processing of big-data feasible without having C programming knowledge</p></li>
<li><p>Reduced memory footprint help optimize the big-data processing: <a class="reference external" href="https://dl.acm.org/doi/10.1145/3437359.3465562">Accelerating Key Bioinformatics Tasks 100-fold by Improving Memory Access</a></p></li>
</ul>
</li>
<li><p>Run statistical analysis/operations using Biological Data effectively (low barrier to entry)</p></li>
<li><p>Numpy is essential for Python-based machine learning applications on biological datasets</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In essence, NumPy bridges the gap between high-level Python programming and the performance requirements of modern bioinformatics, making it possible to analyze the increasingly large datasets generated by modern biological research techniques.</p>
</div>
</section>
<section id="numpy-arrays-vs-python-lists">
<h5>NumPy Arrays vs Python Lists<a class="headerlink" href="#numpy-arrays-vs-python-lists" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Lists are data structures used to store collections of elements</p></li>
<li><p>NumPy arrays enforce a single data type for all elements</p></li>
<li><p>Benefits of NumPy arrays:</p>
<ul>
<li><p>Homogeneity removes need for type checking during operations</p></li>
<li><p>Contiguous memory allocation (faster than Python’s scattered storage)</p></li>
<li><p>Vectorization allows operations on entire arrays without loops</p></li>
<li><p>Rich set of mathematical functions and operations</p></li>
</ul>
</li>
</ul>
<p><img alt="NumPy Arrays" src="_images/image-1.png" /></p>
</section>
<section id="creating-numpy-arrays">
<h5>Creating NumPy Arrays<a class="headerlink" href="#creating-numpy-arrays" title="Link to this heading"></a></h5>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<p class="rubric" id="d-arrays-from-lists">1D Arrays from lists</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create from list</span>
<span class="n">py_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">np_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">py_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>  <span class="c1"># Output: array([1, 2, 3, 4])</span>
</pre></div>
</div>
<p class="rubric" id="d-arrays-matrices">2D Arrays (matrices)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 2D array</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">list_of_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
<span class="n">np_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list_of_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>array([[0, 1, 2, 3],
       [0, 1, 2, 3],
       [0, 1, 2, 3]])
</pre></div>
</div>
</div>
<section id="creating-arrays-from-scratch">
<h6>Creating arrays from scratch<a class="headerlink" href="#creating-arrays-from-scratch" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Range of values</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Output: array([1, 3, 5, 7, 9])</span>

<span class="c1"># Arrays of zeros</span>
<span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>     <span class="c1"># Output: array([[0., 0.], [0., 0.]])</span>

<span class="c1"># Arrays of ones</span>
<span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>           <span class="c1"># Output: array([1., 1., 1., 1., 1.])</span>

<span class="c1"># Random arrays</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Random values between 0 and 1</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="examining-numpy-array-structure-and-storage">
<h5>Examining numpy array structure and storage<a class="headerlink" href="#examining-numpy-array-structure-and-storage" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>NumPy arrays come with several attributes that provide important information about their structure and data storage.</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>A tuple of integers representing the size of each dimension of the array</p></td>
<td><p>(3, 4) (2D array with 3 rows and 4 columns)</p></td>
<td><p>Understands the layout and number of elements within the array.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ndim</span></code></p></td>
<td><p>An integer indicating the dimensionality of the array (number of dimensions)</p></td>
<td><p>2 (for a 2D array), 1 (for a vector)</p></td>
<td><p>Clarifies how many axes are used to access elements.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">size</span></code></p></td>
<td><p>An integer representing the total number of elements within the array</p></td>
<td><p>12 (for a 2D array with shape (3, 4))</p></td>
<td><p>Provides a quick way to determine the total number of elements.</p></td>
</tr>
</tbody>
</table>
<section id="exercise-numpy-array-creation-exercises">
<h6>Exercise: NumPy Array Creation Exercises<a class="headerlink" href="#exercise-numpy-array-creation-exercises" title="Link to this heading"></a></h6>
<div class="admonition-exercise-1-creating-arrays-from-scratch exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise 1: Creating Arrays from Scratch</p>
<p>In this exercise, you’ll practice creating NumPy arrays using different built-in functions.</p>
<p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Create a 1D array containing integers from 5 to 50 with a step size of 5 using <code class="docutils literal notranslate"><span class="pre">np.arange()</span></code>.</p></li>
<li><p>Create an array of 8 evenly spaced values between 0 and 1 (inclusive) using <code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code>.</p></li>
<li><p>Create an array of 10 random integers between 1 and 100 using <code class="docutils literal notranslate"><span class="pre">np.random.randint()</span></code>.</p></li>
<li><p>Create an array of shape (3,3) filled with the value 3.14 using <code class="docutils literal notranslate"><span class="pre">np.full()</span></code>.</p></li>
</ol>
<p><strong>Expected Output:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># After task 1</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="c1"># After task 2</span>
<span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.14285714</span><span class="p">,</span> <span class="mf">0.28571429</span><span class="p">,</span> <span class="mf">0.42857143</span><span class="p">,</span> <span class="mf">0.57142857</span><span class="p">,</span>
       <span class="mf">0.71428571</span><span class="p">,</span> <span class="mf">0.85714286</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">])</span>

<span class="c1"># After task 3 (your values will differ due to randomness)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">51</span><span class="p">])</span>

<span class="c1"># After task 4</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">]])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Test <code class="docutils literal notranslate"><span class="pre">shape</span></code>, <code class="docutils literal notranslate"><span class="pre">ndim</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code> attributes of the Numpy arrays created in above tasks</p></li>
</ul>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exercise 1: Creating Arrays from Scratch&quot;</span><span class="p">)</span>

<span class="c1"># Task 1: Create array from 5 to 50 with step size of 5</span>
<span class="n">array1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Task 1 - Array with integers from 5 to 50, step 5:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Task 2: Create array of 8 evenly spaced values between 0 and 1</span>
<span class="n">array2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Task 2 - 8 evenly spaced values between 0 and 1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Task 3: Create array of 10 random integers between 1 and 100</span>
<span class="n">array3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Task 3 - 10 random integers between 1 and 100:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Task 4: Create 3x3 array filled with 3.14</span>
<span class="n">array4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Task 4 - 3x3 array filled with 3.14:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">array4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<span id="document-2.NumPy_Data_Types"></span><section id="numpy-data-types">
<h4>NumPy Data Types<a class="headerlink" href="#numpy-data-types" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Explain the fundamental concept of data types and their importance in computing</p></li>
<li><p>Compare and contrast Python’s general data types with NumPy’s specialized data types</p></li>
<li><p>Identify the key NumPy data types relevant to bioinformatics applications</p></li>
<li><p>Apply data type conversion techniques to optimize NumPy arrays</p></li>
<li><p>Explore different NumPy data types for different bioinformatics use cases</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 15 min</p></li>
<li><p>Demo: 10 min</p></li>
</ul>
</div>
<section id="introduction-to-data-types">
<h5>Introduction to Data Types<a class="headerlink" href="#introduction-to-data-types" title="Link to this heading"></a></h5>
<p>Data types are fundamental categories that define how computers interpret and store information in memory</p>
<p><img alt="alt text" src="_images/image-2.png" /></p>
<p><strong>Data types directly impact:</strong></p>
<ul class="simple">
<li><p>Program correctness</p>
<ul>
<li><p>Inappropriate data types can lead to errors or unexpected behavior</p></li>
</ul>
</li>
<li><p>Computational performance</p>
<ul>
<li><p>Different data types have different processing speeds</p></li>
<li><p>e.g., Choosing appropriate data types helps optimize memory usage</p></li>
</ul>
</li>
</ul>
<p>In scientific computing and bioinformatics specifically, where we often work with large datasets, choosing the right data type becomes even more critical for both accuracy and performance.</p>
</section>
<section id="python-vs-numpy-data-types">
<h5>Python vs NumPy Data Types<a class="headerlink" href="#python-vs-numpy-data-types" title="Link to this heading"></a></h5>
<p>Python and NumPy both provide data type systems, but they serve different purposes and have important distinctions:</p>
<p><img alt="alt text" src="_images/image-3.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This specialization allows NumPy to provide exactly what’s needed for scientific applications without unnecessary overhead. For example, summing a million numbers can be 10-100x faster using NumPy arrays compared to Python lists.</p>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">More info</p>
<details>
<summary>Additional notes</summary>
<ul class="simple">
<li><p>Python vs NumPy - Variety and Focus</p>
<ul>
<li><p>Python data types offer broad versatility for general programming:</p>
<ul>
<li><p>Integers (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Whole numbers without size limitation</p></li>
<li><p>Floating-point numbers (<code class="docutils literal notranslate"><span class="pre">float</span></code>): Decimal numbers</p></li>
<li><p>Strings (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Text data</p></li>
<li><p>Booleans (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): True/False values</p></li>
<li><p>Lists, dictionaries, sets, and Complex data structures</p></li>
</ul>
</li>
<li><p>NumPy data types are specialized for numerical and scientific computing:</p>
<ul>
<li><p>More precise control over numeric representation (int8, int16, int32, int64, etc.)</p></li>
<li><p>Greater variety of floating-point precisions (float16, float32, float64)</p></li>
<li><p>Memory-efficient representations of text and boolean values</p></li>
<li><p>Specialized types for complex numbers and datetime values</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Memory Management:</strong></p>
<p><strong>Python’s approach to memory:</strong></p>
<ul class="simple">
<li><p>Each value comes with extra information (type information, tracking system - reference count)</p></li>
<li><p>Python arranges values wherever it finds room in memory</p></li>
<li><p>It’s like having sticky notes scattered across your desk - flexible but takes extra space</p></li>
</ul>
<p><strong>NumPy’s approach to memory:</strong></p>
<ul class="simple">
<li><p>Values are stored together in one organized block</p></li>
<li><p>Each value has a fixed, predictable size</p></li>
<li><p>It’s like having numbers written in a grid-style notebook - compact and easier to access</p></li>
<li><p>This organization also works better with how your computer naturally processes information</p></li>
</ul>
<p>In bioinformatics, where we might analyze gene expression data with millions of values, NumPy’s memory efficiency becomes critical.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Create a larger dataset for more noticeable timing differences</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000000</span>  <span class="c1"># 10 million elements</span>

<span class="c1"># Create Python list and NumPy array</span>
<span class="n">python_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span>
<span class="n">numpy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

<span class="c1"># Function to multiply each element by 2</span>
<span class="k">def</span><span class="w"> </span><span class="nf">double_python_list</span><span class="p">(</span><span class="n">my_list</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_list</span><span class="p">]</span>

<span class="c1"># Timing the Python list operation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">doubled_list</span> <span class="o">=</span> <span class="n">double_python_list</span><span class="p">(</span><span class="n">python_list</span><span class="p">)</span>
<span class="n">python_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python list processing time: </span><span class="si">{</span><span class="n">python_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Timing the NumPy array operation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">doubled_array</span> <span class="o">=</span> <span class="n">numpy_array</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># Element-wise multiplication</span>
<span class="n">numpy_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy array processing time: </span><span class="si">{</span><span class="n">numpy_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the speed improvement</span>
<span class="n">speedup</span> <span class="o">=</span> <span class="n">python_time</span> <span class="o">/</span> <span class="n">numpy_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy is approximately </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x faster&quot;</span><span class="p">)</span>
</pre></div>
</div>
</details>
</div>
<section id="type-homogeneity">
<h6>Type Homogeneity<a class="headerlink" href="#type-homogeneity" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python collections like lists can contain mixed types:</span>
<span class="n">mixed_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;DNA&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">]</span>  <span class="c1"># Different types in one list</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

<span class="c1"># NumPy arrays enforce type homogeneity:</span>
<span class="c1"># All elements converted to the same type (float64)</span>
<span class="n">np_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;list&#39;&gt; &lt;class &#39;int&#39;&gt; &lt;class &#39;str&#39;&gt; &lt;class &#39;bool&#39;&gt; &lt;class &#39;float&#39;&gt;
float64
</pre></div>
</div>
<p>This homogeneity enables:</p>
<ul class="simple">
<li><p>Predictable memory usage</p></li>
<li><p>Optimized vectorized operations</p></li>
<li><p>Simplified data processing logic</p></li>
</ul>
<p>For bioinformatics applications, this homogeneity helps ensure consistency when processing large datasets of gene expression values, sequence reads, or alignment scores.</p>
</div>
</section>
</section>
<section id="key-numpy-data-types">
<h5>Key NumPy Data Types<a class="headerlink" href="#key-numpy-data-types" title="Link to this heading"></a></h5>
<section id="integer-types">
<h6>Integer Types<a class="headerlink" href="#integer-types" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Stores whole numbers only, no decimals - Integer</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">np.int32</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">np.int64</span></code> (64-bit signed integer):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">np.int32</span></code> Range: -2,147,483,648 to 2,147,483,647</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.int64</span></code> Range: -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807</p></li>
<li><p>Primary uses in bioinformatics:</p>
<ul>
<li><p>Storing chromosome positions</p></li>
<li><p>Indexing into large sequences</p></li>
</ul>
</li>
</ul>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Storing chromosome positions for a set of genes</span>
<span class="n">gene_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">45123</span><span class="p">,</span> <span class="mi">67845</span><span class="p">,</span> <span class="mi">123456</span><span class="p">,</span> <span class="mi">789012</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_positions</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int8 range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int16 range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int32
int8 range: -128 to 127
int16 range: -32768 to 32767
</pre></div>
</div>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-2">
<p class="admonition-title">More info</p>
<details>
<summary>Additional notes</summary>
<p><code class="docutils literal notranslate"><span class="pre">np.uint8</span></code> (8-bit unsigned integer):</p>
<ul class="simple">
<li><p>Uses 8 bits (1 byte) of memory for each number</p>
<ul>
<li><p>Extremely memory-efficient compared to default integer types (usually 32 or 64 bits)</p></li>
<li><p>Smaller data types can lead to faster computations</p></li>
</ul>
</li>
<li><p>It can only represent non-negative numbers (Unsigned)</p></li>
<li><p>Range: 0 to 255</p></li>
<li><p>Primary uses in bioinformatics:</p>
<ul>
<li><p>Compact storage for quality scores in FASTQ data</p></li>
<li><p>Representing nucleotide bases with numeric codes</p></li>
<li><p>Storing small count data efficiently</p></li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Representing DNA as numeric codes (A=1, C=2, G=3, T=4)</span>
<span class="n">dna_sequence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</pre></div>
</div>
<p>When working with small integers, using <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code> instead of <code class="docutils literal notranslate"><span class="pre">np.int64</span></code> can reduce memory usage by 8x, which becomes significant when processing millions of sequence reads.</p>
</details>
</div>
</section>
<section id="floating-point-types">
<h6>Floating-Point Types<a class="headerlink" href="#floating-point-types" title="Link to this heading"></a></h6>
<p><code class="docutils literal notranslate"><span class="pre">np.float32</span></code> (Single precision); <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> (double-precision float):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">np.float32</span></code> (Single precision)</p>
<ul>
<li><p>32 bits of precision (~7 significant decimal digits)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.float64</span></code> (double-precision float)</p>
<ul>
<li><p>64 bits of precision (~15-17 significant decimal digits)</p></li>
</ul>
</li>
<li><p>Primary uses in bioinformatics:</p>
<ul>
<li><p>Storing p-values from statistical tests</p></li>
<li><p>Representing gene expression values</p></li>
<li><p>Calculating evolutionary distances</p></li>
<li><p>Storing probabilities in models</p></li>
</ul>
</li>
</ul>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-3">
<p class="admonition-title">More info</p>
<details>
<summary>Additional notes</summary>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gene expression values from RNA-seq experiment</span>
<span class="n">expression_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mf">45.7</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">92.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">expression_values</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="c1"># For floating-point types, use np.finfo()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;float16 range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;float32 range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;float64 range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;longdouble range: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">longdouble</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">longdouble</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># Special cases requiring maximum available precision, Rarely used due to platform inconsistency</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>float64
float16 range: -65504.0 to 65504.0
float32 range: -3.4028234663852886e+38 to 3.4028234663852886e+38
float64 range: -1.7976931348623157e+308 to 1.7976931348623157e+308
longdouble range: -1.7976931348623157e+308 to 1.7976931348623157e+308
</pre></div>
</div>
<p>Bioinformatics often requires high precision for statistical calculations, making <code class="docutils literal notranslate"><span class="pre">float64</span></code> a common choice despite its larger memory footprint.</p>
</div>
</details>
</section>
<section id="boolean-type">
<h6>Boolean Type<a class="headerlink" href="#boolean-type" title="Link to this heading"></a></h6>
<p><code class="docutils literal notranslate"><span class="pre">np.bool_</span></code> (Boolean type):</p>
<ul class="simple">
<li><p>Values: True or False</p></li>
<li><p>Primary uses in bioinformatics:</p>
<ul>
<li><p>Creating masks for filtering data</p></li>
<li><p>Representing presence/absence of features</p></li>
<li><p>Storing binary outcomes from statistical tests</p></li>
<li><p>Marking regions of interest in genomic data</p></li>
</ul>
</li>
</ul>
<p>Boolean arrays in NumPy are extremely useful for data filtering and are more memory-efficient and faster than equivalent Python list comprehensions.</p>
</section>
<section id="string-types">
<h6>String Types<a class="headerlink" href="#string-types" title="Link to this heading"></a></h6>
<p><code class="docutils literal notranslate"><span class="pre">&lt;U#</span></code> (Fixed-length string):</p>
<ul class="simple">
<li><p>Stores character data with fixed length</p></li>
<li><p>Primary uses in bioinformatics:</p>
<ul>
<li><p>Storing DNA/RNA sequences</p></li>
<li><p>Representing gene names, IDs, or annotations</p></li>
<li><p>Storing taxonomic information</p></li>
</ul>
</li>
</ul>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Array of gene IDs</span>
<span class="n">gene_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">,</span> <span class="s1">&#39;TP53&#39;</span><span class="p">,</span> <span class="s1">&#39;EGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;KRAS&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_ids</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;1234567890&quot;</span><span class="p">,</span> <span class="s2">&quot;12345678901234567890&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Output</span>
<span class="c1"># dtype(&#39;&lt;U20&#39;)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;U5
&lt;U20
</pre></div>
</div>
<p>NumPy’s string types are less flexible than Python strings but more memory-efficient when working with large collections of fixed-length identifiers.</p>
<p>External resources - <a class="reference external" href="https://numpy.org/devdocs/user/basics.strings.html">Working with Arrays of Strings And Bytes</a></p>
</div>
</section>
</section>
<section id="data-type-conversion-and-specification">
<h5>Data Type Conversion and Specification<a class="headerlink" href="#data-type-conversion-and-specification" title="Link to this heading"></a></h5>
<p>NumPy provides several ways to specify or convert data types:</p>
<section id="explicit-type-declaration">
<h6>Explicit Type Declaration<a class="headerlink" href="#explicit-type-declaration" title="Link to this heading"></a></h6>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create array with specific type</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Convert existing array to new type</span>
<span class="n">float_counts</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="checking-data-types">
<h6>Checking Data Types<a class="headerlink" href="#checking-data-types" title="Link to this heading"></a></h6>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the data type of an array</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># Output: float64</span>
</pre></div>
</div>
</section>
<section id="automatic-type-inference">
<h6>Automatic Type Inference<a class="headerlink" href="#automatic-type-inference" title="Link to this heading"></a></h6>
<p>NumPy attempts to choose an appropriate type based on the data:</p>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>            <span class="c1"># Creates int64 array</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>      <span class="c1"># Creates float64 array</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>  <span class="c1"># Creates bool array</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])</span> <span class="c1"># Creates string array</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="practical-considerations-for-bioinformatics">
<h5>Practical Considerations for Bioinformatics<a class="headerlink" href="#practical-considerations-for-bioinformatics" title="Link to this heading"></a></h5>
<section id="memory-optimization">
<h6>Memory Optimization<a class="headerlink" href="#memory-optimization" title="Link to this heading"></a></h6>
<p>For large genomic datasets, memory usage is critical:</p>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Comparison of memory usage for different types</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create arrays with different types</span>
<span class="n">int64_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">int8_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>

<span class="c1"># Check memory usage</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int64 array: </span><span class="si">{</span><span class="n">int64_array</span><span class="o">.</span><span class="n">nbytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int8 array: </span><span class="si">{</span><span class="n">int8_array</span><span class="o">.</span><span class="n">nbytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The int8 array uses 1/8th the memory of the int64 array, which can make the difference between an analysis running in memory or needing extra resources.</p>
</section>
<section id="performance-considerations">
<h6>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h6>
<p>Data types affect computation speed:</p>
<div class="admonition-demo demo admonition" id="demo-5">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summing integers vs floats</span>
<span class="n">int_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">float_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="o">%</span><span class="n">time</span> <span class="n">int_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">int_array</span><span class="p">)</span>
<span class="o">%</span><span class="n">time</span> <span class="n">float_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">float_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Integer operations are generally faster than floating-point operations, which can be important when processing whole-genome data.</p>
</section>
<section id="type-compatibility-in-bioinformatics-pipelines">
<h6>Type Compatibility in Bioinformatics Pipelines<a class="headerlink" href="#type-compatibility-in-bioinformatics-pipelines" title="Link to this heading"></a></h6>
<p>Different bioinformatics tools may expect specific data types:</p>
<ul class="simple">
<li><p>Visualization libraries may require float64 values</p></li>
<li><p>Machine learning models may work best with specific types</p></li>
<li><p>File formats may impose type constraints</p></li>
</ul>
<p>Being aware of these requirements helps create more robust analysis pipelines.</p>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<p>NumPy’s specialized data types provide significant advantages for bioinformatics applications:</p>
<ol class="arabic simple">
<li><p>Efficiency - Both in terms of memory usage and computational performance</p></li>
<li><p>Precision - Control over numeric representation ensures accurate calculations</p></li>
<li><p>Compatibility - Designed to work well with other scientific computing libraries</p></li>
<li><p>Consistency - Type homogeneity helps prevent errors in large datasets</p></li>
</ol>
<p>By choosing appropriate data types, bioinformaticians can:</p>
<ul class="simple">
<li><p>Process larger datasets in memory</p></li>
<li><p>Run analyses faster</p></li>
<li><p>Ensure computational accuracy</p></li>
<li><p>Build more robust analysis pipelines</p></li>
</ul>
<p>Understanding the distinctions between Python’s general-purpose types and NumPy’s specialized numeric types is essential for effective scientific programming in bioinformatics.</p>
</div>
</section>
</section>
<span id="document-3.Indexing_and_Slicing"></span><section id="array-indexing-and-slicing">
<h4>Array Indexing and Slicing<a class="headerlink" href="#array-indexing-and-slicing" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Define and distinguish between indexing and slicing operations in NumPy arrays</p></li>
<li><p>Demonstrate proper syntax for accessing individual elements in 1D and 2D arrays using indexing</p></li>
<li><p>Extract ranges of elements using slicing techniques, including with negative indices and step parameters</p></li>
<li><p>Recognize and avoid common pitfalls when working with arrays, such as off-by-one errors and unintended modifications to original data</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 10 min</p></li>
<li><p>Demo: 5 min</p></li>
<li><p>Exercise : 5 min (1st exercise will be completed and the other two be skipped during live sessions)</p></li>
</ul>
</div>
<section id="introduction">
<h5>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h5>
<p>What is Indexing and Slicing?</p>
<ul class="simple">
<li><p>Indexing is the process of accessing specific individual elements within a data structure</p>
<ul>
<li><p>Uses square brackets with a single index value: <code class="docutils literal notranslate"><span class="pre">array[0]</span></code></p></li>
<li><p>Most programming languages use zero-based indexing (first element is at position 0)</p></li>
</ul>
</li>
<li><p>Slicing is the process of extracting a subset or range of elements</p>
<ul>
<li><p>Uses square brackets with a range specification: <code class="docutils literal notranslate"><span class="pre">array[start:stop:step]</span></code></p></li>
<li><p>Creates a view of the original data (changes to the slice affect the original array)</p></li>
</ul>
</li>
</ul>
<p>Why Indexing Matters in Bioinformatics:</p>
<ul class="simple">
<li><p>Bioinformatics deals with large, complex biological datasets:</p>
<ul>
<li><p>DNA/RNA sequences (can be millions of nucleotides long)</p></li>
<li><p>Protein sequences</p></li>
<li><p>Gene expression matrices (thousands of genes × dozens/hundreds of samples)</p></li>
<li><p>Phylogenetic trees</p></li>
<li><p>Molecular structures</p></li>
</ul>
</li>
<li><p>Efficient data access is crucial for:</p>
<ul>
<li><p>Sequence alignment and comparison</p></li>
<li><p>Identifying motifs or patterns</p></li>
<li><p>Analyzing specific regions of interest (e.g., genes, domains, binding sites)</p></li>
<li><p>Processing large-scale genomic or proteomic data</p></li>
<li><p>Statistical analysis across experimental conditions</p></li>
</ul>
</li>
</ul>
</section>
<section id="numpy-arrays-in-bioinformatics">
<h5>NumPy Arrays in Bioinformatics<a class="headerlink" href="#numpy-arrays-in-bioinformatics" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Common bioinformatics applications:</p>
<ul>
<li><p>Storing sequence data as numeric arrays</p></li>
<li><p>Representing position weight matrices</p></li>
<li><p>Managing alignment scores</p></li>
<li><p>Handling gene expression matrices</p></li>
</ul>
</li>
</ul>
</section>
<section id="d-array-operations">
<h5>1D Array Operations<a class="headerlink" href="#d-array-operations" title="Link to this heading"></a></h5>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<p class="rubric" id="d-array-indexing">1D Array Indexing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: String sequence converted to numerical representation</span>
<span class="c1"># A=0, C=1, G=2, T=3</span>
<span class="n">dna_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># &quot;ACGTAACG&quot;</span>

<span class="c1"># Single element access through indexing</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>    <span class="c1"># First nucleotide (0 = A)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>    <span class="c1"># Fourth nucleotide (3 = T)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>   <span class="c1"># Last nucleotide (2 = G) using negative indexing</span>
</pre></div>
</div>
<p class="rubric" id="d-array-slicing">1D Array Slicing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slicing * extracting subsequences</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># From second to fourth nucleotide: array([1, 2, 3]) = &quot;CGT&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>   <span class="c1"># First three nucleotides: array([0, 1, 2]) = &quot;ACG&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>   <span class="c1"># From sixth nucleotide to the end: array([0, 1, 2]) = &quot;ACG&quot;</span>

<span class="c1"># Slicing with negative indices</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>  <span class="c1"># Last three nucleotides: array([0, 1, 2]) = &quot;ACG&quot;</span>

<span class="c1"># Slicing with step</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dna_seq</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Every second nucleotide: array([0, 2, 0, 1]) = &quot;AGAC&quot;</span>
</pre></div>
</div>
</div>
<p><strong>Real-world significance in bioinformatics:</strong></p>
<ul class="simple">
<li><p>Indexing:</p>
<ul>
<li><p>Accessing specific nucleotide positions of interest</p></li>
<li><p>Retrieving expression values for particular genes</p></li>
<li><p>Referencing elements in position-specific scoring matrices</p></li>
</ul>
</li>
<li><p>Slicing:</p>
<ul>
<li><p>Extracting specific regions like promoters, exons, or binding sites</p></li>
<li><p>Identifying sequence motifs (e.g., restriction sites, protein domains)</p></li>
<li><p>Analyzing k-mers (subsequences of length k)</p></li>
<li><p>Creating sliding windows along DNA/protein sequences</p></li>
</ul>
</li>
</ul>
</section>
<section id="id1">
<h5>2D Array Operations<a class="headerlink" href="#id1" title="Link to this heading"></a></h5>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: Gene expression matrix</span>
<span class="c1"># Rows = genes, Columns = experimental conditions</span>
<span class="n">gene_expr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">12.5</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">33.4</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">],</span>  <span class="c1"># Gene 1 expression across 4 conditions</span>
    <span class="p">[</span><span class="mf">45.1</span><span class="p">,</span> <span class="mf">43.8</span><span class="p">,</span> <span class="mf">29.2</span><span class="p">,</span> <span class="mf">22.1</span><span class="p">],</span> <span class="c1"># Gene 2 expression</span>
    <span class="p">[</span><span class="mf">8.7</span><span class="p">,</span>  <span class="mf">9.2</span><span class="p">,</span>  <span class="mf">12.3</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">],</span> <span class="c1"># Gene 3 expression</span>
    <span class="p">[</span><span class="mf">67.2</span><span class="p">,</span> <span class="mf">70.3</span><span class="p">,</span> <span class="mf">68.7</span><span class="p">,</span> <span class="mf">71.9</span><span class="p">]</span>  <span class="c1"># Gene 4 expression</span>
<span class="p">])</span>
</pre></div>
</div>
<p class="rubric" id="id2">2D Array Indexing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single element access * specific element at row, column</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>    <span class="c1"># Expression of Gene 2 in condition 3: 29.2</span>

<span class="c1"># Row indexing * accessing specific row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>       <span class="c1"># Gene 1 across all conditions: array([12.5, 10.2, 33.4, 7.8])</span>
</pre></div>
</div>
<p class="rubric" id="id3">2D Array Slicing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Row slicing * expression profile of one gene across all conditions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>    <span class="c1"># Gene 1 across all conditions: array([12.5, 10.2, 33.4, 7.8])</span>

<span class="c1"># Column slicing * expression of all genes in a specific condition</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>    <span class="c1"># All genes in condition 2: array([10.2, 43.8, 9.2, 70.3])</span>

<span class="c1"># Sub-matrix slicing * subset of genes in subset of conditions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
<span class="c1"># First 2 genes in conditions 3 and 4:</span>
<span class="c1"># array([[33.4,  7.8],</span>
<span class="c1">#        [29.2, 22.1]])</span>

<span class="c1"># Strided slicing * every other gene, first two conditions</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># Genes 1 &amp; 3, conditions 1 &amp; 2:</span>
<span class="c1"># array([[12.5, 10.2],</span>
<span class="c1">#        [8.7,  9.2]])</span>
</pre></div>
</div>
</div>
</section>
<section id="real-world-significance-in-bioinformatics">
<h5>Real-world significance in bioinformatics<a class="headerlink" href="#real-world-significance-in-bioinformatics" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Indexing:</p>
<ul>
<li><p>Retrieving expression value for a specific gene in a specific condition</p></li>
<li><p>Accessing specific positions in sequence alignments</p></li>
<li><p>Finding interaction pairs in protein-protein interaction matrices</p></li>
</ul>
</li>
<li><p>Slicing:</p>
<ul>
<li><p>Comparing gene expression profiles across different tissues or time points</p></li>
<li><p>Analyzing subsets of genes after clustering</p></li>
<li><p>Extracting data for specific experiments or replicates</p></li>
<li><p>Processing sections of alignment score matrices</p></li>
<li><p>Analyzing specific regions in protein contact maps</p></li>
<li><p>Extracting protein domains from structure coordinate arrays</p></li>
</ul>
</li>
</ul>
</section>
<section id="exercises-array-indexing-and-slicing-exercises">
<h5>Exercises - Array Indexing and Slicing Exercises<a class="headerlink" href="#exercises-array-indexing-and-slicing-exercises" title="Link to this heading"></a></h5>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p class="rubric" id="exercise-1-dna-sequence-analysis-2-3-minutes">Exercise 1: DNA Sequence Analysis (2-3 minutes)</p>
<p>Given a DNA sequence represented as an array of numerical values (A=0, C=1, G=2, T=3):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">dna_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># &quot;ACGTAACGTTGCAGT&quot;</span>
</pre></div>
</div>
<p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Extract the first 5 nucleotides</p></li>
<li><p>Extract the last 4 nucleotides</p></li>
<li><p>Extract every third nucleotide starting from the first position</p></li>
<li><p>Extract the subsequence from position 6 to position 10 (inclusive)</p></li>
</ol>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. First 5 nucleotides</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 5 nucleotides:&quot;</span><span class="p">,</span> <span class="n">dna_seq</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="c1"># 2. Last 4 nucleotides</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Last 4 nucleotides:&quot;</span><span class="p">,</span> <span class="n">dna_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>

<span class="c1"># 3. Every third nucleotide</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Every third nucleotide:&quot;</span><span class="p">,</span> <span class="n">dna_seq</span><span class="p">[::</span><span class="mi">3</span><span class="p">])</span>

<span class="c1"># 4. Subsequence from position 6 to 10</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subsequence pos 6-10:&quot;</span><span class="p">,</span> <span class="n">dna_seq</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span>
<span class="c1"># Note: Upper bound is exclusive in slicing, so we use 11 to include position 10</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>First 5 nucleotides: [0 1 2 3 0]
Last 4 nucleotides: [0 0 2 3]
Every third nucleotide: [0 3 1 3 0 3]
Subsequence pos 6-10: [1 2 3 3 2]
</pre></div>
</div>
</div>
<div class="admonition-additional-exercises instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Additional exercises</p>
<details>
<summary>Exercise 2 & 3</summary>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p class="rubric" id="exercise-2-gene-expression-analysis-2-3-minutes">Exercise 2: Gene Expression Analysis (2-3 minutes)</p>
<p>Given a gene expression matrix where rows represent genes and columns represent conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">gene_expr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">15.2</span><span class="p">,</span> <span class="mf">21.5</span><span class="p">,</span> <span class="mf">18.9</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">,</span> <span class="mf">25.3</span><span class="p">],</span>  <span class="c1"># Gene 1</span>
    <span class="p">[</span><span class="mf">42.3</span><span class="p">,</span> <span class="mf">38.1</span><span class="p">,</span> <span class="mf">29.6</span><span class="p">,</span> <span class="mf">33.2</span><span class="p">,</span> <span class="mf">19.7</span><span class="p">],</span>  <span class="c1"># Gene 2</span>
    <span class="p">[</span><span class="mf">8.4</span><span class="p">,</span>  <span class="mf">7.5</span><span class="p">,</span>  <span class="mf">9.2</span><span class="p">,</span>  <span class="mf">8.1</span><span class="p">,</span>  <span class="mf">10.5</span><span class="p">],</span>  <span class="c1"># Gene 3</span>
    <span class="p">[</span><span class="mf">31.6</span><span class="p">,</span> <span class="mf">29.8</span><span class="p">,</span> <span class="mf">27.5</span><span class="p">,</span> <span class="mf">34.9</span><span class="p">,</span> <span class="mf">36.2</span><span class="p">],</span>  <span class="c1"># Gene 4</span>
    <span class="p">[</span><span class="mf">17.3</span><span class="p">,</span> <span class="mf">19.8</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">]</span>   <span class="c1"># Gene 5</span>
<span class="p">])</span>
</pre></div>
</div>
<p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Extract the expression values for Gene 3</p></li>
<li><p>Extract the expression values for all genes under fifth column</p></li>
<li><p>Extract a sub-matrix containing Genes 2-4 under columns 2-3</p></li>
<li><p>Find the expression value for Gene 5 under columns 2</p></li>
</ol>
<p><strong>Exercise 2 -Solution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Expression values for Gene 3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gene 3 expression:&quot;</span><span class="p">,</span> <span class="n">gene_expr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># Alternative: gene_expr[2, :]</span>

<span class="c1"># 2. Expression values for all genes under column 5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Condition 4 expression:&quot;</span><span class="p">,</span> <span class="n">gene_expr</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">])</span> 

<span class="c1"># 3. Sub-matrix of Genes 2-4 under columns 2-3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sub-matrix (Genes 2-4, columns 2-3):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_expr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="c1"># array([[38.1, 29.6],</span>
<span class="c1">#        [7.5,  9.2],</span>
<span class="c1">#        [29.8, 27.5]])</span>

<span class="c1"># 4. Expression value for Gene 5 under columns 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gene 5, columns 2:&quot;</span><span class="p">,</span> <span class="n">gene_expr</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> 
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Gene 3 expression: [ 8.4  7.5  9.2  8.1 10.5]
Condition 4 expression: [25.3 19.7 10.5 36.2 18.2]
Sub-matrix (Genes 2-4, columns 2-3):
[[38.1 29.6]
 [ 7.5  9.2]
 [29.8 27.5]]
Gene 5, columns 2: 19.8
</pre></div>
</div>
<p class="rubric" id="exercise-3-multi-sequence-alignment-analysis-2-3-minutes">Exercise 3: Multi-sequence Alignment Analysis (2-3 minutes)</p>
<p>Consider a simplified alignment scoring matrix where each row represents a match (1) or mismatch (0) and each column represents a position in the alignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">alignment_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Sequence 1</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Sequence 2</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Sequence 3</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>   <span class="c1"># Sequence 4</span>
<span class="p">])</span>  <span class="c1"># 1 = match, 0 = mismatch</span>
</pre></div>
</div>
<p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Find positions where all sequences match (all rows having 1s in a column - use <code class="docutils literal notranslate"><span class="pre">np.all</span></code> with a mask)</p></li>
<li><p>Extract scores for positions 3-7 for all sequences</p></li>
<li><p>Find the matching pattern (positions with value 1) for Sequence 3</p></li>
<li><p>Extract a sub-alignment of the first two sequences for the last five positions</p></li>
</ol>
<p><strong>Exercise 3 -Solution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Positions where all sequences match</span>
<span class="n">all_match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">alignment_scores</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positions where all sequences match:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">all_match</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> 

<span class="c1"># 2. Scores for positions 3-7 for all sequences</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Positions 3-7 scores:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alignment_scores</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>

<span class="c1"># 3. Matching pattern for Sequence 3</span>
<span class="n">seq3_matches</span> <span class="o">=</span> <span class="n">alignment_scores</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sequence 3 match positions:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">seq3_matches</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># 4. Sub-alignment of first two sequences for last five positions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sub-alignment (Seq 1-2, last 5 positions):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alignment_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Positions where all sequences match: [3]
Positions 3-7 scores:
[[1 0 1 0 0]
 [1 0 0 1 1]
 [1 1 0 0 1]
 [1 1 1 0 0]]
Sequence 3 match positions: [1 2 3 4 7]
Sub-alignment (Seq 1-2, last 5 positions):
[[1 0 0 1 1]
 [0 1 1 0 1]]
</pre></div>
</div>
</div>
</div>
</details>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Efficient indexing and slicing are crucial for bioinformatics workflows</p></li>
<li><p>Key takeaways:</p>
<ul>
<li><p>Indexing for accessing individual elements</p></li>
<li><p>Slicing for extracting regions of interest</p></li>
<li><p>Leverage both for efficient data manipulation in matrices (gene × condition, position × sequence, etc.)</p></li>
<li><p>Combine with boolean operations for filtering</p></li>
<li><p>Remember zero-based indexing</p></li>
</ul>
</li>
<li><p>Common pitfalls:</p>
<ul>
<li><p>Off-by-one errors (especially when converting between biology’s 1-based and programming’s 0-based systems)</p></li>
<li><p>Overlooking the exclusive upper bound in slicing (end index is not included)</p></li>
<li><p>Forgetting that modifying slices can modify the original array (use .copy() when needed)</p></li>
<li><p>Confusing row-major vs. column-major operations</p></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<span id="document-4.Advance_indexing_filtering"></span><section id="numpy-boolean-masking-and-filtering">
<h4>NumPy Boolean Masking and Filtering<a class="headerlink" href="#numpy-boolean-masking-and-filtering" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ol class="arabic simple">
<li><p>Create boolean masks for array filtering using comparison operators</p></li>
<li><p>Apply boolean masks to select specific elements from arrays</p></li>
<li><p>Combine multiple conditions using logical operators (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, <code class="docutils literal notranslate"><span class="pre">~</span></code>)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> to find indices where conditions are met</p></li>
<li><p>Apply <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> for conditional value assignment</p></li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">np.isin()</span></code> to check array membership</p></li>
<li><p>Apply these techniques to solve common data analysis problems</p></li>
</ol>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 10 min</p></li>
<li><p>Demo: 5 min</p></li>
<li><p>Exercise : 5 min (1st exercise will be completed and the other two be skipped during live sessions)</p></li>
</ul>
</div>
<section id="introduction-to-advanced-indexing">
<h5>Introduction to Advanced Indexing<a class="headerlink" href="#introduction-to-advanced-indexing" title="Link to this heading"></a></h5>
<p>When working with data, we often need to focus on specific elements that meet certain criteria. NumPy provides elegant and efficient ways to accomplish this through:</p>
<ol class="arabic simple">
<li><p>Boolean masking</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> function</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">np.isin()</span></code> function</p></li>
</ol>
<p>Let’s explore each technique in detail.</p>
</section>
<section id="boolean-masking-the-concept">
<h5>Boolean Masking: The Concept<a class="headerlink" href="#boolean-masking-the-concept" title="Link to this heading"></a></h5>
<p>Boolean masking is a fundamental technique in NumPy that allows us to filter arrays based on conditions. The process happens in two steps:</p>
<p><strong>Step 1: Create a Boolean Mask:</strong></p>
<ul class="simple">
<li><p>We apply a condition to an array</p></li>
<li><p>This produces a new array of the same shape filled with <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> values</p></li>
<li><p>Elements that satisfy our condition are marked as <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p>Elements that don’t satisfy our condition are marked as <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
<p><strong>Step 2: Apply the Mask:</strong></p>
<ul class="simple">
<li><p>We use this boolean array to index into our original array</p></li>
<li><p>Only elements corresponding to <code class="docutils literal notranslate"><span class="pre">True</span></code> values are selected</p></li>
</ul>
<p>Let’s see this in action:</p>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a sample array</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original array:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Create a boolean mask for elements greater than 3</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Boolean mask (data &gt; 3):&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
<span class="c1"># This produces: [False, True, False, True, False]</span>

<span class="c1"># Apply the mask to select elements</span>
<span class="n">selected_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected elements:&quot;</span><span class="p">,</span> <span class="n">selected_data</span><span class="p">)</span>
<span class="c1"># This produces: [4, 5]</span>

<span class="c1">## Elegant approach -  mask array has the exact same shape as data array</span>
<span class="c1">## Each position containing information about whether that element meets our criteria</span>
</pre></div>
</div>
</div>
</section>
<section id="combining-multiple-conditions">
<h5>Combining Multiple Conditions<a class="headerlink" href="#combining-multiple-conditions" title="Link to this heading"></a></h5>
<p>We can combine multiple conditions using logical operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code> for logical AND</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">|</span></code> for logical OR</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">~</span></code> for logical NOT</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a 2D array for demonstration</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> 
                <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">]])</span>

<span class="c1"># Elements greater than 20 AND less than 40</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements between 20 and 40:&quot;</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="c1"># This produces: [25 30 35]</span>

<span class="c1"># Elements less than 15 OR greater than 40</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements less than 15 or greater than 40:&quot;</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="c1"># This produces: [ 5 10 45]</span>
</pre></div>
</div>
</div>
<p><strong>Important:</strong> When combining conditions, always use parentheses around each individual condition to ensure proper precedence.</p>
</section>
<section id="using-np-where-finding-positions">
<h5>Using <code class="docutils literal notranslate"><span class="pre">np.where()</span></code>: Finding Positions<a class="headerlink" href="#using-np-where-finding-positions" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> function gives us even more capabilities. In its simplest form, it returns the indices where a condition is True:</p>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an array with a sequence</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># [0, 3, 6, 9, 12, 15, 18]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original array:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Find indices where elements are even</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of even elements:&quot;</span><span class="p">,</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># This produces: [0, 2, 4, 6]</span>

<span class="c1"># Use these indices to get the actual values</span>
<span class="n">even_elements</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Even elements:&quot;</span><span class="p">,</span> <span class="n">even_elements</span><span class="p">)</span>
<span class="c1"># This produces: [ 0,  6, 12, 18]</span>
</pre></div>
</div>
</div>
<p>The result of <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> is a tuple of arrays, one for each dimension of the input array. Since we’re working with a 1D array here, we access the first (and only) element of this tuple with <code class="docutils literal notranslate"><span class="pre">indices[0]</span></code>.</p>
</section>
<section id="using-np-where-conditional-assignment">
<h5>Using <code class="docutils literal notranslate"><span class="pre">np.where()</span></code>: Conditional Assignment<a class="headerlink" href="#using-np-where-conditional-assignment" title="Link to this heading"></a></h5>
<p>The real power of <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> comes from its three-argument form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>This works like a vectorized if-else statement:</p>
<ul class="simple">
<li><p>Where the condition is <code class="docutils literal notranslate"><span class="pre">True</span></code>, take values from array <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p>Where the condition is <code class="docutils literal notranslate"><span class="pre">False</span></code>, take values from array <code class="docutils literal notranslate"><span class="pre">y</span></code></p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original array: [0, 3, 6, 9, 12, 15, 18]</span>

<span class="c1"># Replace odd numbers with zeros</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Even numbers preserved, odd numbers replaced with 0:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="c1"># This produces: [ 0,  0,  6,  0, 12,  0, 18]</span>

<span class="c1"># Another example: create an array that shows whether each element is even or odd</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;even&quot;</span><span class="p">,</span> <span class="s2">&quot;odd&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Labels for each element:&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="c1"># This produces: [&#39;even&#39; &#39;odd&#39; &#39;even&#39; &#39;odd&#39; &#39;even&#39; &#39;odd&#39; &#39;even&#39;]</span>
</pre></div>
</div>
</div>
<p>This is much more concise and efficient than using loops or other conditional constructs.</p>
</section>
<section id="the-np-isin-function">
<h5>The <code class="docutils literal notranslate"><span class="pre">np.isin()</span></code> Function<a class="headerlink" href="#the-np-isin-function" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">np.isin()</span></code> function checks whether elements in one array are present in another array. It creates a boolean mask that we can use for filtering:</p>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original array: [0, 3, 6, 9, 12, 15, 18]</span>

<span class="c1"># Check which elements are in a set of values</span>
<span class="n">test_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements that are in test_values:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="c1"># This produces: [ 0,  6, 15]</span>

<span class="c1"># We can also use the ~ operator for negation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elements that are NOT in test_values:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">])</span>
<span class="c1"># This produces: [ 3,  9, 12, 18]</span>
</pre></div>
</div>
</div>
<p>This is especially useful when we have a specific set of values we’re interested in.</p>
</section>
<section id="practical-applications">
<h5>Practical Applications<a class="headerlink" href="#practical-applications" title="Link to this heading"></a></h5>
<p>These techniques are foundational for data analysis tasks:</p>
<ol class="arabic">
<li><p>Data Cleaning: Filter out missing or invalid values</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clean_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span>  <span class="c1"># Remove NaN values</span>
</pre></div>
</div>
</li>
<li><p>Feature Selection: Extract data points that meet specific criteria</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">high_importance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Conditional Transformations: Apply different operations to different elements</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">normalized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">data</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="performance-considerations">
<h5>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h5>
<p>Boolean masking and <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> operations are highly optimized in NumPy. They:</p>
<ul class="simple">
<li><p>Avoid explicit loops in Python</p></li>
<li><p>Execute at C-speed under the hood</p></li>
<li><p>Allow vectorized operations on large datasets</p></li>
</ul>
<p>For large datasets, these techniques are drastically faster than traditional iteration.</p>
</section>
<section id="exercises-numpy-boolean-masking-and-advanced-filtering">
<h5>Exercises: NumPy Boolean Masking and Advanced Filtering<a class="headerlink" href="#exercises-numpy-boolean-masking-and-advanced-filtering" title="Link to this heading"></a></h5>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p><strong>Exercise 1 - Basic Boolean Masking:</strong></p>
<p>Create a NumPy array of 20 random integers between 0 and 100. Then:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Create a boolean mask to identify all numbers divisible by 7</p></li>
<li><p>Use the mask to extract these numbers</p></li>
<li><p>Count how many numbers are divisible by 7</p></li>
</ul>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create an array of 20 random integers between 0 and 100</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original array:&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>

<span class="c1"># Create a boolean mask for numbers divisible by 7</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">numbers</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Boolean mask:&quot;</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="c1"># Extract numbers divisible by 7</span>
<span class="n">divisible_by_7</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numbers divisible by 7:&quot;</span><span class="p">,</span> <span class="n">divisible_by_7</span><span class="p">)</span>

<span class="c1"># Count how many numbers are divisible by 7</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>  <span class="c1"># True values are treated as 1, False as 0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Count of numbers divisible by 7: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original array: [51 92 14 71 60 20 82 86 74 74 87 99 23  2 21 52  1 87 29 37]
Boolean mask: [False False  True False False False False False False False False False
 False False  True False False False False False]
Numbers divisible by 7: [14 21]
Count of numbers divisible by 7: 2
</pre></div>
</div>
</div>
<div class="admonition-additional-exercises instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Additional exercises</p>
<details>
<summary>Exercise 2 & 3</summary>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p><strong>Exercise 2 - np.where() for Conditional Assignment:</strong></p>
<p>Create a 4x4 matrix of random integers between 1 and 20. Then:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Use np.where() to replace all odd numbers with -1 while keeping even numbers unchanged</p></li>
</ul>
<p><strong>Exercise 2 - Solution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 4x4 matrix of random integers between 1 and 20</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="c1"># Replace odd numbers with -1, keep even numbers</span>
<span class="n">odd_replaced</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">matrix</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matrix with odd numbers replaced by -1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">odd_replaced</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original matrix:
[[ 7 20 15 11]
 [ 8  7 19 11]
 [11  4  8  3]
 [ 2 12  6  2]]

Matrix with odd numbers replaced by -1:
[[-1 20 -1 -1]
 [ 8 -1 -1 -1]
 [-1  4  8 -1]
 [ 2 12  6  2]]
</pre></div>
</div>
<p><strong>Exercise 3 - DNA Sequence Analysis:</strong></p>
<p>You are given a DNA sequence as a NumPy array of characters (A, T, G, C).</p>
<ul class="simple">
<li><p>Create a random DNA sequence of length 50 using <code class="docutils literal notranslate"><span class="pre">np.random.choice(['A',</span> <span class="pre">'T',</span> <span class="pre">'G',</span> <span class="pre">'C'],</span> <span class="pre">50)</span></code></p></li>
<li><p>Use boolean masking to Count the number of each nucleotide (A, T, G, C)</p></li>
</ul>
<p><strong>Exercise 3 - Solution:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a random DNA sequence</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">dna_sequence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DNA sequence:&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dna_sequence</span><span class="p">))</span>

<span class="c1"># Count the number of each nucleotide</span>
<span class="n">a_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dna_sequence</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">t_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dna_sequence</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">g_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dna_sequence</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">)</span>
<span class="n">c_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dna_sequence</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;A: </span><span class="si">{</span><span class="n">a_count</span><span class="si">}</span><span class="s2">, T: </span><span class="si">{</span><span class="n">t_count</span><span class="si">}</span><span class="s2">, G: </span><span class="si">{</span><span class="n">g_count</span><span class="si">}</span><span class="s2">, C: </span><span class="si">{</span><span class="n">c_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DNA sequence: GCAGGCAAGTGGGGCACCCGTATCCTTTCCAACTTACAAGGGTCCCCGTT
A: 10, T: 11, G: 13, C: 16
</pre></div>
</div>
</div>
</div>
</details>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Boolean masking provides an intuitive way to filter arrays based on conditions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.where()</span></code> in its single-argument form finds indices where conditions are true</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.where(condition,</span> <span class="pre">x,</span> <span class="pre">y)</span></code> acts as a vectorized if-else statement</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.isin()</span></code> lets us filter based on membership in a set of values</p></li>
</ul>
</div>
</section>
</section>
<span id="document-5.Essential_array_operations"></span><section id="essential-array-operations-with-numpy">
<h4>Essential Array Operations with NumPy<a class="headerlink" href="#essential-array-operations-with-numpy" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ol class="arabic simple">
<li><p>Reshape arrays to transform data structures while preserving values</p></li>
<li><p>Combine arrays using concatenation operations along different axes</p></li>
<li><p>Generate descriptive statistics from arrays using NumPy’s built-in functions</p></li>
<li><p>Apply the axis parameter correctly to perform row-wise and column-wise operations</p></li>
<li><p>Integrate reshaping, concatenation, and statistical functions to solve practical data problems</p></li>
</ol>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 20 min</p></li>
<li><p>Demo: 20 min</p></li>
</ul>
</div>
<section id="introduction">
<h5>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h5>
<p>NumPy is the foundation of Python’s data science ecosystem. At its core is the powerful ndarray object - an efficient, versatile container for large datasets. We’ll explore three essential capabilities:</p>
<ul class="simple">
<li><p>Reshaping arrays to organize data differently</p></li>
<li><p>Combining arrays using concatenation</p></li>
<li><p>Generating summary statistics to understand our data</p></li>
</ul>
<p>Let’s dive into how these operations can transform the way we work with numerical data.</p>
</section>
<section id="reshaping-arrays">
<h5>Reshaping Arrays<a class="headerlink" href="#reshaping-arrays" title="Link to this heading"></a></h5>
<section id="understanding-array-dimensions">
<h6>Understanding Array Dimensions<a class="headerlink" href="#understanding-array-dimensions" title="Link to this heading"></a></h6>
<p>Arrays can have different dimensions:</p>
<ul class="simple">
<li><p>1D arrays (vectors): Simple sequences of values</p></li>
<li><p>2D arrays (matrices): Tables with rows and columns</p></li>
<li><p>3D arrays and beyond: Multi-dimensional structures</p></li>
</ul>
<p><img alt="alt text" src="_images/image-4.png" /></p>
<p>The shape and dimension of an array tell us how data is organized:</p>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a simple 1D array</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original array:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensions: </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Number of dimensions</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>      <span class="c1"># Tuple showing size in each dimension</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original array:
[1. 1. 1. 1. 1. 1.]
Dimensions: 1
Shape: (6,)
</pre></div>
</div>
</div>
</section>
<section id="reshaping-arrays-uisng-reshape">
<h6>Reshaping Arrays uisng <code class="docutils literal notranslate"><span class="pre">reshape</span></code><a class="headerlink" href="#reshaping-arrays-uisng-reshape" title="Link to this heading"></a></h6>
<p><img alt="alt text" src="_images/image-6.png" /></p>
<ul class="simple">
<li><p>Reshaping allows us to reorganize the same data into different dimensions</p></li>
<li><p>The key rule: the total number of elements must remain the same</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="c1"># Reshape our 1D array with 6 elements into a 2D array (2 rows, 3 columns)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reshaped to 2x3 array:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensions: </span><span class="si">{</span><span class="n">b</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Reshaped to 2x3 array:
[[1 2 3]
 [4 5 6]]
Dimensions: 2
Shape: (2, 3)
</pre></div>
</div>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">More info</p>
<details>
<summary>Additional notes</summary>
<p><strong>Practical Example: Preparing a Simple Grayscale Image for an ML Model:</strong></p>
<ul class="simple">
<li><p>Imagine you have a tiny grayscale image, maybe from a very simple dataset. It’s represented as a 2D grid of pixel values. Many basic machine learning algorithms (like Logistic Regression or simple Neural Networks) expect input data where each row is a single sample (a single image) and each column is a feature (a single pixel value).</p></li>
<li><p>Our task is to take a 2D image representation and “flatten” it into a 1D row vector suitable for these algorithms.</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># 2. Imagine a tiny 3x3 pixel grayscale image</span>
<span class="c1">#    Each number represents the brightness of a pixel (0=black, 255=white)</span>
<span class="c1">#    This is a 2D NumPy array (a matrix)</span>
<span class="n">image_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original 2D Image Array:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image_2d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of original image:&quot;</span><span class="p">,</span> <span class="n">image_2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># Output: (3, 3) -&gt; 3 rows, 3 columns</span>

<span class="c1"># 3. Prepare for ML: Flatten the image</span>
<span class="c1">#    Many ML models expect each sample (our image) as a single row.</span>
<span class="c1">#    We need to convert the 3x3 grid into a 1x9 row (1 row, 9 features/pixels).</span>
<span class="c1">#    Total number of pixels = 3 * 3 = 9</span>

<span class="c1">#    Using reshape:</span>
<span class="c1">#    We want 1 row, and NumPy can figure out the number of columns needed.</span>
<span class="c1">#    We use &#39;-1&#39; to tell NumPy: &quot;calculate the correct number of columns for me&quot;.</span>
<span class="n">flattened_image</span> <span class="o">=</span> <span class="n">image_2d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="c1">#    Alternatively, we could be explicit:</span>
<span class="c1">#    flattened_image = image_2d.reshape(1, 9)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Flattened Image Array (Ready for ML Model):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">flattened_image</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of flattened image:&quot;</span><span class="p">,</span> <span class="n">flattened_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># Output: (1, 9) -&gt; 1 row, 9 columns</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original 2D Image Array:
[[10 20 30]
 [40 50 60]
 [70 80 90]]
Shape of original image: (3, 3)

Flattened Image Array (Ready for ML Model):
[[10 20 30 40 50 60 70 80 90]]
Shape of flattened image: (1, 9)
</pre></div>
</div>
</div>
</div>
</details>
<section id="using-1-as-a-dimension">
<h6 aria-level="7">Using -1 as a Dimension<a class="headerlink" href="#using-1-as-a-dimension" title="Link to this heading"></a></h6>
<p>NumPy can automatically calculate one dimension when you use -1:</p>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image_2d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
     <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">220</span><span class="p">]</span>
 <span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flattened image: </span><span class="si">{</span><span class="n">image_2d2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 10,  20,  30,  40,  50,  60,  70,  80,  90],
       [100,  50,  60,  55, 150, 200, 150, 100, 220]])
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="array-concatenation">
<h5>Array Concatenation<a class="headerlink" href="#array-concatenation" title="Link to this heading"></a></h5>
<p>Concatenation lets us combine multiple arrays into a single larger array. This is essential when:</p>
<ul class="simple">
<li><p>Merging datasets</p></li>
<li><p>Building up arrays piece by piece</p></li>
<li><p>Combining results from different operations</p></li>
</ul>
<p><img alt="alt text" src="_images/image-7.png" /></p>
<section id="d-array-concatenation">
<h6>1D Array Concatenation<a class="headerlink" href="#d-array-concatenation" title="Link to this heading"></a></h6>
<p>Let’s start with the simplest case - joining two 1D arrays:</p>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two 1D arrays</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="c1"># Concatenate them</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Concatenated 1D arrays:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Concatenated 1D arrays:
[1 2 3 4 5 6 7 8]
</pre></div>
</div>
</div>
</section>
<section id="id1">
<h6>2D Array Concatenation<a class="headerlink" href="#id1" title="Link to this heading"></a></h6>
<p>When working with 2D arrays, we need to specify the axis of concatenation:</p>
<p>axis=0: Join vertically (collapse rows)
axis=1: Join horizontally (collapse columns)</p>
<section id="vertical-concatenation-axis-0">
<h6 aria-level="7">Vertical Concatenation (axis=0)<a class="headerlink" href="#vertical-concatenation-axis-0" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-5">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 2D arrays</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>  <span class="c1"># 2x2 array</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>          <span class="c1"># 1x2 array</span>

<span class="c1"># Vertical concatenation (default is axis=0)</span>
<span class="n">v_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Vertical concatenation (axis=0):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v_combined</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Vertical concatenation (axis=0):
[[1 2]
 [3 4]
 [5 6]]
</pre></div>
</div>
</div>
</section>
<section id="horizontal-concatenation-axis-1">
<h6 aria-level="7">Horizontal Concatenation (axis=1)<a class="headerlink" href="#horizontal-concatenation-axis-1" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-6">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create arrays for horizontal concatenation</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>    <span class="c1"># 2x2 array</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">]])</span>          <span class="c1"># 2x1 array</span>

<span class="c1"># Horizontal concatenation (axis=1)</span>
<span class="n">h_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Horizontal concatenation (axis=1):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h_combined</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Horizontal concatenation (axis=1):
[[1 2 5]
 [3 4 6]]
</pre></div>
</div>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-2">
<p class="admonition-title">More info</p>
<details>
<summary>Additional notes</summary>
<p><strong>Concatenation Requirements:</strong></p>
<ul class="simple">
<li><p>The key rule for numpy concatenation is:</p>
<ul>
<li><p>When concatenating along a specific axis, all dimensions <strong>except</strong> that axis must match exactly.</p></li>
</ul>
</li>
</ul>
<p><strong>Example 1 (fails):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>    <span class="c1"># Shape: (1, 3)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span> <span class="c1"># Shape: (1, 4)</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Concatenating along axis=0 (stacking rows)</p></li>
<li><p>For axis=0 concatenation, all other dimensions must match</p></li>
<li><p>a has 3 columns, b has 4 columns</p></li>
<li><p>Since 3 ≠ 4, this raises an error</p></li>
</ul>
<p><strong>Example 2 (works):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>    <span class="c1"># Shape: (1, 3)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span> <span class="c1"># Shape: (1, 4)</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Concatenating along axis=1 (stacking columns)</p></li>
<li><p>For axis=1 concatenation, all other dimensions must match</p></li>
<li><p>Both c and d have 1 row</p></li>
<li><p>Since 1 = 1, this works and creates shape (1, 7)</p></li>
</ul>
<p><strong>Simple way to remember:</strong></p>
<ul class="simple">
<li><p>axis=0: Arrays must have the same number of columns</p></li>
<li><p>axis=1: Arrays must have the same number of rows</p></li>
<li><p>axis=2 (for 3D): Arrays must have matching dimensions in axes 0 and 1</p></li>
</ul>
<p>Think of it like stacking blocks:</p>
<ul class="simple">
<li><p>To stack vertically (axis=0), blocks must have the same width</p></li>
<li><p>To stack horizontally (axis=1), blocks must have the same height</p></li>
</ul>
</div>
</details>
</section>
</section>
</section>
<section id="summary-statistics">
<h5>Summary Statistics<a class="headerlink" href="#summary-statistics" title="Link to this heading"></a></h5>
<p>NumPy provides efficient functions to calculate statistical measures across arrays. These are essential for:</p>
<ul class="simple">
<li><p>Data exploration and understanding</p></li>
<li><p>Identifying patterns and outliers</p></li>
<li><p>Summarizing large datasets</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>np.sum()</p></td>
<td><p>Sum of array elements</p></td>
</tr>
<tr class="row-odd"><td><p>np.min()</p></td>
<td><p>Minimum value</p></td>
</tr>
<tr class="row-even"><td><p>np.max()</p></td>
<td><p>Maximum value</p></td>
</tr>
<tr class="row-odd"><td><p>np.mean()</p></td>
<td><p>Arithmetic mean (average)</p></td>
</tr>
<tr class="row-even"><td><p>np.median()</p></td>
<td><p>Median value</p></td>
</tr>
<tr class="row-odd"><td><p>np.std()</p></td>
<td><p>Standard deviation</p></td>
</tr>
<tr class="row-even"><td><p>np.var()</p></td>
<td><p>Variance</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>axis=None (default): Operate on all elements (flattened array)</p></li>
<li><p>axis=0: Collapse rows and operate along columns (down)</p></li>
<li><p>axis=1: Collapse columns and operate along rows (across)</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-7">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 2D array</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Our data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Sum of all elements</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total sum: </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># 21</span>

<span class="c1"># Column sums (axis=0)</span>
<span class="n">col_sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column sums: </span><span class="si">{</span><span class="n">col_sums</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># [5 7 9]</span>
<span class="c1">## Collapse values in rows along the the column 0 and aggregate: [1, 4] = 5</span>
<span class="c1">## Collapse values in rows along the the column 1 and aggregate: [2, 5] = 7</span>
<span class="c1">## Collapse values in rows along the the column 2 and aggregate: [3, 6] = 9</span>

<span class="c1"># Row sums (axis=1)</span>
<span class="n">row_sums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row sums: </span><span class="si">{</span><span class="n">row_sums</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># [6 15]</span>
<span class="c1">## Collapse values in columns along the the row 0 and aggregate: [1, 2, 3] = 6</span>
<span class="c1">## Collapse values in columns along the the row 1 and aggregate: [4, 5, 6] = 15</span>
</pre></div>
</div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p><strong>Reshaping Arrays:</strong> Maintain the total number of elements when reshaping; use -1 for automatic dimension calculation.</p></li>
<li><p><strong>Concatenation of Arrays:</strong> Combine arrays while matching dimensions, except along the concatenation axis.</p></li>
<li><p><strong>Statistical Functions:</strong> Utilize NumPy’s statistical functions for data analysis, operating across different axes.</p></li>
<li><p><strong>Error Handling:</strong> Be aware of shape requirements for concatenation to avoid errors.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-6.Vectorized_Operations_in_NumPy"></span><section id="vectorized-operations-in-numpy-beyond-python-loops">
<h4>Vectorized Operations in NumPy: Beyond Python Loops<a class="headerlink" href="#vectorized-operations-in-numpy-beyond-python-loops" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<p>By the end of this lecture, you will be able to:</p>
<ul class="simple">
<li><p>Understand and implement vectorized operations to replace traditional Python loops</p></li>
<li><p>Apply broadcasting to perform operations between arrays of different shapes</p></li>
<li><p>Optimize calculations for working with large biological datasets</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>Teaching : 20 min</p></li>
<li><p>Demo: 20 min</p></li>
</ul>
</div>
<section id="introduction-to-vectorized-operations">
<h5>Introduction to Vectorized Operations<a class="headerlink" href="#introduction-to-vectorized-operations" title="Link to this heading"></a></h5>
<section id="what-are-vectorized-operations">
<h6>What are Vectorized Operations?<a class="headerlink" href="#what-are-vectorized-operations" title="Link to this heading"></a></h6>
<p>Vectorized operations allow us to perform mathematical operations on entire arrays at once, rather than iterating through each element individually. This approach offers several key advantages:</p>
<ul class="simple">
<li><p>Performance:</p>
<ul>
<li><p>Vectorized operations are significantly faster than Python loops, especially for large datasets</p></li>
</ul>
</li>
<li><p>Readability:</p>
<ul>
<li><p>The code becomes more concise and often easier to understand</p></li>
</ul>
</li>
<li><p>Efficiency:</p>
<ul>
<li><p>NumPy uses optimized C code under the hood, making calculations much more efficient</p></li>
</ul>
</li>
</ul>
</section>
<section id="the-speed-advantage-loops-vs-vectorization">
<h6>The Speed Advantage: Loops vs. Vectorization<a class="headerlink" href="#the-speed-advantage-loops-vs-vectorization" title="Link to this heading"></a></h6>
<p>Let’s see a simple example comparing a traditional Python loop with NumPy’s vectorized approach:</p>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Create a large array for testing</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000000</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># Method 1: Traditional Python loop</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">result_loop</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">result_loop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">loop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python loop time: </span><span class="si">{</span><span class="n">loop_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Method 2: NumPy vectorized operation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">result_vectorized</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span>
<span class="n">vector_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy vectorized time: </span><span class="si">{</span><span class="n">vector_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the speedup</span>
<span class="n">speedup</span> <span class="o">=</span> <span class="n">loop_time</span> <span class="o">/</span> <span class="n">vector_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vectorized operations are </span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x faster!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Python loop time: 1.0195 seconds
NumPy vectorized time: 0.0613 seconds
Vectorized operations are 16.6x faster!
</pre></div>
</div>
</div>
</section>
</section>
<section id="basic-vectorized-operations-in-numpy">
<h5>Basic Vectorized Operations in NumPy<a class="headerlink" href="#basic-vectorized-operations-in-numpy" title="Link to this heading"></a></h5>
<section id="arithmetic-operations">
<h6>Arithmetic Operations<a class="headerlink" href="#arithmetic-operations" title="Link to this heading"></a></h6>
<p>NumPy enables element-wise arithmetic operations on arrays:</p>
<p><img alt="alt text" src="_images/image-8.png" /></p>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create two arrays</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="c1"># Element-wise operations</span>
<span class="n">addition</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">subtraction</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span>
<span class="n">multiplication</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<span class="n">division</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">a</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Addition: </span><span class="si">{</span><span class="n">addition</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subtraction: </span><span class="si">{</span><span class="n">subtraction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiplication: </span><span class="si">{</span><span class="n">multiplication</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Division: </span><span class="si">{</span><span class="n">division</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Addition: [11 22 33 44 55]
Subtraction: [ 9 18 27 36 45]
Multiplication: [ 10  40  90 160 250]
Division: [10. 10. 10. 10. 10.]
</pre></div>
</div>
</div>
</section>
<section id="scalar-operations">
<h6>Scalar Operations<a class="headerlink" href="#scalar-operations" title="Link to this heading"></a></h6>
<p>You can perform operations between arrays and scalars (single values):</p>
<p><img alt="alt text" src="_images/image-9.png" /></p>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scalar operations</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">plus_10</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">10</span>
<span class="n">times_2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">square</span> <span class="o">=</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">reciprocal</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">a</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plus 10: </span><span class="si">{</span><span class="n">plus_10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Times 2: </span><span class="si">{</span><span class="n">times_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Squared: </span><span class="si">{</span><span class="n">square</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reciprocal: </span><span class="si">{</span><span class="n">reciprocal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Plus 10: [11 12 13 14 15]
Times 2: [ 2  4  6  8 10]
Squared: [ 1  4  9 16 25]
Reciprocal: [1.         0.5        0.33333333 0.25       0.2       ]
</pre></div>
</div>
</div>
</section>
<section id="comparison-operations">
<h6>Comparison Operations<a class="headerlink" href="#comparison-operations" title="Link to this heading"></a></h6>
<p>Comparison operations create boolean masks that can be useful for filtering data:</p>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Comparison operations</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">greater_than_3</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">3</span>
<span class="n">less_than_equal_to_2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<span class="n">equal_to_3</span> <span class="o">=</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">3</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a &gt; 3: </span><span class="si">{</span><span class="n">greater_than_3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a &lt;= 2: </span><span class="si">{</span><span class="n">less_than_equal_to_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;a == 3: </span><span class="si">{</span><span class="n">equal_to_3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Using boolean masks for filtering</span>
<span class="n">filtered_data</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">greater_than_3</span><span class="p">]</span>   <span class="c1"># [4, 5]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values greater than 3: </span><span class="si">{</span><span class="n">filtered_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a &gt; 3: [False False False  True  True]
a &lt;= 2: [ True  True False False False]
a == 3: [False False  True False False]
Values greater than 3: [4 5]
</pre></div>
</div>
</div>
</section>
<section id="universal-functions-ufuncs">
<h6>Universal Functions (ufuncs)<a class="headerlink" href="#universal-functions-ufuncs" title="Link to this heading"></a></h6>
<p>NumPy provides a wide range of universal functions (ufuncs) that operate element-wise on arrays:</p>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Universal functions (ufuncs)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">sqrt_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>            <span class="c1"># Square root of each element</span>
<span class="n">log_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>              <span class="c1"># Natural logarithm of each element</span>
<span class="n">exp_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>              <span class="c1"># e raised to the power of each element</span>
<span class="n">sin_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>              <span class="c1"># Sine of each element</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Square roots: </span><span class="si">{</span><span class="n">sqrt_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Natural logs: </span><span class="si">{</span><span class="n">log_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exponentials: </span><span class="si">{</span><span class="n">exp_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sine values: </span><span class="si">{</span><span class="n">sin_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Square roots: [1.         1.41421356 1.73205081 2.         2.23606798]
Natural logs: [0.         0.69314718 1.09861229 1.38629436 1.60943791]
Exponentials: [  2.71828183   7.3890561   20.08553692  54.59815003 148.4131591 ]
Sine values: [ 0.84147098  0.90929743  0.14112001 -0.7568025  -0.95892427]
</pre></div>
</div>
</div>
</section>
<section id="aggregation-functions">
<h6>Aggregation Functions<a class="headerlink" href="#aggregation-functions" title="Link to this heading"></a></h6>
<p>NumPy also provides functions to calculate aggregate statistics across arrays:
<img alt="alt text" src="_images/image-10.png" /></p>
<div class="admonition-demo demo admonition" id="demo-5">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aggregation functions</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">sum_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                   <span class="c1"># Sum of all elements (15)</span>
<span class="n">mean_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                 <span class="c1"># Mean of all elements (3.0)</span>
<span class="n">min_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                   <span class="c1"># Minimum value (1)</span>
<span class="n">max_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                   <span class="c1"># Maximum value (5)</span>
<span class="n">std_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                   <span class="c1"># Standard deviation (~1.41)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum: </span><span class="si">{</span><span class="n">sum_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">mean_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min: </span><span class="si">{</span><span class="n">min_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max: </span><span class="si">{</span><span class="n">max_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation: </span><span class="si">{</span><span class="n">std_a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Sum: 15
Mean: 3.0
Min: 1
Max: 5
Standard deviation: 1.4142
</pre></div>
</div>
</div>
<p><strong>Use NumPy’s Built-in Functions</strong>: They’re optimized for performance</p>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Create a large array</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">1_000_000</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># Method 1: Custom function with a loop</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mean_std_loop</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="n">squared_diff_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="p">(</span><span class="n">squared_diff_sum</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span>

<span class="c1"># Method 2: NumPy&#39;s built-in functions</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mean_std_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="c1"># Time the loop version</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">mean1</span><span class="p">,</span> <span class="n">std1</span> <span class="o">=</span> <span class="n">mean_std_loop</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Time the NumPy version</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">mean2</span><span class="p">,</span> <span class="n">std2</span> <span class="o">=</span> <span class="n">mean_std_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">time2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loop implementation: </span><span class="si">{</span><span class="n">time1</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy implementation: </span><span class="si">{</span><span class="n">time2</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speed improvement: </span><span class="si">{</span><span class="n">time1</span><span class="o">/</span><span class="n">time2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Loop implementation: 0.156354 seconds
NumPy implementation: 0.002557 seconds
Speed improvement: 61.1x
</pre></div>
</div>
</div>
</section>
</section>
<section id="broadcasting-in-numpy">
<h5>3. Broadcasting in NumPy<a class="headerlink" href="#broadcasting-in-numpy" title="Link to this heading"></a></h5>
<section id="what-is-broadcasting">
<h6>What is Broadcasting?<a class="headerlink" href="#what-is-broadcasting" title="Link to this heading"></a></h6>
<p>Broadcasting is a powerful mechanism that allows NumPy to perform operations on arrays of different shapes. It automatically “broadcasts” the smaller array across the larger array so that they have compatible shapes.</p>
<p><img alt="alt text" src="_images/image-11.png" /></p>
</section>
<section id="broadcasting-rules">
<h6>Broadcasting Rules<a class="headerlink" href="#broadcasting-rules" title="Link to this heading"></a></h6>
<ol class="arabic simple">
<li><p>If the arrays don’t have the same number of dimensions, the shape of the smaller array is padded with ones on the left</p></li>
<li><p>If the shape of the arrays doesn’t match in any dimension, the array with shape equal to 1 in that dimension is stretched to match the other shape</p></li>
<li><p>If in any dimension the sizes disagree and neither is equal to 1, an error is raised</p></li>
</ol>
</section>
<section id="broadcasting-examples">
<h6>Broadcasting Examples<a class="headerlink" href="#broadcasting-examples" title="Link to this heading"></a></h6>
<section id="example-1-adding-a-scalar-to-an-array">
<h6 aria-level="7">Example 1: Adding a scalar to an array<a class="headerlink" href="#example-1-adding-a-scalar-to-an-array" title="Link to this heading"></a></h6>
<p>The simplest form of broadcasting:</p>
<div class="admonition-demo demo admonition" id="demo-6">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding a scalar to an array</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># Scalar 10 is broadcast to array [10, 10, 10, 10, 10]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>    <span class="c1"># [11, 12, 13, 14, 15]</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the sizes along a dimension differ, the array with size 1 in that dimension is stretched to match the other size</p>
</div>
</section>
<section id="example-2-operations-between-a-1d-array-and-a-2d-array">
<h6 aria-level="7">Example 2: Operations between a 1D array and a 2D array<a class="headerlink" href="#example-2-operations-between-a-1d-array-and-a-2d-array" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-7">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Broadcasting with different dimensional arrays</span>
<span class="c1"># Create a 2D array (3x3)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="p">])</span>

<span class="c1"># Create a 1D array</span>
<span class="n">row_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">+</span> <span class="n">row_vector</span>

<span class="c1"># Broadcasting: Add the 1D array to each row of the 2D array</span>
<span class="c1"># row_vector is broadcast to match matrix&#39;s shape</span>
<span class="c1"># NumPy&#39;s default broadcasting for 1D arrays applies column-wise</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Row vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row_vector</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Result after broadcasting addition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c1"># Output:</span>
<span class="c1"># [[11, 22, 33],</span>
<span class="c1">#  [14, 25, 36],</span>
<span class="c1">#  [17, 28, 39]]</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Row_vector is duplicated across the rows of the matrix</p>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">More info</p>
<details>
<summary>Additional info</summary>
<p>Example 3: Adding a column vector to a 2D array</p>
<div class="admonition-demo demo admonition" id="demo-8">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a column vector (3x1)</span>
<span class="n">column_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">]])</span>

<span class="c1"># Broadcasting: Add the column vector to each column of the matrix</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">+</span> <span class="n">column_vector</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Column vector:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">column_vector</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Result after broadcasting addition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c1"># Output:</span>
<span class="c1"># [[101, 102, 103],</span>
<span class="c1">#  [204, 205, 206],</span>
<span class="c1">#  [307, 308, 309]]</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">column_vector</span></code> is effectively repeated across all columns, resulting in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[100, 100, 100],
 [200, 200, 200],
 [300, 300, 300]]
</pre></div>
</div>
</div>
</details>
</section>
</section>
</section>
<section id="array-splitting-with-numpy">
<h5>Array Splitting with NumPy<a class="headerlink" href="#array-splitting-with-numpy" title="Link to this heading"></a></h5>
<p>Splitting arrays is a common operation when working with biological data, especially when you need to separate data into training and testing sets or divide data by conditions.</p>
<section id="basic-array-splitting">
<h6>Basic Array Splitting<a class="headerlink" href="#basic-array-splitting" title="Link to this heading"></a></h6>
<p>The <code class="docutils literal notranslate"><span class="pre">np.split</span></code> function allows you to divide an array into multiple sub-arrays:</p>
<div class="admonition-demo demo admonition" id="demo-9">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a simple array</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original array: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Split into 5 equal parts</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After splitting into 5 equal parts:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original array: [0 1 2 3 4 5 6 7 8 9]
After splitting into 5 equal parts:
Split 0: [0 1]
Split 1: [2 3]
Split 2: [4 5]
Split 3: [6 7]
Split 4: [8 9]
</pre></div>
</div>
</div>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-2">
<p class="admonition-title">More info</p>
<details>
<summary>Additional info</summary>
<p><strong>Splitting 2D Arrays:</strong></p>
<p>You can split arrays along different axes:</p>
<div class="admonition-demo demo admonition" id="demo-10">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 4x4 array</span>
<span class="n">arr_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original 2D array:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_2d</span><span class="p">)</span>

<span class="c1"># Split along rows (axis=0)</span>
<span class="n">row_splits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">arr_2d</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Split along rows (axis=0):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_splits</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>

<span class="c1"># Split along columns (axis=1)</span>
<span class="n">col_splits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">arr_2d</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Split along columns (axis=1):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">col_splits</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">split</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original 2D array:
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]
 [12 13 14 15]]

Split along rows (axis=0):
Split 0:
[[0 1 2 3]
 [4 5 6 7]]
Split 1:
[[ 8  9 10 11]
 [12 13 14 15]]

Split along columns (axis=1):
Split 0:
[[ 0  1]
 [ 4  5]
 [ 8  9]
 [12 13]]
Split 1:
[[ 2  3]
 [ 6  7]
 [10 11]
 [14 15]]
</pre></div>
</div>
</div>
</div>
</details>
</section>
<section id="splitting-at-specific-indices">
<h6>Splitting at Specific Indices<a class="headerlink" href="#splitting-at-specific-indices" title="Link to this heading"></a></h6>
<p>You can also split an array at specific indices:</p>
<div class="admonition-demo demo admonition" id="demo-11">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an array</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original array: </span><span class="si">{</span><span class="n">arr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Split at indices 2 and 7</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After splitting at indices [2, 7]:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">split</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original array: [0 1 2 3 4 5 6 7 8 9]

After splitting at indices [2, 7]:
Split 0: [0 1]
Split 1: [2 3 4 5 6]
Split 2: [7 8 9]
</pre></div>
</div>
</div>
<p>Application: Train-Test Split in machine learning</p>
<div class="admonition-more-info instructor-note admonition" id="instructor-note-3">
<p class="admonition-title">More info</p>
<details>
<summary>Additional info</summary>
<p><strong>Avoiding Common Mistakes:</strong></p>
<p><strong>Copying vs. Viewing</strong>: Be aware of when you’re creating a view versus a copy</p>
<div class="admonition-demo demo admonition" id="demo-12">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a view - changes to &#39;view&#39; will affect &#39;original&#39;</span>
<span class="n">original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">original</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">view</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original after modifying view: </span><span class="si">{</span><span class="n">original</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># [1, 99, 3, 4, 5]</span>

<span class="c1"># Creating a copy - changes to &#39;copy&#39; won&#39;t affect &#39;original&#39;</span>
<span class="n">original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">copy</span> <span class="o">=</span> <span class="n">original</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original after modifying copy: </span><span class="si">{</span><span class="n">original</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># [1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Broadcasting Dimensions</strong>: Be careful with dimensions when broadcasting</p>
<div class="admonition-demo demo admonition" id="demo-13">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This works as expected</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>  <span class="c1"># 2x3</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>            <span class="c1"># 1D with 3 elements</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="c1"># This will fail because dimensions don&#39;t align properly</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>            <span class="c1"># 1D with 2 elements</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">c</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</section>
</section>
<section id="best-practices">
<h5>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p><strong>Avoid Python Loops</strong> when working with numerical data; use vectorized operations instead</p></li>
<li><p><strong>Use Broadcasting</strong> wisely to make your code concise and efficient</p></li>
<li><p><strong>Pre-allocate Arrays</strong> when you know their size in advance</p></li>
<li><p><strong>Leverage NumPy’s Built-in Functions</strong> for optimal performance</p></li>
<li><p><strong>Be Mindful of Memory Usage</strong> when working with large biological datasets</p></li>
</ol>
<p>Vectorized operations in NumPy are a powerful tool for data analysis in computational biology. By replacing traditional loops with vectorized operations, you can significantly improve the performance and readability of your code, making it easier to work with large biological datasets.</p>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Vectorized Operations</strong> are much faster than Python loops for numerical computations</p></li>
<li><p><strong>Broadcasting</strong> allows operations between arrays of different shapes</p></li>
<li><p><strong>NumPy’s Universal Functions</strong> provide efficient implementations of common mathematical operations</p></li>
<li><p><strong>Array Splitting</strong> is useful for dividing data for analysis and machine learning</p></li>
</ol>
</div>
</section>
</section>
<span id="document-6.1.Numpy_hands_on"></span><section id="hands-on-rna-expression-analysis-alternative-method">
<h4>Hands-on: RNA Expression Analysis - alternative method<a class="headerlink" href="#hands-on-rna-expression-analysis-alternative-method" title="Link to this heading"></a></h4>
<section id="objective">
<h5>Objective<a class="headerlink" href="#objective" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Examine differential expression of immune-related genes between patient groups <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/30393759/">previously classified as immunologically strong (‘istrong’) and immunologically weak (‘iweak’)</a></p></li>
<li><p>Apply an alternative analytical approach using Z-ratio methodology to complement standard differential expression tools like DESeq</p></li>
<li><p>Ranks immune-related genes based on their relative expression differences between the patient groups</p></li>
</ul>
</section>
<section id="dataset-description">
<h5>Dataset description<a class="headerlink" href="#dataset-description" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test_data/Sample_group_info.csv</span></code></p>
<ul>
<li><p>Patients were divided into <code class="docutils literal notranslate"><span class="pre">istrong</span></code> (immunity-strong) and <code class="docutils literal notranslate"><span class="pre">iweak</span></code> (immunity-weak) groups based on their Immunity score</p></li>
<li><p>The Immunity score was calculated by averaging the gene expression values of the 17 identified immune-genes</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">test_data/count_matrix.csv</span></code>: Gene expression raw counts</p></li>
</ul>
</section>
<section id="steps">
<h5>Steps<a class="headerlink" href="#steps" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>Data Loading and visualization</p>
<ol class="arabic simple">
<li><p>Load sample group information (<code class="docutils literal notranslate"><span class="pre">iweak</span></code> vs <code class="docutils literal notranslate"><span class="pre">istrong</span></code>)</p></li>
<li><p>Load gene expression count matrix</p></li>
<li><p>Examine array information</p></li>
</ol>
</li>
<li><p>Sample Identification</p>
<ol class="arabic simple">
<li><p>Filter samples by group (<code class="docutils literal notranslate"><span class="pre">iweak</span></code>/<code class="docutils literal notranslate"><span class="pre">istrong</span></code>)</p></li>
<li><p>Match count matrix columns with sample IDs</p></li>
</ol>
</li>
<li><p>Data Preprocessing</p>
<ol class="arabic simple">
<li><p>Convert count matrix to numeric values</p></li>
<li><p>Apply log2 transformation: log2(counts + 1)</p></li>
</ol>
</li>
<li><p>Statistical Analysis</p>
<ol class="arabic simple">
<li><p>Calculate mean and std for each gene within each group</p></li>
<li><p>Compute Z-scores within each sample group</p></li>
<li><p>Calculate Z-score differences between groups</p></li>
<li><p>Compute standard deviation of all differences</p></li>
</ol>
</li>
<li><p>Ranking Genes</p>
<ol class="arabic simple">
<li><p>Calculate Z-ratio: difference / std_difference</p></li>
<li><p>Rank genes by Z-ratio (highest to lowest)</p></li>
</ol>
</li>
</ol>
<p><em><strong>Workflow:</strong></em></p>
<pre  class="mermaid">
        flowchart TD
    A[Load Sample Group Info] --&gt; B{Filter by Group}
    B --&gt;|iweak| C[Identify iweak samples]
    B --&gt;|istrong| D[Identify istrong samples]
    
    E[Load Count Matrix] --&gt; F[Match columns with samples]
    
    F --&gt; G[Convert to numeric]
    G --&gt; H[Log2 transformation]
    
    C --&gt; F
    D --&gt; F
    
    H --&gt; I1[Calculate iweak mean &amp; std]
    H --&gt; I2[Calculate istrong mean &amp; std]
    
    I1 --&gt; J1[Compute Z-scores for iweak]
    I2 --&gt; J2[Compute Z-scores for istrong]
    
    J1 --&gt; K[Calculate Z-score difference]
    J2 --&gt; K
    
    K --&gt; L[Calculate standard deviation]
    
    L --&gt; M[Compute Z-ratio]
    
    M --&gt; N[Rank genes by Z-ratio]
    
    classDef dataNode fill:#f9f9f9,stroke:#aaa,stroke-width:2px;
    classDef processNode fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef resultNode fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;
    
    class A,E dataNode;
    class B,C,D,F,G,H,I1,I2,J1,J2,K,L,M processNode;
    class N resultNode;
    </pre></section>
<section id="step-1-loading-and-inspecting-data">
<h5>Step 1: Loading and inspecting data<a class="headerlink" href="#step-1-loading-and-inspecting-data" title="Link to this heading"></a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.request</span><span class="w"> </span><span class="kn">import</span> <span class="n">urlopen</span>

<span class="c1"># Read the CSV file into a numpy array</span>
<span class="c1">## CSV file contains sample group information</span>
<span class="n">sample_group_info_url</span><span class="o">=</span> <span class="s2">&quot;https://coderefinery.github.io/intermediate-python-ml/_downloads/b458a48eed87eb03931a8ce6efcdd351/Sample_group_info.csv&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">urlopen</span><span class="p">(</span><span class="n">sample_group_info_url</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the numpy array information</span>

<span class="k">def</span><span class="w"> </span><span class="nf">print_array_info</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="c1"># Get the shape of the array</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Get the number of dimensions of the array</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span>

    <span class="c1"># Get the data type of the array</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">dtype</span>

    <span class="c1"># Get the number of elements in the array</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">size</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Number of dimensions: </span><span class="si">{</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Data type: </span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Size: </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_array_info</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: (303, 2) 
Number of dimensions: 2 
Data type: &lt;U12 
Size: 606
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the CSV file into a numpy array with string dtype</span>
<span class="c1">## CSV file contains RNA count matrix</span>

<span class="n">count_matrix_url</span> <span class="o">=</span> <span class="s2">&quot;https://coderefinery.github.io/intermediate-python-ml/_downloads/ab7de98031b77441be14a9d7ba21466c/count_matrix.csv&quot;</span>

<span class="n">count_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">urlopen</span><span class="p">(</span><span class="n">count_matrix_url</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                     <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: (81, 483) 
Number of dimensions: 2 
Data type: &lt;U18 
Size: 39123
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove sample names from the count matrix (cm) - Delete the first row</span>
<span class="c1">## Convert the cm to a float32 array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;___&quot;</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;SH_TS_BC_C1&#39; &#39;SH_TS_BC_C11&#39; &#39;SH_TS_BC_C15&#39; &#39;SH_TS_BC_C3&#39; &#39;SH_TS_BC01&#39;]
 [&#39;25&#39; &#39;559&#39; &#39;231&#39; &#39;44&#39; &#39;23&#39;]
 [&#39;173&#39; &#39;2475&#39; &#39;886&#39; &#39;320&#39; &#39;6&#39;]
 [&#39;114&#39; &#39;8806&#39; &#39;2781&#39; &#39;537&#39; &#39;47&#39;]
 [&#39;626&#39; &#39;7492&#39; &#39;2829&#39; &#39;564&#39; &#39;14&#39;]]
___
[[2.500e+01 5.590e+02 2.310e+02 4.400e+01 2.300e+01]
 [1.730e+02 2.475e+03 8.860e+02 3.200e+02 6.000e+00]
 [1.140e+02 8.806e+03 2.781e+03 5.370e+02 4.700e+01]
 [6.260e+02 7.492e+03 2.829e+03 5.640e+02 1.400e+01]
 [3.170e+02 5.949e+03 2.357e+03 2.750e+02 2.600e+01]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-sample-identification">
<h5>Step 2: Sample Identification<a class="headerlink" href="#step-2-sample-identification" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>Filter samples by group (iweak/istrong)</p></li>
<li><p>Match count matrix columns with sample IDs</p></li>
</ol>
<p><img alt="alt text" src="_images/image-12.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the first 5 rows and columns of the data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;SH_TS_BC111&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC112&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC113&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC119&#39; &#39;istrong&#39;]
 [&#39;SH_TS_BC133&#39; &#39;iweak&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access indices of the array where the second column is &#39;iweak&#39;</span>
<span class="n">iweak_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;iweak&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iweak_index</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">iweak_index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([  0,   1,   2,   4,   5,   6,   7,   8,   9,  12,  14,  15,  16,
        17,  18,  21,  24,  25,  27,  31,  33,  34,  35,  38,  39,  41,
        43,  45,  47,  49,  50,  51,  53,  54,  55,  56,  59,  60,  61,
        63,  64,  65,  67,  69,  71,  72,  73,  74,  75,  78,  80,  81,
        84,  86,  92,  93,  94,  97, 102, 106, 108, 111, 112, 114, 122,
       123, 126, 131, 132, 133, 139, 142, 145, 146, 148, 149, 150, 151,
       160, 161, 163, 164, 166, 168, 170, 171, 173, 176, 177, 180, 186,
       188, 192, 195, 196, 197, 200, 203, 206, 207, 212, 214, 215, 216,
       217, 219, 223, 225, 226, 227, 228, 230, 235, 244, 248, 249, 252,
       256, 258, 260, 262, 263, 265, 266, 269, 270, 271, 275, 276, 278,
       279, 280, 282, 283, 285, 286, 287, 288, 289, 291, 292, 293, 294,
       295, 296, 298, 299, 300, 302]),)
Shape: (149,) 
Number of dimensions: 1 
Data type: int64 
Size: 149
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access indices of the array where the second column is &#39;iweak&#39;</span>
<span class="n">iweak_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;iweak&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Index</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">iweak_index</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">iweak_index</span><span class="p">][:</span><span class="mi">5</span><span class="p">,])</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">iweak_index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index
 [0 1 2 4 5] 
Data
 [[&#39;SH_TS_BC111&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC112&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC113&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC133&#39; &#39;iweak&#39;]
 [&#39;SH_TS_BC134&#39; &#39;iweak&#39;]]
Shape: (149,) 
Number of dimensions: 1 
Data type: int64 
Size: 149
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View the first column of the count matrix where the sample group is &#39;iweak&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;SH_TS_BC_C1&#39; &#39;SH_TS_BC_C11&#39; &#39;SH_TS_BC_C15&#39; &#39;SH_TS_BC_C3&#39; &#39;SH_TS_BC01&#39;]
 [&#39;25&#39; &#39;559&#39; &#39;231&#39; &#39;44&#39; &#39;23&#39;]
 [&#39;173&#39; &#39;2475&#39; &#39;886&#39; &#39;320&#39; &#39;6&#39;]
 [&#39;114&#39; &#39;8806&#39; &#39;2781&#39; &#39;537&#39; &#39;47&#39;]
 [&#39;626&#39; &#39;7492&#39; &#39;2829&#39; &#39;564&#39; &#39;14&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a boolean mask to find if the columns in the count matrix where the sample group is &#39;iweak&#39;</span>
<span class="n">cm_iweak_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="n">iweak_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm_iweak_mask</span><span class="p">[:</span><span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[False False False False False False False False False False False False
 False False False False False False False False False False False False
 False  True  True  True False False]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the indices of the columns in the count matrix where the sample group is &#39;iweak&#39;</span>
<span class="n">cm_weak_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cm_iweak_mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm_weak_cols</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">cm_weak_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 25  26  27  36  37  38  40  41  42  46  48  49  51  52  53  56  64  65
  67  71  73  74  75  79  80  83  85  88  91  93  94  95  97  98  99 100
 103 104 105 108 109 110 112 114 116 117 118 119 120 124 126 128 131 133]
Shape: (54,) 
Number of dimensions: 1 
Data type: int64 
Size: 54
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access indices of the array where the second column is &#39;istrong&#39;</span>
<span class="c1">## Assign the indices to a istrong_index (not the tuple returned by np.where)</span>
<span class="n">istrong_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;istrong&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">istrong_index</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">istrong_index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  3  10  11  13  19  20  22  23  26  28  29  30  32  36  37  40  42  44
  46  48  52  57  58  62  66  68  70  76  77  79  82  83  85  87  88  89
  90  91  95  96  98  99 100 101 103 104 105 107 109 110 113 115 116 117
 118 119 120 121 124 125 127 128 129 130 134 135 136 137 138 140 141 143
 144 147 152 153 154 155 156 157 158 159 162 165 167 169 172 174 175 178
 179 181 182 183 184 185 187 189 190 191 193 194 198 199 201 202 204 205
 208 209 210 211 213 218 220 221 222 224 229 231 232 233 234 236 237 238
 239 240 241 242 243 245 246 247 250 251 253 254 255 257 259 261 264 267
 268 272 273 274 277 281 284 290 297 301]
Shape: (154,) 
Number of dimensions: 1 
Data type: int64 
Size: 154
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the indices of the columns in the count matrix where the sample group is &#39;istrong&#39;</span>
<span class="n">cm_strong_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">data</span><span class="p">[</span><span class="n">istrong_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm_strong_cols</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">cm_strong_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 33  44  45  47  54  55  58  63  66  68  69  70  72  76  78  81  84  86
  89  92  96 101 102 107 111 113 115 121 122 125 129 130 132 134 136 137
 138]
Shape: (37,) 
Number of dimensions: 1 
Data type: int64 
Size: 37
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(81, 483)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-data-preprocessing">
<h5>Step 3: Data Preprocessing<a class="headerlink" href="#step-3-data-preprocessing" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Convert count matrix to numeric values</p></li>
<li><p>Apply log2 transformation: log2(counts + 1)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove sample names from the count matrix (cm) - Delete the first row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;___&quot;</span><span class="p">)</span>
<span class="c1">## Convert the cm to a float32 array</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;SH_TS_BC_C1&#39; &#39;SH_TS_BC_C11&#39; &#39;SH_TS_BC_C15&#39; &#39;SH_TS_BC_C3&#39; &#39;SH_TS_BC01&#39;]
 [&#39;25&#39; &#39;559&#39; &#39;231&#39; &#39;44&#39; &#39;23&#39;]
 [&#39;173&#39; &#39;2475&#39; &#39;886&#39; &#39;320&#39; &#39;6&#39;]
 [&#39;114&#39; &#39;8806&#39; &#39;2781&#39; &#39;537&#39; &#39;47&#39;]
 [&#39;626&#39; &#39;7492&#39; &#39;2829&#39; &#39;564&#39; &#39;14&#39;]]
___
[[2.500e+01 5.590e+02 2.310e+02 4.400e+01 2.300e+01]
 [1.730e+02 2.475e+03 8.860e+02 3.200e+02 6.000e+00]
 [1.140e+02 8.806e+03 2.781e+03 5.370e+02 4.700e+01]
 [6.260e+02 7.492e+03 2.829e+03 5.640e+02 1.400e+01]
 [3.170e+02 5.949e+03 2.357e+03 2.750e+02 2.600e+01]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert cm to log scale</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">cm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 4.70044    9.129283   7.857981  ...  0.         6.5999126  7.936638 ]
 [ 7.4429436 11.273795   9.79279   ...  6.794416   9.865733  11.2842455]
 [ 6.84549   13.104435  11.441907  ...  9.187352  10.403012  11.279611 ]
 ...
 [10.675957  13.7911625 12.428099  ... 10.456354  11.276706  12.22581  ]
 [ 4.857981   8.169925   7.491853  ...  8.948367   4.5849624  8.204571 ]
 [ 9.432542  12.378024  10.899357  ... 10.82893   13.397273  14.26415  ]]
Shape: (80, 483) 
Number of dimensions: 2 
Data type: float32 
Size: 38640
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean and STD of each gene in iweak samples</span>
<span class="n">iweak_mean</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[:,</span> <span class="n">cm_weak_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="c1">## Mean of iweak samples</span>
<span class="n">iweak_std</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[:,</span> <span class="n">cm_weak_cols</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="c1">## STD of iweak samples</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak_mean&quot;</span><span class="p">,</span> <span class="n">iweak_mean</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">iweak_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak_std&quot;</span><span class="p">,</span> <span class="n">iweak_std</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">iweak_std</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iweak_mean [7.8603177 8.870119  8.839295  9.873015  8.818066 ] (80,)
iweak_std [1.9773906 1.5399547 2.0553062 1.1807643 2.1794095] (80,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean and STD of each gene in istrong samples</span>
<span class="n">istrong_mean</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[:,</span><span class="n">cm_strong_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">## Mean of istrong disease samples</span>
<span class="n">istrong_std</span> <span class="o">=</span> <span class="n">cm</span><span class="p">[:,</span><span class="n">cm_strong_cols</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">## STD of istrong samples</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;istrong_mean&quot;</span><span class="p">,</span> <span class="n">istrong_mean</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">istrong_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;istrong_std&quot;</span><span class="p">,</span> <span class="n">istrong_std</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">istrong_std</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>istrong_mean [ 6.9949713  6.953521  10.527761   9.192108   9.029262 ] (80,)
istrong_std [2.2878554 2.8049028 1.3030388 2.2123892 1.9921837] (80,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-statistical-analysis">
<h5>Step 4: Statistical Analysis<a class="headerlink" href="#step-4-statistical-analysis" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p>Calculate mean and std for each gene within each group</p></li>
<li><p>Compute Z-scores within each sample group</p></li>
<li><p>Calculate Z-score differences between groups</p></li>
<li><p>Compute standard deviation of all differences</p></li>
</ol>
<p><strong>Z-scores:</strong></p>
<ul class="simple">
<li><p>Gene expression measurements (counts) can have vastly different scales across different samples due to technical variations</p></li>
<li><p>The Z-score transformation standardizes these measurements</p></li>
</ul>
<p>$$ Z_{G} = \frac{(Count_G - \mu_{Count_{group}})}{\sigma_{Count_{group}}} $$</p>
<p>$$ Z_{G} : Z-score\ for\ a\ gene\ G$$
$$ Count_G: Log10\ count\ of\ gene\ G\ in\ a\ given\ sample$$
$$ \mu_{Count_{group}}: The\ overall\ average\ across\ all\ samples\ in\ the\ given\ group\ for\ each\ gene$$
$$ \sigma_{Count_{group}}: Standard\ deviation\ all\ samples\ in\ the\ given\ group\ for\ each\ gene$$</p>
<p><img alt="alt text" src="_images/image-16.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Z-scores of each gene in iweak samples (vectorized)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">iweak_mean</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">iweak_std</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">## use .reshape(-1, 1) to convert the mean and std to column vectors</span>
<span class="c1">## This is necessary for vectorized operations to work correctly</span>
<span class="n">cm_iweak_z</span> <span class="o">=</span> <span class="p">(</span><span class="n">cm</span><span class="p">[:,</span> <span class="n">cm_weak_cols</span><span class="p">]</span> <span class="o">-</span> <span class="n">iweak_mean</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">iweak_std</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">## The reshape is necessary because you want to subtract/divide row-wise, but NumPy&#39;s default broadcasting for 1D arrays applies column-wise.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cm_iweak_z&quot;</span><span class="p">,</span> <span class="n">cm_iweak_z</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">cm_iweak_z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80, 483) (80,) (80,)
cm_iweak_z [[-0.8058757  -0.7423927  -0.9294824   0.4624626  -0.95228404]
 [-1.1998737  -2.0764856   0.16326085  0.22980079 -5.1106176 ]
 [-4.3007193   0.31064132 -0.57465094  0.26697835 -1.5138254 ]
 [-1.1198412  -1.3803278   0.17033552  1.1318417  -2.3681269 ]
 [-4.04608    -0.28826228 -0.18751603  0.5879035  -1.0315684 ]]
Shape: (80, 54) 
Number of dimensions: 2 
Data type: float32 
Size: 4320
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Z-scores of each gene in istrong samples (vectorized)</span>
<span class="n">cm_istrong_z</span> <span class="o">=</span> <span class="p">(</span><span class="n">cm</span><span class="p">[:,</span> <span class="n">cm_strong_cols</span><span class="p">]</span> <span class="o">-</span> <span class="n">istrong_mean</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">istrong_std</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cm_istrong_z&quot;</span><span class="p">,</span> <span class="n">cm_istrong_z</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">cm_istrong_z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cm_istrong_z [[ 0.2545867   0.7559668   0.47983187  1.1538492   0.3143879 ]
 [ 0.97684896 -0.04753883  0.8586477   1.0635368   0.32466918]
 [ 0.13716765  0.28922623  1.1129626   1.229808    0.77283007]
 [ 0.4442336   0.6031446   0.74163324  0.75332576  0.71388024]
 [ 0.29755822  1.1648388   1.0060126   0.3692481  -0.07359705]]
Shape: (80, 37) 
Number of dimensions: 2 
Data type: float32 
Size: 2960
</pre></div>
</div>
</div>
</div>
<p><strong>Z-ratio = Z-score difference (per gene):</strong></p>
<ul class="simple">
<li><p>The Z-ratio provides a standardized measure of the difference between conditions for each gene</p></li>
<li><p>This accounts for the overall variability in the experiment</p></li>
<li><p>A gene showing a difference of, say, 0.5 in average Z-score</p>
<ul>
<li><p>might be highly significant if most genes show very little difference (small Z-score difference - SD),</p></li>
<li><p>but not significant if many genes show large differences (large Z-score difference - SD)</p></li>
</ul>
</li>
<li><p>It puts the individual gene’s change in the context of the overall experimental variation</p></li>
</ul>
<p>$$ Z.score_{Diff_{gene}} = \bar{Z}<em>{Gene, istring} - \bar{Z}</em>{Gene, iweak} $$</p>
<p>$$ Z_{Ratio, Gene} = \frac{Z.score_{Diff_{gene}}}{SD_{Z.score_{Diff_{gene}}}} $$</p>
<p><img alt="alt text" src="_images/image-17.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_z_scores</span> <span class="o">=</span> <span class="n">cm_istrong_z</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">cm_iweak_z</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_diff</span> <span class="o">=</span> <span class="n">diff_z_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1">### z-score ratio for each gene</span>
<span class="c1">## Divide Z-Ratio differences by the Z-Ratio differences SD</span>
<span class="n">z_score_ratios</span> <span class="o">=</span> <span class="n">diff_z_scores</span> <span class="o">/</span> <span class="n">std_diff</span>
<span class="n">print_array_info</span><span class="p">(</span><span class="n">z_score_ratios</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z_score_ratios</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: (80,) 
Number of dimensions: 1 
Data type: float32 
Size: 80
[-0.43179178 -1.5044755   1.247218    0.22787355  0.64381164  0.83408666
  0.96931595  2.2225075   2.1141531   0.49432233]
</pre></div>
</div>
</div>
</div>
</section>
<section id="step5-rank-genes-according-to-the-z-score-ratio">
<h5>Step5: Rank genes according to the Z score ratio:<a class="headerlink" href="#step5-rank-genes-according-to-the-z-score-ratio" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Sort z_score_ratio in descending order and access indices</p></li>
<li><p>Rank genes using indices</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gene_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ACTR3B&quot;</span><span class="p">,</span> <span class="s2">&quot;ANLN&quot;</span><span class="p">,</span> <span class="s2">&quot;APOBEC3G&quot;</span><span class="p">,</span> <span class="s2">&quot;AURKA&quot;</span><span class="p">,</span> <span class="s2">&quot;BAG1&quot;</span><span class="p">,</span> <span class="s2">&quot;BCL2&quot;</span><span class="p">,</span> <span class="s2">&quot;BIRC5&quot;</span><span class="p">,</span> <span class="s2">&quot;BLVRA&quot;</span><span class="p">,</span> <span class="s2">&quot;CCL5&quot;</span><span class="p">,</span> <span class="s2">&quot;CCNB1&quot;</span><span class="p">,</span> <span class="s2">&quot;CCNE1&quot;</span><span class="p">,</span> <span class="s2">&quot;CCR2&quot;</span><span class="p">,</span> <span class="s2">&quot;CD2&quot;</span><span class="p">,</span> <span class="s2">&quot;CD27&quot;</span><span class="p">,</span> <span class="s2">&quot;CD3D&quot;</span><span class="p">,</span> <span class="s2">&quot;CD52&quot;</span><span class="p">,</span> <span class="s2">&quot;CD68&quot;</span><span class="p">,</span> <span class="s2">&quot;CDC20&quot;</span><span class="p">,</span> <span class="s2">&quot;CDC6&quot;</span><span class="p">,</span> <span class="s2">&quot;CDH3&quot;</span><span class="p">,</span> <span class="s2">&quot;CENPF&quot;</span><span class="p">,</span> <span class="s2">&quot;CEP55&quot;</span><span class="p">,</span> <span class="s2">&quot;CORO1A&quot;</span><span class="p">,</span> <span class="s2">&quot;CTSL2&quot;</span><span class="p">,</span> <span class="s2">&quot;CXCL9&quot;</span><span class="p">,</span> <span class="s2">&quot;CXXC5&quot;</span><span class="p">,</span> <span class="s2">&quot;EGFR&quot;</span><span class="p">,</span> <span class="s2">&quot;ERBB2&quot;</span><span class="p">,</span> <span class="s2">&quot;ESR1&quot;</span><span class="p">,</span> <span class="s2">&quot;EXO1&quot;</span><span class="p">,</span> <span class="s2">&quot;FGFR4&quot;</span><span class="p">,</span> <span class="s2">&quot;FOXA1&quot;</span><span class="p">,</span> <span class="s2">&quot;FOXC1&quot;</span><span class="p">,</span> <span class="s2">&quot;GAPDH&quot;</span><span class="p">,</span> <span class="s2">&quot;GPR160&quot;</span><span class="p">,</span> <span class="s2">&quot;GRB7&quot;</span><span class="p">,</span> <span class="s2">&quot;GSTM1&quot;</span><span class="p">,</span> <span class="s2">&quot;GUSB&quot;</span><span class="p">,</span> <span class="s2">&quot;GZMA&quot;</span><span class="p">,</span> <span class="s2">&quot;GZMK&quot;</span><span class="p">,</span> <span class="s2">&quot;HLA-DMA&quot;</span><span class="p">,</span> <span class="s2">&quot;IL2RG&quot;</span><span class="p">,</span> <span class="s2">&quot;KIF2C&quot;</span><span class="p">,</span> <span class="s2">&quot;KRT14&quot;</span><span class="p">,</span> <span class="s2">&quot;KRT17&quot;</span><span class="p">,</span> <span class="s2">&quot;KRT5&quot;</span><span class="p">,</span> <span class="s2">&quot;LCK&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPT&quot;</span><span class="p">,</span> <span class="s2">&quot;MDM2&quot;</span><span class="p">,</span> <span class="s2">&quot;MELK&quot;</span><span class="p">,</span> <span class="s2">&quot;MIA&quot;</span><span class="p">,</span> <span class="s2">&quot;MKI67&quot;</span><span class="p">,</span> <span class="s2">&quot;MLPH&quot;</span><span class="p">,</span> <span class="s2">&quot;MMP11&quot;</span><span class="p">,</span> <span class="s2">&quot;MRPL19&quot;</span><span class="p">,</span> <span class="s2">&quot;MYBL2&quot;</span><span class="p">,</span> <span class="s2">&quot;MYC&quot;</span><span class="p">,</span> <span class="s2">&quot;NAT1&quot;</span><span class="p">,</span> <span class="s2">&quot;NDC80&quot;</span><span class="p">,</span> <span class="s2">&quot;NUF2&quot;</span><span class="p">,</span> <span class="s2">&quot;ORC6&quot;</span><span class="p">,</span> <span class="s2">&quot;PGR&quot;</span><span class="p">,</span> <span class="s2">&quot;PHGDH&quot;</span><span class="p">,</span> <span class="s2">&quot;PRKCB&quot;</span><span class="p">,</span> <span class="s2">&quot;PSMC4&quot;</span><span class="p">,</span> <span class="s2">&quot;PTPRC&quot;</span><span class="p">,</span> <span class="s2">&quot;PTTG1&quot;</span><span class="p">,</span> <span class="s2">&quot;RRM2&quot;</span><span class="p">,</span> <span class="s2">&quot;SCUBE2&quot;</span><span class="p">,</span> <span class="s2">&quot;SF3A1&quot;</span><span class="p">,</span> <span class="s2">&quot;SFRP1&quot;</span><span class="p">,</span> <span class="s2">&quot;SH2D1A&quot;</span><span class="p">,</span> <span class="s2">&quot;SLC39A6&quot;</span><span class="p">,</span> <span class="s2">&quot;TFRC&quot;</span><span class="p">,</span> <span class="s2">&quot;TMEM45B&quot;</span><span class="p">,</span> <span class="s2">&quot;TP53&quot;</span><span class="p">,</span> <span class="s2">&quot;TYMS&quot;</span><span class="p">,</span> <span class="s2">&quot;UBE2C&quot;</span><span class="p">,</span> <span class="s2">&quot;UBE2T&quot;</span><span class="p">,</span> <span class="s2">&quot;VEGFA&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### `np.argsort()` returns indices of the array that would sort in ascending order</span>
<span class="c1">### slicing syntax [start:stop:step] with step -1 returns a reversed array</span>

<span class="n">gene_ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">z_score_ratios</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genes ranked according to Z-score ratio:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)[</span><span class="n">gene_ranks</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Genes ranked according to Z-score ratio:
[&#39;PSMC4&#39; &#39;FOXC1&#39; &#39;TP53&#39; &#39;BLVRA&#39; &#39;CCL5&#39; &#39;CD68&#39; &#39;PTPRC&#39; &#39;GRB7&#39; &#39;APOBEC3G&#39;
 &#39;MRPL19&#39; &#39;CENPF&#39; &#39;BIRC5&#39; &#39;UBE2C&#39; &#39;PHGDH&#39; &#39;ERBB2&#39; &#39;TFRC&#39; &#39;BCL2&#39; &#39;GUSB&#39;
 &#39;MDM2&#39; &#39;KRT5&#39; &#39;BAG1&#39; &#39;FOXA1&#39; &#39;CCNB1&#39; &#39;KRT17&#39; &#39;CEP55&#39; &#39;KRT14&#39; &#39;NDC80&#39;
 &#39;AURKA&#39; &#39;CXCL9&#39; &#39;TMEM45B&#39; &#39;SLC39A6&#39; &#39;GZMK&#39; &#39;PTTG1&#39; &#39;GPR160&#39; &#39;IL2RG&#39;
 &#39;GZMA&#39; &#39;MYC&#39; &#39;EXO1&#39; &#39;MKI67&#39; &#39;TYMS&#39; &#39;PGR&#39; &#39;SH2D1A&#39; &#39;CD27&#39; &#39;PRKCB&#39; &#39;CCR2&#39;
 &#39;NUF2&#39; &#39;RRM2&#39; &#39;MIA&#39; &#39;MELK&#39; &#39;ESR1&#39; &#39;SF3A1&#39; &#39;UBE2T&#39; &#39;EGFR&#39; &#39;CCNE1&#39; &#39;MAPT&#39;
 &#39;KIF2C&#39; &#39;MMP11&#39; &#39;HLA-DMA&#39; &#39;NAT1&#39; &#39;CTSL2&#39; &#39;MLPH&#39; &#39;CXXC5&#39; &#39;CD2&#39; &#39;ACTR3B&#39;
 &#39;CORO1A&#39; &#39;SFRP1&#39; &#39;FGFR4&#39; &#39;CD3D&#39; &#39;ORC6&#39; &#39;LCK&#39; &#39;CD52&#39; &#39;CDH3&#39; &#39;GSTM1&#39;
 &#39;VEGFA&#39; &#39;SCUBE2&#39; &#39;CDC6&#39; &#39;ANLN&#39; &#39;MYBL2&#39; &#39;CDC20&#39; &#39;GAPDH&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-7.Pandas_lesson plan"></span><section id="lesson-plan">
<h4>Lesson plan<a class="headerlink" href="#lesson-plan" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ol class="arabic simple">
<li><p><strong>Understand the Basics</strong>: Familiarize participants with the fundamentals of the Pandas library and its relationship with NumPy.</p></li>
<li><p><strong>Data Handling</strong>: Equip participants with the skills to import and export various data formats using Pandas, facilitating easy data manipulation and analysis.</p></li>
<li><p><strong>Data Manipulation Skills</strong>: Provide practical techniques for data manipulation, including selection, addition, removal, and handling of missing values within DataFrames.</p></li>
<li><p><strong>Indexing Proficiency</strong>: Enable participants to effectively index and select data from DataFrames using various methods, enhancing their data exploration capabilities.</p></li>
<li><p><strong>Data Analysis Techniques</strong>: Introduce advanced data transformation, grouping, and aggregation techniques, enabling participants to perform in-depth data analysis and summarization.</p></li>
</ol>
</div>
<section id="specific-objectives">
<h5>Specific Objectives<a class="headerlink" href="#specific-objectives" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Introduction to Pandas</p>
<ul>
<li><p>Explain the relationship between Pandas and NumPy, highlighting when to use each library effectively.</p></li>
<li><p>Define and differentiate between Series and DataFrame data structures in Pandas.</p></li>
<li><p>Demonstrate the creation of Pandas objects from NumPy arrays, solidifying foundational knowledge.</p></li>
</ul>
</li>
<li><p>Data Import and Export</p>
<ul>
<li><p>Illustrate how to read data from various formats, including CSV, Excel, and JSON, into Pandas.</p></li>
<li><p>Show how to export DataFrames to different formats, ensuring participants can save their analyses.</p></li>
<li><p>Utilize data inspection methods (head, info, describe) to gain an understanding of data structure and content.</p></li>
</ul>
</li>
<li><p>DataFrame Manipulation &amp; Sorting</p>
<ul>
<li><p>Demonstrate effective techniques for selecting specific rows and from DataFrames.</p></li>
<li><p>Equip participants with skills to add and remove columns within a DataFrame.</p></li>
<li><p>Implement sorting methods by values, by index, and perform multiple column sorting with custom orders.</p></li>
</ul>
</li>
<li><p>Indexing, Selection &amp; Slicing</p>
<ul>
<li><p>Differentiate between label-based and position-based indexing and apply each method appropriately.</p></li>
<li><p>Use Boolean indexing to filter data based on specific conditions, connecting concepts from NumPy.</p></li>
<li><p>Apply .loc, .iloc, and .at selection methods to extract desired data, and employ multi-level slicing techniques.</p></li>
</ul>
</li>
<li><p>Handling Missing Data</p>
<ul>
<li><p>Identify missing values in DataFrames using isna() and notna() methods.</p></li>
<li><p>Strategize the filling of missing values with fillna() and interpolation methods tailored to scenario needs.</p></li>
<li><p>Demonstrate how to drop missing data with dropna() and discuss various strategies for handling missing data.</p></li>
</ul>
</li>
<li><p>Merging DataFrames</p>
<ul>
<li><p>Illustrate how to concatenate DataFrames using pd.concat() and understand its applications.</p></li>
<li><p>Explain database-style joins with the merge() function and illustrate the different join types (inner, outer, left, * right).</p></li>
<li><p>Address challenges faced with duplicate columns and indexes during merging operations.</p></li>
</ul>
</li>
<li><p>Summary Statistics &amp; Aggregations</p>
<ul>
<li><p>Calculate basic statistics (mean, median, min, max) to summarize and analyze data.</p></li>
<li><p>Develop custom aggregation functions for specific needs in data analysis.</p></li>
<li><p>Apply GroupBy operations effectively, utilizing the Split-Apply-Combine pattern to derive insights from grouped data.</p></li>
</ul>
</li>
<li><p>Advanced Data Transformation</p>
<ul>
<li><p>Utilize apply() and map() functions for advanced data transformation on DataFrames.</p></li>
<li><p>Perform string and datetime operations effectively using Pandas functionality.</p></li>
<li><p>Construct pivot tables and crosstabs to summarize data visually and contextually.</p></li>
</ul>
</li>
<li><p>Practical Exercises and Q&amp;A</p>
<ul>
<li><p>Execute practical exercises using real-world datasets to reinforce concepts learned during the workshop.</p></li>
<li><p>Connect concepts from both NumPy and Pandas to solidify understanding through application.</p></li>
<li><p>Engage in a Q&amp;A session to clarify doubts, deepen understanding, and discuss challenges faced during practical sessions</p></li>
</ul>
</li>
</ul>
</section>
<section id="time-schedule">
<h5>Time schedule<a class="headerlink" href="#time-schedule" title="Link to this heading"></a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Session</p></th>
<th class="head"><p>Time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Introduction to Pandas</p></td>
<td><p>15 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Break</p></td>
<td><p>5 mins</p></td>
</tr>
<tr class="row-even"><td><p>Data Import and Export</p></td>
<td><p>15 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Break</p></td>
<td><p>5 mins</p></td>
</tr>
<tr class="row-even"><td><p>DataFrame Manipulation &amp; Sorting</p></td>
<td><p>25 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Break</p></td>
<td><p>5 mins</p></td>
</tr>
<tr class="row-even"><td><p>Indexing, Selection &amp; Slicing</p></td>
<td><p>20 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Break</p></td>
<td><p>10 mins</p></td>
</tr>
<tr class="row-even"><td><p>Handling Missing Data</p></td>
<td><p>8 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Merging DataFrames</p></td>
<td><p>8 mins</p></td>
</tr>
<tr class="row-even"><td><p>Break</p></td>
<td><p>5 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Summary Statistics &amp; Aggregations</p></td>
<td><p>20 mins</p></td>
</tr>
<tr class="row-even"><td><p>Break</p></td>
<td><p>5 mins</p></td>
</tr>
<tr class="row-odd"><td><p>Practical Exercises and Q&amp;A</p></td>
<td><p>20 mins</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<span id="document-8.Introduction_to_pandas"></span><section id="introduction-to-pandas">
<h4>Introduction to Pandas<a class="headerlink" href="#introduction-to-pandas" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Explain the relationship between Pandas and NumPy, highlighting when to use each library effectively.</p></li>
<li><p>Define and differentiate between Series and DataFrame data structures in Pandas.</p></li>
<li><p>Demonstrate the creation of Pandas objects from NumPy arrays, solidifying foundational knowledge.</p></li>
</ul>
</div>
<div class="admonition-time exercise important admonition" id="exercise-0">
<p class="admonition-title">Time</p>
<p>15 Minutes</p>
</div>
<section id="what-is-pandas">
<h5>What is Pandas?<a class="headerlink" href="#what-is-pandas" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>A powerful Python library for data manipulation and analysis</p></li>
<li><p>Built on top of NumPy (which you’re already familiar with)</p></li>
<li><p>Essential tool in data science, machine learning, and analytics</p></li>
<li><p>Name comes from “panel data” - economic term for multidimensional data</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>“Pandas is to data analysis what NumPy is to numerical computing.”</p></li>
<li><p>“If you’ve ever used Excel or SQL, Pandas will feel somewhat familiar.”</p></li>
<li><p>“Today we’ll see how the NumPy skills you’ve learned provide the foundation for Pandas.”</p></li>
</ul>
</div>
<section id="pandas-vs-numpy-relationship">
<h6>Pandas vs NumPy Relationship<a class="headerlink" href="#pandas-vs-numpy-relationship" title="Link to this heading"></a></h6>
<p><strong>Key Differences:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>NumPy</p></th>
<th class="head"><p>Pandas</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Homogeneous arrays</p></td>
<td><p>Heterogeneous data</p></td>
</tr>
<tr class="row-odd"><td><p>Numerical focus</p></td>
<td><p>Tabular data focus</p></td>
</tr>
<tr class="row-even"><td><p>Unlabeled axes</p></td>
<td><p>Labeled axes</p></td>
</tr>
<tr class="row-odd"><td><p>Fast mathematical operations</p></td>
<td><p>Data manipulation operations</p></td>
</tr>
<tr class="row-even"><td><p>Memory efficient</p></td>
<td><p>Feature rich</p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># NumPy array - homogeneous data type</span>
<span class="n">numpy_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy array: </span><span class="si">{</span><span class="n">numpy_array</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy data type: </span><span class="si">{</span><span class="n">numpy_array</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Try to put mixed types in NumPy - notice what happens</span>
<span class="n">mixed_numpy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mixed NumPy array: </span><span class="si">{</span><span class="n">mixed_numpy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mixed array dtype: </span><span class="si">{</span><span class="n">mixed_numpy</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Converts to common type</span>

<span class="c1"># Pandas Series - can handle mixed types</span>
<span class="n">pandas_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pandas Series with mixed types:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pandas_series</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NumPy array: [1 2 3 4 5]
NumPy data type: int64
Mixed NumPy array: [&#39;1&#39; &#39;string&#39; &#39;3.14&#39;]
Mixed array dtype: &lt;U32 # Unicode string with a maximum length of 32 characters

Pandas Series with mixed types:
0         1
1    string
2      3.14
dtype: object

</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mixed_numpy</span><span class="p">])</span>
<span class="nb">print</span><span class="p">([</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pandas_series</span><span class="p">])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;class &#39;numpy.str_&#39;&gt;, &lt;class &#39;numpy.str_&#39;&gt;, &lt;class &#39;numpy.str_&#39;&gt;]
[&lt;class &#39;int&#39;&gt;, &lt;class &#39;str&#39;&gt;, &lt;class &#39;float&#39;&gt;]
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Notice how NumPy converts everything to strings when faced with mixed types</p></li>
<li><p>Pandas, on the other hand, preserves the original types using an ‘object’ dtype.</p></li>
<li><p>This flexibility is crucial when working with real-world data that rarely comes in neat, homogeneous packages</p></li>
</ul>
<p>NumPy converts everything to strings or objects, losing the original type functionality, while Pandas preserves the original types and their behaviors.</p>
</div>
</section>
</section>
<section id="dataframe-data-structures">
<h5>DataFrame Data Structures<a class="headerlink" href="#dataframe-data-structures" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Pandas introduces two new data structures</p>
<ul>
<li><p>Series: A labeled one-dimensional array</p></li>
<li><p>DataFrames: Labeled Tables for Powerful Data Analysis</p></li>
</ul>
</li>
</ul>
</section>
<section id="pandas-series">
<h5>Pandas Series<a class="headerlink" href="#pandas-series" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>1D labeled array capable of holding any data type</p></li>
<li><p>Like a cross between a list and a dictionary</p></li>
<li><p>Has an Index (labels) and values (data)</p></li>
<li><p>Built on NumPy, so supports vectorized operations</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a Series</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas Series with custom index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The index: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The values: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Notice this returns a NumPy array</span>

<span class="c1"># Dictionary-like access</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Value at index &#39;b&#39;: </span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values at indices &#39;a&#39; and &#39;c&#39;: </span><span class="si">{</span><span class="n">s</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># NumPy-like operations</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Adding 5 to all values: </span><span class="se">\n</span><span class="si">{</span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values greater than 25: </span><span class="se">\n</span><span class="si">{</span><span class="n">s</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">25</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pandas Series with custom index:
a    10
b    20
c    30
d    40
dtype: int64
The index: Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], dtype=&#39;object&#39;)
The values: [10 20 30 40]

Value at index &#39;b&#39;: 20
Values at indices &#39;a&#39; and &#39;c&#39;: a    10
c    30
dtype: int64

Adding 5 to all values:
a    15
b    25
c    35
d    45
dtype: int64
Values greater than 25:
a    False
b    False
c     True
d     True
dtype: bool
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<p><strong>Why ues labels and not numerical indexing?</strong></p>
<ul class="simple">
<li><p>Labels provide context and meaning to your data (similar to Python Dictionaries)</p></li>
<li><p>Flexibility in reshaping and manipulating:</p>
<ul>
<li><p>Numerical indexing assumes a fixed order</p></li>
<li><p>With labels, you can add, remove, or reorder elements without affecting the data retrieval process</p></li>
</ul>
</li>
<li><p>Handling Missing Data:</p>
<ul>
<li><p>Numerical indexing can become problematic with missing entries in data. However, Labels let you explicitly handle missing entries using designated labels (e.g., NaN)</p></li>
</ul>
</li>
<li><p>Intrinsic Data alignment with labels:</p>
<ul>
<li><p>When performing operations between two Series, pandas aligns data based on the label of the indices, not the integer location</p></li>
<li><p>This makes operations across data structures with potentially differently ordered labels possible and coherent</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="the-pandas-dataframe">
<h5>The Pandas DataFrame<a class="headerlink" href="#the-pandas-dataframe" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>2D labeled data structure with columns of potentially different types</p></li>
<li><p>Think: spreadsheet or SQL table</p></li>
<li><p>Collection of Series objects that share the same index</p></li>
<li><p>Primary data structure you’ll use in data analysis</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a DataFrame</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># DataFrame info</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame columns: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DataFrame index: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Accessing a column (returns a Series)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Accessing the Age column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type of column: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pandas DataFrame:
      Name  Age      City
0    Alice   25  New York
1      Bob   30    Boston
2  Charlie   35   Chicago

DataFrame shape: (3, 3)
DataFrame columns: Index([&#39;Name&#39;, &#39;Age&#39;, &#39;City&#39;], dtype=&#39;object&#39;)
DataFrame index: RangeIndex(start=0, stop=3, step=1)

Accessing the Age column:
0    25
1    30
2    35
Name: Age, dtype: int64
Type of column: &lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-3">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>A Series is the building block in Pandas - think of it as a single column of data</p></li>
<li><p>A DataFrame is a collection of Series objects sharing an index - like a table made up of columns</p></li>
<li><p>The real power comes from being able to manipulate, filter, and analyze these structures easily</p></li>
</ul>
<p>DataFrame is made up of Series objects, and that both have labeled axes that make data access intuitive.</p>
</div>
</section>
<section id="creating-pandas-objects-from-numpy-arrays">
<h5>Creating Pandas Objects from NumPy Arrays<a class="headerlink" href="#creating-pandas-objects-from-numpy-arrays" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Pandas objects can be created directly from NumPy arrays</p></li>
<li><p>Indexes can be automatically generated or custom-defined</p></li>
<li><p>The underlying NumPy array is still accessible</p></li>
<li><p>Pandas adds powerful indexing and data manipulation features</p></li>
</ul>
<section id="numpy-array-to-pandas-series">
<h6>Numpy array to Pandas series<a class="headerlink" href="#numpy-array-to-pandas-series" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NumPy array to Pandas Series</span>
<span class="n">numpy_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">numpy_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Series with default index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">numpy_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Series with custom index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Series with default index:
0    100
1    200
2    300
3    400
dtype: int64

Series with custom index:
w    100
x    200
y    300
z    400
dtype: int64

</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Pandas Series (s2):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Index of the Pandas Series (s2.index):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Convert the Pandas Series to a NumPy array</span>
<span class="n">numpy_array_from_s2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NumPy Array created from s2 (s2.to_numpy()):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numpy_array_from_s2</span><span class="p">)</span>

<span class="c1"># There&#39;s no explicit index in the NumPy array, it&#39;s implicitly 0, 1, 2, ...</span>
<span class="c1"># You can demonstrate accessing elements using numerical indices in the NumPy array</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Accessing elements in the NumPy array (numerical indexing):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy_array_from_s2[0]: </span><span class="si">{</span><span class="n">numpy_array_from_s2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;numpy_array_from_s2[2]: </span><span class="si">{</span><span class="n">numpy_array_from_s2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original Pandas Series (s2):
w    100
x    200
y    300
z    400
dtype: int64

Index of the Pandas Series (s2.index):
Index([&#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;], dtype=&#39;object&#39;)

NumPy Array created from s2 (s2.to_numpy()):
[100 200 300 400]

Accessing elements in the NumPy array (numerical indexing):
numpy_array_from_s2[0]: 100
numpy_array_from_s2[2]: 300
</pre></div>
</div>
</div>
</section>
<section id="numpy-2d-array-to-pandas-dataframe">
<h6>Numpy 2D array to Pandas dataframe<a class="headerlink" href="#numpy-2d-array-to-pandas-dataframe" title="Link to this heading"></a></h6>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NumPy 2D array to DataFrame</span>
<span class="n">array_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array_2d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame from 2D array (default column names):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array_2d</span><span class="p">,</span> 
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;row1&#39;</span><span class="p">,</span> <span class="s1">&#39;row2&#39;</span><span class="p">,</span> <span class="s1">&#39;row3&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame with custom row and column labels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Converting back to NumPy</span>
<span class="n">numpy_again</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Converted back to NumPy:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">numpy_again</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DataFrame from 2D array (default column names):
   0  1  2
0  1  2  3
1  4  5  6
2  7  8  9

DataFrame with custom row and column labels:
      A  B  C
row1  1  2  3
row2  4  5  6
row3  7  8  9

Converted back to NumPy:
[[1 2 3]
 [4 5 6]
 [7 8 9]]

</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-4">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Your existing NumPy knowledge transfers directly to Pandas</p></li>
<li><p>The key difference is the addition of labels, which makes data more self-describing</p></li>
<li><p>Notice how Pandas automatically names axes when none are provided, but lets you customize when needed</p></li>
<li><p>You can always convert back to NumPy when you need pure numerical performance</p>
<ul>
<li><p>When you convert a Pandas Series to a NumPy array using .to_numpy(), you are essentially extracting the data values</p></li>
<li><p>The labeled index, which is a key feature of Pandas Series, is not part of the underlying NumPy array structure</p></li>
<li><p>The resulting NumPy array reverts to its default numerical indexing.</p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p>Imagine the random_array represents quarterly sales data for three different products. Explain how the provided code transforms this raw numerical data into a more informative and manageable structure using Pandas, allowing for labeled access and calculations.</p>
<p>Have students execute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 3x4 NumPy array of random integers</span>
<span class="n">random_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original NumPy array:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_array</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to DataFrame with custom labels</span>
<span class="n">quarters_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">random_array</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q3&#39;</span><span class="p">,</span> <span class="s1">&#39;Q4&#39;</span><span class="p">],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Product A&#39;</span><span class="p">,</span> <span class="s1">&#39;Product B&#39;</span><span class="p">,</span> <span class="s1">&#39;Product C&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">As Pandas DataFrame with labels:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quarters_df</span><span class="p">)</span>

<span class="c1"># Extract Q2 column as a Series</span>
<span class="n">q2_series</span> <span class="o">=</span> <span class="n">quarters_df</span><span class="p">[</span><span class="s1">&#39;Q2&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Q2 column as a Series:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q2_series</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Series type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">q2_series</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Building on NumPy:</strong> Pandas uses NumPy under the hood, adding labels and mixed-type support</p></li>
<li><p><strong>Series:</strong> 1D labeled array similar to a dictionary + array hybrid</p></li>
<li><p><strong>DataFrame:</strong> 2D labeled structure, like a collection of Series sharing an index</p></li>
<li><p><strong>Labels Matter:</strong> Named axes make your data self-documenting and easier to work with</p></li>
<li><p><strong>Data Types:</strong> Pandas handles mixed types better than NumPy, crucial for real-world data</p></li>
</ol>
</div>
</section>
<section id="homework">
<h5>Homework<a class="headerlink" href="#homework" title="Link to this heading"></a></h5>
<div class="admonition-homework homework important admonition" id="homework-0">
<p class="admonition-title">Homework</p>
<p><strong>Creating pandas DataFrames from list of dictionaries:</strong></p>
<ul class="simple">
<li><p>Each dictionary represents a row and its keys are the column names</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
     <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="mi">85</span><span class="p">},</span>
     <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">},</span>
     <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">}</span>
 <span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>      Name  Age  Score
0    Alice   25     85
1      Bob   30     70
2  Charlie   22     90
</pre></div>
</div>
<p><strong>Creating pandas DataFrames from dictionaries of lists:</strong></p>
<ul class="simple">
<li><p>The dictionary keys are the column names, and the values are lists containing the corresponding data for each row</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">],</span>
     <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
     <span class="s1">&#39;Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
 <span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>      Name  Age  Score
0    Alice   25     85
1      Bob   30     70
2  Charlie   22     90
</pre></div>
</div>
</div>
</section>
</section>
<span id="document-9.Pandas_data_import_export"></span><section id="data-import-and-export-in-pandas">
<h4>Data Import and Export in Pandas<a class="headerlink" href="#data-import-and-export-in-pandas" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Illustrate how to read data from various formats, including CSV, Excel, and JSON, into Pandas.</p></li>
<li><p>Show how to export DataFrames to different formats, ensuring participants can save their analyses.</p></li>
<li><p>Utilize data inspection methods (head, info, describe) to gain an understanding of data structure and content.</p></li>
</ul>
</div>
<div class="admonition-time exercise important admonition" id="exercise-0">
<p class="admonition-title">Time</p>
<p>15 Minutes</p>
</div>
<section id="introduction-to-data-import-and-export">
<h5>Introduction to Data Import and Export<a class="headerlink" href="#introduction-to-data-import-and-export" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Real-world data analysis starts with getting data into Pandas</p></li>
<li><p>Pandas supports many file formats natively</p></li>
<li><p>The process: Import → Inspect → Manipulate → Export</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>“Now that we understand Pandas data structures, let’s learn how to fill them with real data.”</p></li>
<li><p>“This is where Pandas really starts to shine compared to NumPy - it handles diverse data sources seamlessly.”</p></li>
<li><p>“The workflow we’re learning today is the foundation of data analysis in Python.”</p></li>
</ul>
</div>
</section>
<section id="reading-data-from-various-formats">
<h5>Reading Data from Various Formats<a class="headerlink" href="#reading-data-from-various-formats" title="Link to this heading"></a></h5>
<section id="reading-data-main-methods">
<h6>Reading Data - Main Methods<a class="headerlink" href="#reading-data-main-methods" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Common Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code></p></td>
<td><p>Read CSV files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filepath_or_buffer</span></code>, <code class="docutils literal notranslate"><span class="pre">sep</span></code>, <code class="docutils literal notranslate"><span class="pre">header</span></code>, <code class="docutils literal notranslate"><span class="pre">index_col</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_excel()</span></code></p></td>
<td><p>Read Excel files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">io</span></code>, <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code>, <code class="docutils literal notranslate"><span class="pre">header</span></code>, <code class="docutils literal notranslate"><span class="pre">index_col</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_json()</span></code></p></td>
<td><p>Read JSON files</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">path_or_buf</span></code>, <code class="docutils literal notranslate"><span class="pre">orient</span></code>, <code class="docutils literal notranslate"><span class="pre">typ</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_sql()</span></code></p></td>
<td><p>Read SQL query/table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sql</span></code>, <code class="docutils literal notranslate"><span class="pre">con</span></code>, <code class="docutils literal notranslate"><span class="pre">index_col</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pd.read_html()</span></code></p></td>
<td><p>Read HTML tables</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">io</span></code>, <code class="docutils literal notranslate"><span class="pre">match</span></code>, <code class="docutils literal notranslate"><span class="pre">flavor</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="reading-csv-data">
<h6>Reading CSV Data<a class="headerlink" href="#reading-csv-data" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Basic CSV reading</span>
<span class="n">df_csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Basic CSV import:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_csv</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># Show first 3 rows</span>

<span class="c1"># Customizing CSV import</span>
<span class="n">df_csv_custom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.csv&#39;</span><span class="p">,</span>
                           <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>            <span class="c1"># Delimiter (comma is default)</span>
                           <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>           <span class="c1"># Row to use as column names (0 is default)</span>
                           <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span>     <span class="c1"># Column to set as index</span>
                           <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">],</span>  <span class="c1"># Only import specific columns</span>
                           <span class="n">nrows</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>            <span class="c1"># Only read first 5 rows</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Customized CSV import:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_csv_custom</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Basic CSV import:
   ID      Name  Age     City  Value Category        Date
0   1  Person_1   22  Chicago  34.61        B  2023-01-01
1   2  Person_2   52  Phoenix  47.46        A  2023-01-02
2   3  Person_3   38  Phoenix  48.85        D  2023-01-03
3   4  Person_4   27  Houston  75.10        A  2023-01-04
4   5  Person_5   34  Houston  47.88        B  2023-01-05

Customized CSV import:
        Name  Value
ID
1   Person_1  34.61
2   Person_2  47.46
3   Person_3  48.85
4   Person_4  75.10
5   Person_5  47.88
</pre></div>
</div>
</div>
</section>
<section id="reading-excel-data">
<h6>Reading Excel Data<a class="headerlink" href="#reading-excel-data" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic Excel reading</span>
<span class="n">df_excel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.xlsx&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Basic Excel import:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_excel</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Reading specific sheet</span>
<span class="n">df_excel_sheet2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.xlsx&#39;</span><span class="p">,</span> 
                               <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet 1 - sample_data&#39;</span><span class="p">,</span>
                               <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>     <span class="c1"># Skip first row</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reading specific Excel sheet:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_excel_sheet2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># List all sheets in workbook</span>
<span class="n">xl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.xlsx&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">All sheets in workbook: </span><span class="si">{</span><span class="n">xl</span><span class="o">.</span><span class="n">sheet_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Basic Excel import:
  sample_data Unnamed: 1 Unnamed: 2 Unnamed: 3 Unnamed: 4 Unnamed: 5  Unnamed: 6
0          ID       Name        Age       City      Value   Category        Date
1           1   Person_1         22    Chicago      34.61          B  2023-01-01
2           2   Person_2         52    Phoenix      47.46          A  2023-01-02
3           3   Person_3         38    Phoenix      48.85          D  2023-01-03
4           4   Person_4         27    Houston       75.1          A  2023-01-04

Reading specific Excel sheet:
   ID      Name  Age     City  Value Category        Date
0   1  Person_1   22  Chicago  34.61        B  2023-01-01
1   2  Person_2   52  Phoenix  47.46        A  2023-01-02
2   3  Person_3   38  Phoenix  48.85        D  2023-01-03
3   4  Person_4   27  Houston  75.10        A  2023-01-04
4   5  Person_5   34  Houston  47.88        B  2023-01-05

All sheets in workbook: [&#39;Sheet 1 - sample_data&#39;]
</pre></div>
</div>
</div>
</section>
<section id="reading-json-data">
<h6>Reading JSON Data<a class="headerlink" href="#reading-json-data" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading JSON</span>
<span class="n">df_json</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;test_data/sample_data.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JSON import:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_json</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>JSON import:
      Name Department  Salary   Hire_Date
0     Alex      Sales   55000  2020-01-15
1     Beth         HR   60000  2019-07-10
2  Charlie       Tech   75000  2021-03-22
3    Diana    Finance   70000  2018-11-05
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>“Notice that all these different file formats are loaded into the same DataFrame structure.”</p></li>
<li><p>“Each import function has many parameters for fine-tuning the import process.”</p></li>
<li><p>“The defaults work well in many cases, but customization gives you control over exactly what data gets loaded and how.”</p></li>
<li><p>“For real-world data, you’ll often need to use these parameters to handle messy or improperly formatted files.”</p></li>
</ul>
</div>
</section>
</section>
<section id="writing-data-to-files">
<h5>Writing Data to Files<a class="headerlink" href="#writing-data-to-files" title="Link to this heading"></a></h5>
<section id="writing-data-main-methods">
<h6>Writing Data - Main Methods<a class="headerlink" href="#writing-data-main-methods" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Common Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">to_csv()</span></code></p></td>
<td><p>Write to CSV</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">path_or_buf</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">header</span></code>, <code class="docutils literal notranslate"><span class="pre">sep</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">to_excel()</span></code></p></td>
<td><p>Write to Excel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">excel_writer</span></code>, <code class="docutils literal notranslate"><span class="pre">sheet_name</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">header</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">to_json()</span></code></p></td>
<td><p>Write to JSON</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">path_or_buf</span></code>, <code class="docutils literal notranslate"><span class="pre">orient</span></code>, <code class="docutils literal notranslate"><span class="pre">lines</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">to_sql()</span></code></p></td>
<td><p>Write to SQL table</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">con</span></code>, <code class="docutils literal notranslate"><span class="pre">if_exists</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">to_html()</span></code></p></td>
<td><p>Write to HTML</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">buf</span></code>, <code class="docutils literal notranslate"><span class="pre">columns</span></code>, <code class="docutils literal notranslate"><span class="pre">header</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="writing-to-different-formats">
<h6>Writing to Different Formats**<a class="headerlink" href="#writing-to-different-formats" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a small DataFrame to export</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alex&#39;</span><span class="p">,</span> <span class="s1">&#39;Beth&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;Diana&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">55000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">75000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Hire_Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2020-01-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-07-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-03-22&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-11-05&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame to export:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Export to CSV</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;employees.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exported to CSV (employees.csv)&quot;</span><span class="p">)</span>

<span class="c1"># Export to Excel</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;employees.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Employees&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported to Excel (employees.xlsx)&quot;</span><span class="p">)</span>

<span class="c1"># Export to JSON (with different orientations)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;employees_records.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported to JSON (employees_records.json) in records format&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;employees_split.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;split&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported to JSON (employees_split.json) in split format&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Writing data is even simpler than reading it, since Pandas already knows the structure.</p></li>
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">index=False</span></code> is common when exporting, to avoid having an extra column.</p></li>
<li><p>Different export formats are useful in different contexts:</p>
<ul>
<li><p>CSV is universal but loses data types</p></li>
<li><p>Excel preserves formatting but requires Excel to open</p></li>
<li><p>JSON is great for web applications and APIs</p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p><strong>Writing Data:</strong></p>
<p>Use <code class="docutils literal notranslate"><span class="pre">grades_df</span></code> dataframe and export to</p>
<ol class="arabic simple">
<li><p>CSV without the index, but including headers</p></li>
<li><p>JSON in format</p></li>
<li><p>Verify by reading the files back</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataframe of student grades</span>
<span class="n">grades_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Student&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alex&#39;</span><span class="p">,</span> <span class="s1">&#39;Barbara&#39;</span><span class="p">,</span> <span class="s1">&#39;Carlos&#39;</span><span class="p">,</span> <span class="s1">&#39;Diana&#39;</span><span class="p">,</span> <span class="s1">&#39;Evan&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="s1">&#39;Science&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="s1">&#39;History&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">79</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">91</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">grades_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">grades_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Task 1: Export to CSV without the index, but including headers</span>
<span class="n">grades_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;student_grades.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Task 2: Export to JSON in &#39;records&#39; format</span>
<span class="n">grades_df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;student_grades.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>

<span class="c1"># Verify by reading the files back</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CSV file contents:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;student_grades.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">JSON file contents:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;student_grades.json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-inspection-methods">
<h5>Data Inspection Methods<a class="headerlink" href="#data-inspection-methods" title="Link to this heading"></a></h5>
<section id="key-inspection-methods">
<h6>Key Inspection Methods<a class="headerlink" href="#key-inspection-methods" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>What It Shows</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">head()</span></code> / <code class="docutils literal notranslate"><span class="pre">tail()</span></code></p></td>
<td><p>View first/last n rows</p></td>
<td><p>A preview of the data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">info()</span></code></p></td>
<td><p>Summary of DataFrame</p></td>
<td><p>Data types, non-null counts, memory usage</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">describe()</span></code></p></td>
<td><p>Statistical summary</p></td>
<td><p>Count, mean, std, min, 25%, 50%, 75%, max</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dtypes</span></code></p></td>
<td><p>Column data types</p></td>
<td><p>Data type of each column</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>Dimensions</p></td>
<td><p>(rows, columns)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">columns</span></code></p></td>
<td><p>Column names</p></td>
<td><p>Index of column names</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">value_counts()</span></code></p></td>
<td><p>Count unique values</p></td>
<td><p>Frequency of each unique value</p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<p><strong>Inspection Methods</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s inspect a more interesting dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a sample dataset with different data types</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Count&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Flag&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Add some missing values</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">500</span><span class="p">:</span><span class="mi">510</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Now let&#39;s inspect</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 5 rows with head():&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Last 3 rows with tail(3):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame information with info():&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistical summary with describe():&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Include all columns in describe (even non-numeric):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data types of each column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Shape (rows, columns):&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Value counts for &#39;Category&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>First 5 rows with head():
  Category       Value  Count       Date   Flag
0        C  106.835120     72 2023-01-01  False
1        D  137.523417     49 2023-01-02  False
2        A  119.008477     79 2023-01-03   True
3        C   88.461927     17 2023-01-04   True
4        C   82.031707     60 2023-01-05  False

Last 3 rows with tail(3):
    Category       Value  Count       Date   Flag
997        D   87.885702     77 2025-09-24   True
998        D  114.841907     59 2025-09-25  False
999        C  105.985852     47 2025-09-26  False

DataFrame information with info():
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 5 columns):
 #   Column    Non-Null Count  Dtype
---  ------    --------------  -----
 0   Category  989 non-null    object
 1   Value     989 non-null    float64
 2   Count     1000 non-null   int64
 3   Date      1000 non-null   datetime64[ns]
 4   Flag      1000 non-null   bool
dtypes: bool(1), datetime64[ns](1), float64(1), int64(1), object(1)
memory usage: 32.4+ KB

Statistical summary with describe():
            Value        Count                 Date
count  989.000000  1000.000000                 1000
mean   100.858217    49.007000  2024-05-14 12:00:00
min     42.074892     1.000000  2023-01-01 00:00:00
25%     87.503628    24.000000  2023-09-07 18:00:00
50%    100.811834    48.000000  2024-05-14 12:00:00
75%    113.637830    73.000000  2025-01-19 06:00:00
max    161.577616    99.000000  2025-09-26 00:00:00
std     20.024572    28.269703                  NaN

Include all columns in describe (even non-numeric):
       Category       Value        Count                 Date  Flag
count       989  989.000000  1000.000000                 1000  1000
unique        4         NaN          NaN                  NaN     2
top           D         NaN          NaN                  NaN  True
freq        277         NaN          NaN                  NaN   512
mean        NaN  100.858217    49.007000  2024-05-14 12:00:00   NaN
min         NaN   42.074892     1.000000  2023-01-01 00:00:00   NaN
25%         NaN   87.503628    24.000000  2023-09-07 18:00:00   NaN
50%         NaN  100.811834    48.000000  2024-05-14 12:00:00   NaN
75%         NaN  113.637830    73.000000  2025-01-19 06:00:00   NaN
max         NaN  161.577616    99.000000  2025-09-26 00:00:00   NaN
std         NaN   20.024572    28.269703                  NaN   NaN

Data types of each column:
Category            object
Value              float64
Count                int64
Date        datetime64[ns]
Flag                  bool
dtype: object

Shape (rows, columns): (1000, 5)

Value counts for &#39;Category&#39;:
Category
D    277
A    254
C    229
B    229
Name: count, dtype: int64
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-3">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>“These inspection methods are critical to understanding your data before analysis.”</p></li>
<li><p>“Always start data exploration with these methods - they quickly reveal dataset characteristics and potential issues.”</p></li>
<li><p>“<code class="docutils literal notranslate"><span class="pre">info()</span></code> shows missing values and data types - crucial for cleaning strategies.”</p></li>
<li><p>“<code class="docutils literal notranslate"><span class="pre">describe()</span></code> gives statistical summaries - great for spotting outliers or distribution patterns.”</p></li>
<li><p>“Real data is messy - these tools help you understand what needs to be cleaned.”</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise</p>
<p><strong>Data Inspection:</strong>
Perform a comprehensive inspection using <code class="docutils literal notranslate"><span class="pre">products_df</span></code> and answer these questions</p>
<ol class="arabic simple">
<li><p>How many rows and columns are in this dataset?</p></li>
<li><p>What data type is the ‘Rating’ column?</p></li>
<li><p>How many null values are in the dataset?</p></li>
<li><p>What’s the average price?</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataframe with some intentional quirks</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Product&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet&#39;</span><span class="p">,</span> <span class="s1">&#39;Monitor&#39;</span><span class="p">,</span> <span class="s1">&#39;Keyboard&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">75</span><span class="p">],</span>
    <span class="s1">&#39;Stock&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="s1">&#39;Rating&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>  <span class="c1"># Note the None value</span>
    <span class="s1">&#39;OnSale&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">products_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect the data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="n">products_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">products_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistical summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">products_df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Including all columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">products_df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>

<span class="c1"># Answers:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Answers:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. </span><span class="si">{</span><span class="n">products_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows and </span><span class="si">{</span><span class="n">products_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. The &#39;Rating&#39; column has dtype: </span><span class="si">{</span><span class="n">products_df</span><span class="p">[</span><span class="s1">&#39;Rating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3. Total null values: </span><span class="si">{</span><span class="n">products_df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4. Average price: $</span><span class="si">{</span><span class="n">products_df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Data Import Flexibility:</strong> Pandas can read data from virtually any structured data format</p></li>
<li><p><strong>Customized Reading:</strong> Parameters let you control exactly how data is imported</p></li>
<li><p><strong>Easy Export:</strong> Writing data is straightforward with similar syntax across formats</p></li>
<li><p><strong>Always Inspect First:</strong> <code class="docutils literal notranslate"><span class="pre">head()</span></code>, <code class="docutils literal notranslate"><span class="pre">info()</span></code>, and <code class="docutils literal notranslate"><span class="pre">describe()</span></code> should be your first steps with any new dataset</p></li>
<li><p><strong>Real-World Ready:</strong> These tools prepare you for working with messy, real-world data</p></li>
</ol>
</div>
</section>
</section>
<span id="document-10.DataFrame_Manipulation"></span><section id="dataframe-manipulation-sorting">
<h4>DataFrame Manipulation &amp; Sorting<a class="headerlink" href="#dataframe-manipulation-sorting" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Demonstrate effective techniques for selecting specific rows and from DataFrames.</p></li>
<li><p>Equip participants with skills to add and remove columns within a DataFrame.</p></li>
<li><p>Implement sorting methods by values, by index, and perform multiple column sorting with custom orders.</p></li>
</ul>
</div>
<div class="admonition-time exercise important admonition" id="exercise-0">
<p class="admonition-title">Time</p>
<p>20 minutes</p>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Now that we can import data, we need to reshape and manipulate it for analysis</p></li>
<li><p>In real-world data analysis, you’ll spend about 80% of your time cleaning and manipulating data, and only 20% on actual analysis</p></li>
<li><p>The skills we’re covering in this session form the backbone of data wrangling in Python</p></li>
<li><p>Think of these operations as transforming raw data into analysis-ready information</p></li>
</ul>
</div>
<section id="column-and-row-selection">
<h5>Column and Row Selection<a class="headerlink" href="#column-and-row-selection" title="Link to this heading"></a></h5>
<p><strong>Different Ways to Select Data:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Selection Type</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Example Syntax</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Single column</p></td>
<td><p>Get one variable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df['column_name']</span></code> or <code class="docutils literal notranslate"><span class="pre">df.column_name</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Multiple columns</p></td>
<td><p>Get specific variables</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df[['col1',</span> <span class="pre">'col2']]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Row by index</p></td>
<td><p>Get specific observation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.loc['index_label']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Row by position</p></td>
<td><p>Get nth observation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.iloc[n]</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Row and column</p></td>
<td><p>Get specific value(s)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.loc['index',</span> <span class="pre">'column']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Slicing</p></td>
<td><p>Get ranges of data</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.loc['idx1':'idx2',</span> <span class="pre">'col1':'col2']</span></code></p></td>
</tr>
</tbody>
</table>
<section id="basic-selection">
<h6>Basic Selection<a class="headerlink" href="#basic-selection" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a sample dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="s1">&#39;Miami&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">92000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;emp004&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">]</span>  <span class="c1"># Custom index</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Single column selection - two methods</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Single column as Series:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span>  <span class="c1"># Returns a Series</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Alternative syntax for columns without spaces:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Age</span><span class="p">)</span>  <span class="c1"># Also returns a Series, but only works if column name has no spaces</span>

<span class="c1"># Multiple column selection</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Selecting multiple columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">]])</span>  <span class="c1"># Returns a DataFrame</span>

<span class="c1"># Row selection by index label using .loc</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Selecting row by index label:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp003&#39;</span><span class="p">])</span>  <span class="c1"># Returns a Series representing the row</span>

<span class="c1"># Row selection by position using .iloc</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Selecting row by position (third row):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Also returns a Series</span>

<span class="c1"># Selecting a subset of rows</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">6. Selecting multiple rows by position:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># Rows 1, 2, and 3 (not including 4)</span>

<span class="c1"># Selecting specific cells</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. Selecting specific value (cell):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">])</span>  <span class="c1"># Returns the value (72000)</span>

<span class="c1"># Selecting a subset of rows and columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">8. Selecting subset of rows and columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">:</span><span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">]])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance

1. Single column as Series:
emp001    24
emp002    30
emp003    35
emp004    42
emp005    28
Name: Age, dtype: int64

2. Alternative syntax for columns without spaces:
emp001    24
emp002    30
emp003    35
emp004    42
emp005    28
Name: Age, dtype: int64

3. Selecting multiple columns:
           Name  Salary
emp001    Alice   65000
emp002      Bob   72000
emp003  Charlie   85000
emp004    David   92000
emp005      Eva   70000

4. Selecting row by index label:
Name          Charlie
Age                35
City          Chicago
Salary          85000
Department       Tech
Name: emp003, dtype: object

5. Selecting row by position (third row):
Name          Charlie
Age                35
City          Chicago
Salary          85000
Department       Tech
Name: emp003, dtype: object

6. Selecting multiple rows by position:
           Name  Age     City  Salary Department
emp002      Bob   30   Boston   72000      Sales
emp003  Charlie   35  Chicago   85000       Tech
emp004    David   42  Seattle   92000       Tech

7. Selecting specific value (cell):
72000

8. Selecting subset of rows and columns:
           Name  Age  Salary
emp001    Alice   24   65000
emp002      Bob   30   72000
emp003  Charlie   35   85000
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Notice that selecting a single column returns a Series, while selecting multiple columns maintains the DataFrame structure</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.loc</span></code> accessor is used for label-based indexing, while <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> is for position-based indexing</p></li>
</ul>
</div>
</section>
<section id="advanced-selection-with-conditions">
<h6>Advanced Selection with Conditions<a class="headerlink" href="#advanced-selection-with-conditions" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boolean selection - rows where Age &gt; 30</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">9. Boolean selection - employees over 30:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">])</span>

<span class="c1"># Multiple conditions using &amp; (and) and | (or)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">10. Multiple conditions - Tech department with salary &gt; 80000:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Department&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Tech&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80000</span><span class="p">)])</span>

<span class="c1"># Using .query() method for cleaner syntax</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">11. Using query method - same condition:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Department == &#39;Tech&#39; and Salary &gt; 80000&quot;</span><span class="p">))</span>

<span class="c1"># Row selection with .isin()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">12. Using .isin() - employees in HR or Finance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Department&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">])])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9. Boolean selection - employees over 30:
           Name  Age     City  Salary Department
emp003  Charlie   35  Chicago   85000       Tech
emp004    David   42  Seattle   92000       Tech

10. Multiple conditions - Tech department with salary &gt; 80000:
           Name  Age     City  Salary Department
emp003  Charlie   35  Chicago   85000       Tech
emp004    David   42  Seattle   92000       Tech

11. Using query method - same condition:
           Name  Age     City  Salary Department
emp003  Charlie   35  Chicago   85000       Tech
emp004    David   42  Seattle   92000       Tech

12. Using .isin() - employees in HR or Finance:
         Name  Age      City  Salary Department
emp001  Alice   24  New York   65000         HR
emp005    Eva   28     Miami   70000    Finance
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Boolean selection is incredibly powerful - it lets you filter data based on specific conditions</p></li>
<li><p>These selection methods can be combined in powerful ways to extract exactly the data you need</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p><strong>Selection Practice:</strong></p>
<p>Use <code class="docutils literal notranslate"><span class="pre">inventory</span></code> dataframe and</p>
<ul class="simple">
<li><p>Select just the Product_Name and Price columns</p></li>
<li><p>Select all products that are in stock (In_Stock is True)</p></li>
<li><p>Select all electronics that cost less than 500</p></li>
<li><p>Select the 2nd and 3rd products using position-based indexing</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataset of product inventory</span>
<span class="n">products</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Product_ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P001&#39;</span><span class="p">,</span> <span class="s1">&#39;P002&#39;</span><span class="p">,</span> <span class="s1">&#39;P003&#39;</span><span class="p">,</span> <span class="s1">&#39;P004&#39;</span><span class="p">,</span> <span class="s1">&#39;P005&#39;</span><span class="p">,</span> <span class="s1">&#39;P006&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Product_Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;Smartphone&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet&#39;</span><span class="p">,</span> <span class="s1">&#39;Monitor&#39;</span><span class="p">,</span> <span class="s1">&#39;Keyboard&#39;</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">,</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
    <span class="s1">&#39;In_Stock&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s1">&#39;Units&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">inventory</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tasks:</span>
<span class="c1"># 1. Select just the Product_Name and Price columns</span>
<span class="n">names_prices</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">[[</span><span class="s1">&#39;Product_Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Price&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Product names and prices:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">names_prices</span><span class="p">)</span>

<span class="c1"># 2. Select all products that are in stock (In_Stock is True)</span>
<span class="n">in_stock</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">[</span><span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;In_Stock&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Products in stock:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">in_stock</span><span class="p">)</span>

<span class="c1"># 3. Select all electronics that cost less than 500</span>
<span class="n">cheap_electronics</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">[(</span><span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Electronics&#39;</span><span class="p">)</span> <span class="o">&amp;</span> 
                              <span class="p">(</span><span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Affordable electronics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cheap_electronics</span><span class="p">)</span>

<span class="c1"># 4. Select the 2nd and 3rd products using position-based indexing</span>
<span class="n">second_third</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Second and third products:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">second_third</span><span class="p">)</span>
</pre></div>
</div>
<p>Understand the different ways to select data from a DataFrame, including column selection, row selection by label and position, boolean filtering, and combinations of these methods</p>
</div>
</section>
</section>
<section id="adding-and-removing-columns-rows">
<h5>Adding and Removing Columns/Rows<a class="headerlink" href="#adding-and-removing-columns-rows" title="Link to this heading"></a></h5>
<p><strong>Modifying DataFrame Structure:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Add column</p></td>
<td><p>Direct assignment</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df['new_col']</span> <span class="pre">=</span> <span class="pre">values</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Add column</p></td>
<td><p>From existing columns</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df['new_col']</span> <span class="pre">=</span> <span class="pre">df['col1']</span> <span class="pre">+</span> <span class="pre">df['col2']</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Add column</p></td>
<td><p>Using apply/lambda</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df['new_col']</span> <span class="pre">=</span> <span class="pre">df.apply(lambda</span> <span class="pre">x:</span> <span class="pre">func(x),</span> <span class="pre">axis=1)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Remove column</p></td>
<td><p>Using drop</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.drop('column',</span> <span class="pre">axis=1)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Remove row</p></td>
<td><p>Using drop</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.drop('index_label')</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Add row</p></td>
<td><p>Using loc</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.loc['new_index']</span> <span class="pre">=</span> <span class="pre">values</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Add row</p></td>
<td><p>Using append/concat</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pd.concat([df,</span> <span class="pre">new_row])</span></code></p></td>
</tr>
</tbody>
</table>
<section id="adding-and-removing-columns">
<h6>Adding and Removing Columns<a class="headerlink" href="#adding-and-removing-columns" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Adding new column with</p>
<ul>
<li><p>a scalar value</p></li>
<li><p>a list of values</p></li>
<li><p>a calculated values in a pandas series</p></li>
<li><p>a column with conditional values</p></li>
</ul>
</li>
<li><p>Removing</p>
<ul>
<li><p>a single column</p></li>
<li><p>multiple columns</p></li>
<li><p>columns in-place</p></li>
</ul>
</li>
</ul>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create a sample dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="s1">&#39;Miami&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">92000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;emp004&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">]</span>  <span class="c1"># Custom index</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Adding a new column with scalar value</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Adding &#39;Active&#39; column with same value for all rows:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 2. Adding a column with a list of values</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Performance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Adding &#39;Performance&#39; column with different values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 3. Adding a calculated column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Bonus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Salary&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Performance&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Adding calculated &#39;Bonus&#39; column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 4. Adding a column with conditional values</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Experience&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;Senior&#39;</span><span class="p">,</span> <span class="s1">&#39;Junior&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Adding conditional &#39;Experience&#39; column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 5. Removing a single column</span>
<span class="n">df_no_city</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Removing &#39;City&#39; column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_no_city</span><span class="p">)</span>

<span class="c1"># 6. Removing multiple columns</span>
<span class="n">df_minimal</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;Performance&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonus&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">6. Removing multiple columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_minimal</span><span class="p">)</span>

<span class="c1"># 7. Remove columns in-place</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="s1">&#39;Active&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">7. Removing multiple columns (inplace=True):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance

1. Adding &#39;Active&#39; column with same value for all rows:
           Name  Age      City  Salary Department  Active
emp001    Alice   24  New York   65000         HR    True
emp002      Bob   30    Boston   72000      Sales    True
emp003  Charlie   35   Chicago   85000       Tech    True
emp004    David   42   Seattle   92000       Tech    True
emp005      Eva   28     Miami   70000    Finance    True

2. Adding &#39;Performance&#39; column with different values:
           Name  Age      City  Salary Department  Active  Performance
emp001    Alice   24  New York   65000         HR    True          4.5
emp002      Bob   30    Boston   72000      Sales    True          4.0
emp003  Charlie   35   Chicago   85000       Tech    True          3.8
emp004    David   42   Seattle   92000       Tech    True          4.7
emp005      Eva   28     Miami   70000    Finance    True          4.2

3. Adding calculated &#39;Bonus&#39; column:
           Name  Age      City  Salary Department  Active  Performance   Bonus
emp001    Alice   24  New York   65000         HR    True          4.5  2925.0
emp002      Bob   30    Boston   72000      Sales    True          4.0  2880.0
emp003  Charlie   35   Chicago   85000       Tech    True          3.8  3230.0
emp004    David   42   Seattle   92000       Tech    True          4.7  4324.0
emp005      Eva   28     Miami   70000    Finance    True          4.2  2940.0

4. Adding conditional &#39;Experience&#39; column:
           Name  Age      City  Salary Department  Active  Performance   Bonus Experience
emp001    Alice   24  New York   65000         HR    True          4.5  2925.0     Junior
emp002      Bob   30    Boston   72000      Sales    True          4.0  2880.0     Junior
emp003  Charlie   35   Chicago   85000       Tech    True          3.8  3230.0     Senior
emp004    David   42   Seattle   92000       Tech    True          4.7  4324.0     Senior
emp005      Eva   28     Miami   70000    Finance    True          4.2  2940.0     Junior

5. Removing &#39;City&#39; column:
           Name  Age  Salary Department  Active  Performance   Bonus Experience
emp001    Alice   24   65000         HR    True          4.5  2925.0     Junior
emp002      Bob   30   72000      Sales    True          4.0  2880.0     Junior
emp003  Charlie   35   85000       Tech    True          3.8  3230.0     Senior
emp004    David   42   92000       Tech    True          4.7  4324.0     Senior
emp005      Eva   28   70000    Finance    True          4.2  2940.0     Junior

6. Removing multiple columns:
           Name  Age      City  Salary Department Experience
emp001    Alice   24  New York   65000         HR     Junior
emp002      Bob   30    Boston   72000      Sales     Junior
emp003  Charlie   35   Chicago   85000       Tech     Senior
emp004    David   42   Seattle   92000       Tech     Senior
emp005      Eva   28     Miami   70000    Finance     Junior

7. Removing multiple columns (inplace=True):
           Name  Age  Salary Department  Performance   Bonus
emp001    Alice   24   65000         HR          4.5  2925.0
emp002      Bob   30   72000      Sales          4.0  2880.0
emp003  Charlie   35   85000       Tech          3.8  3230.0
emp004    David   42   92000       Tech          4.7  4324.0
emp005      Eva   28   70000    Finance          4.2  2940.0
</pre></div>
</div>
</div>
</section>
<section id="adding-and-removing-rows">
<h6>Adding and Removing Rows<a class="headerlink" href="#adding-and-removing-rows" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Removing</p>
<ul>
<li><p>a row by index label</p></li>
<li><p>multiple rows</p></li>
</ul>
</li>
<li><p>Adding a new row</p>
<ul>
<li><p>with <code class="docutils literal notranslate"><span class="pre">.loc</span></code></p></li>
<li><p>with a Series</p></li>
</ul>
</li>
</ul>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="s1">&#39;Miami&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">92000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;emp004&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">]</span>  <span class="c1"># Custom index</span>

<span class="c1"># 1. Removing a row by index label</span>
<span class="n">df_no_bob</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;emp002&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. DataFrame without Bob (emp002):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_no_bob</span><span class="p">)</span>

<span class="c1"># 2. Removing multiple rows</span>
<span class="n">df_reduced</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. DataFrame without emp001 and emp005:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_reduced</span><span class="p">)</span>

<span class="c1"># 3. Adding a new row with .loc</span>
<span class="c1"># Create a copy to avoid SettingWithCopyWarning</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_new</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp006&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="s1">&#39;Dallas&#39;</span><span class="p">,</span> <span class="mi">88000</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. DataFrame with new employee:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_new</span><span class="p">)</span>

<span class="c1"># 4. Adding a row with a Series</span>
<span class="n">new_employee</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Grace&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="s1">&#39;Denver&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="mi">67000</span><span class="p">,</span> <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span>
<span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;emp007&#39;</span><span class="p">)</span>

<span class="n">df_newer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_new</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">new_employee</span><span class="p">])])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. DataFrame with another new employee:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_newer</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. DataFrame without Bob (emp002):
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance

2. DataFrame without emp001 and emp005:
           Name  Age     City  Salary Department
emp002      Bob   30   Boston   72000      Sales
emp003  Charlie   35  Chicago   85000       Tech
emp004    David   42  Seattle   92000       Tech

3. DataFrame with new employee:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance
emp006    Frank   38    Dallas   88000      Sales

4. DataFrame with another new employee:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance
emp006    Frank   38    Dallas   88000      Sales
emp007    Grace   27    Denver   67000         HR
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-3">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Adding columns is a common operation, especially when you need to create derived fields or features</p></li>
<li><p>Notice that we can add columns based on calculations from other columns - this is ideal for metrics and KPIs</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">drop()</span></code> function is powerful but doesn’t modify the original DataFrame unless you specify <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code></p></li>
<li><p>Adding rows is less common but useful for simulation, testing, or creating summary rows</p></li>
<li><p>Always be careful with the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter - <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> is for rows, <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> is for columns</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-2">
<p class="admonition-title">Exercise</p>
<p><strong>Adding and Removing Data:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">products</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Product_ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;P001&#39;</span><span class="p">,</span> <span class="s1">&#39;P002&#39;</span><span class="p">,</span> <span class="s1">&#39;P003&#39;</span><span class="p">,</span> <span class="s1">&#39;P004&#39;</span><span class="p">,</span> <span class="s1">&#39;P005&#39;</span><span class="p">,</span> <span class="s1">&#39;P006&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Product_Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;Smartphone&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet&#39;</span><span class="p">,</span> <span class="s1">&#39;Monitor&#39;</span><span class="p">,</span> <span class="s1">&#39;Keyboard&#39;</span><span class="p">,</span> <span class="s1">&#39;Mouse&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">,</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
    <span class="s1">&#39;In_Stock&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
    <span class="s1">&#39;Units&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">inventory</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
</pre></div>
</div>
<p>Use inventory dataframe and</p>
<ul class="simple">
<li><p>Add a ‘Value’ column that multiplies Price by Units</p></li>
<li><p>Add a ‘Status’ column: ‘Available’ if In_Stock is True, ‘Out of Stock’ otherwise</p></li>
<li><p>Remove the In_Stock column (now redundant with Status)</p></li>
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">new_product</span></code> row</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_product</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
    <span class="s1">&#39;Product_ID&#39;</span><span class="p">:</span> <span class="s1">&#39;P007&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Product_Name&#39;</span><span class="p">:</span> <span class="s1">&#39;Headphones&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
    <span class="s1">&#39;Units&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
    <span class="s1">&#39;Status&#39;</span><span class="p">:</span> <span class="s1">&#39;Available&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Continue with the inventory DataFrame from Exercise 1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original inventory:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>

<span class="c1"># 1. Add a &#39;Value&#39; column that multiplies Price by Units</span>
<span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Inventory with Value column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>

<span class="c1"># 2. Add a &#39;Status&#39; column: &#39;Available&#39; if In_Stock is True, &#39;Out of Stock&#39; otherwise</span>
<span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inventory</span><span class="p">[</span><span class="s1">&#39;In_Stock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;Available&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;Out of Stock&#39;</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Inventory with Status column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>

<span class="c1"># 3. Remove the In_Stock column (now redundant with Status)</span>
<span class="n">inventory_updated</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;In_Stock&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Inventory without In_Stock column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inventory_updated</span><span class="p">)</span>

<span class="c1"># 4. Add a new product row</span>
<span class="n">inventory_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">inventory_updated</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">new_product</span><span class="p">])])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Inventory with new product:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inventory_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="dataframe-sorting">
<h5>DataFrame Sorting<a class="headerlink" href="#dataframe-sorting" title="Link to this heading"></a></h5>
<section id="sorting-functions">
<h6>Sorting functions<a class="headerlink" href="#sorting-functions" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Key Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sort_values()</span></code></p></td>
<td><p>Sort by column values</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">by</span></code>, <code class="docutils literal notranslate"><span class="pre">ascending</span></code>, <code class="docutils literal notranslate"><span class="pre">inplace</span></code>, <code class="docutils literal notranslate"><span class="pre">na_position</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sort_index()</span></code></p></td>
<td><p>Sort by index</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ascending</span></code>, <code class="docutils literal notranslate"><span class="pre">inplace</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Multi-column sorting</p></td>
<td><p>Sort by multiple columns</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">by=['col1',</span> <span class="pre">'col2']</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Custom sorting</p></td>
<td><p>Sort with custom orders</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">by=col,</span> <span class="pre">key=function</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="basic-sorting">
<h6>Basic Sorting<a class="headerlink" href="#basic-sorting" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Sorting by a single column - ascending and descending</p></li>
<li><p>Sorting by index</p></li>
<li><p>Sorting by multiple columns</p></li>
<li><p>Sorting with different directions for each column</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-4">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="s1">&#39;Miami&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">92000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;emp004&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">]</span>  <span class="c1"># Custom index</span>

<span class="c1"># Continuing with our employee DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Sorting by a single column (ascending by default)</span>
<span class="n">df_by_age</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Sorted by Age (ascending):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_by_age</span><span class="p">)</span>

<span class="c1"># 2. Sorting by a single column (descending)</span>
<span class="n">df_by_salary_desc</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Salary&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Sorted by Salary (descending):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_by_salary_desc</span><span class="p">)</span>

<span class="c1"># 3. Sorting by index</span>
<span class="n">df_by_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Sorted by index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_by_index</span><span class="p">)</span>

<span class="c1"># 4. Sorting by multiple columns</span>
<span class="n">df_multi_sort</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Department&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Sorted by Department, then by Salary within each department:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_multi_sort</span><span class="p">)</span>

<span class="c1"># 5. Sorting with different directions for each column</span>
<span class="n">df_complex</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Department&#39;</span><span class="p">,</span> <span class="s1">&#39;Salary&#39;</span><span class="p">],</span> 
                          <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Sorted by Department (asc), then by Salary (desc) within each department:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_complex</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance

1. Sorted by Age (ascending):
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp005      Eva   28     Miami   70000    Finance
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech

2. Sorted by Salary (descending):
           Name  Age      City  Salary Department
emp004    David   42   Seattle   92000       Tech
emp003  Charlie   35   Chicago   85000       Tech
emp002      Bob   30    Boston   72000      Sales
emp005      Eva   28     Miami   70000    Finance
emp001    Alice   24  New York   65000         HR

3. Sorted by index:
           Name  Age      City  Salary Department
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech
emp005      Eva   28     Miami   70000    Finance

4. Sorted by Department, then by Salary within each department:
           Name  Age      City  Salary Department
emp005      Eva   28     Miami   70000    Finance
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp003  Charlie   35   Chicago   85000       Tech
emp004    David   42   Seattle   92000       Tech

5. Sorted by Department (asc), then by Salary (desc) within each department:
           Name  Age      City  Salary Department
emp005      Eva   28     Miami   70000    Finance
emp001    Alice   24  New York   65000         HR
emp002      Bob   30    Boston   72000      Sales
emp004    David   42   Seattle   92000       Tech
emp003  Charlie   35   Chicago   85000       Tech
</pre></div>
</div>
</div>
</section>
<section id="advanced-sorting">
<h6>Advanced Sorting<a class="headerlink" href="#advanced-sorting" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Sort with NaNs at the beginning or end</p></li>
<li><p>Custom categorical sorting (custom order)</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-5">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Sorting with NaN values</span>
<span class="c1"># Create a DataFrame with some missing values</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span>
    <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Seattle&#39;</span><span class="p">,</span> <span class="s1">&#39;Miami&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">65000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">92000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;emp002&#39;</span><span class="p">,</span> <span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;emp004&#39;</span><span class="p">,</span> <span class="s1">&#39;emp005&#39;</span><span class="p">]</span>  <span class="c1"># Custom index</span>

<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp001&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;emp003&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. DataFrame with NaN values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Sort with NaNs at the beginning</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1a. Sorted with NaNs first:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">))</span>

<span class="c1"># Sort with NaNs at the end</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1b. Sorted with NaNs last:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="n">na_position</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">))</span>

<span class="c1"># 3. Custom categorical sorting</span>
<span class="c1"># Create a custom order for departments</span>
<span class="n">dept_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">,</span> <span class="s1">&#39;Tech&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Dept_Coded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Department&#39;</span><span class="p">],</span> 
                                 <span class="n">categories</span><span class="o">=</span><span class="n">dept_order</span><span class="p">,</span> 
                                 <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Custom department order sorting:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Dept_Coded&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. DataFrame with NaN values:
           Name  Age     City  Salary Department
emp001    Alice   24      NaN   65000         HR
emp002      Bob   30   Boston   72000      Sales
emp003  Charlie   35      NaN   85000       Tech
emp004    David   42  Seattle   92000       Tech
emp005      Eva   28    Miami   70000    Finance

1a. Sorted with NaNs first:
           Name  Age     City  Salary Department
emp001    Alice   24      NaN   65000         HR
emp003  Charlie   35      NaN   85000       Tech
emp002      Bob   30   Boston   72000      Sales
emp005      Eva   28    Miami   70000    Finance
emp004    David   42  Seattle   92000       Tech

1b. Sorted with NaNs last:
           Name  Age     City  Salary Department
emp002      Bob   30   Boston   72000      Sales
emp005      Eva   28    Miami   70000    Finance
emp004    David   42  Seattle   92000       Tech
emp001    Alice   24      NaN   65000         HR
emp003  Charlie   35      NaN   85000       Tech

3. Custom department order sorting:
           Name  Age     City  Salary Department Dept_Coded
emp001    Alice   24      NaN   65000         HR         HR
emp002      Bob   30   Boston   72000      Sales      Sales
emp005      Eva   28    Miami   70000    Finance    Finance
emp003  Charlie   35      NaN   85000       Tech       Tech
emp004    David   42  Seattle   92000       Tech       Tech
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-4">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Sorting is essential for both data analysis and presentation.</p></li>
<li><p>Multi-column sorting is particularly useful for hierarchical data.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ascending</span></code> parameter can be a single boolean or a list of booleans for multi-column sorts.</p></li>
<li><p>Custom sorting allows for domain-specific ordering beyond simple alphabetical or numerical order.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> parameter can be used to modify the original DataFrame rather than creating a new one.</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-3">
<p class="admonition-title">Exercise</p>
<p><strong>Multiple Column Sorting with Custom Orders:</strong></p>
<p>This dataset represents results from three independent candidate gene studies investigating the association between common genetic variants and breast cancer risk, where odds ratios indicate the increased likelihood of developing breast cancer for carriers of each gene variant compared to non-carriers.</p>
<ol class="arabic simple">
<li><p>Create correct chromosome ordering: ‘Chr1’ to ‘ChrX’, ‘ChrY’</p></li>
<li><p>Create study category with custom order: ‘Study1’, ‘Study2’, ‘Study3’</p></li>
<li><p>Sort by Chromosome (numerical), then by Study (custom order)</p></li>
<li><p>Sort by statistical significance (p-value) within each Chromosome</p></li>
<li><p>Select genes sorted by P-value and effect size within each chromosome</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Create a genetic dataset</span>
<span class="n">genetic_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gene&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">,</span> <span class="s1">&#39;TP53&#39;</span><span class="p">,</span> <span class="s1">&#39;APOE&#39;</span><span class="p">,</span> <span class="s1">&#39;PTEN&#39;</span><span class="p">,</span> <span class="s1">&#39;BRAF&#39;</span><span class="p">,</span> <span class="s1">&#39;KRAS&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;BRCA2&#39;</span><span class="p">,</span> <span class="s1">&#39;EGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;TNF&#39;</span><span class="p">,</span> <span class="s1">&#39;IL6&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Chromosome&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr19&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr10&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr12&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;Chr13&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr6&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Study&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0050</span><span class="p">,</span> <span class="mf">0.0200</span><span class="p">,</span> <span class="mf">0.0150</span><span class="p">,</span> <span class="mf">0.0300</span><span class="p">,</span> <span class="mf">0.0400</span><span class="p">,</span> 
              <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.0250</span><span class="p">,</span> <span class="mf">0.0100</span><span class="p">,</span> <span class="mf">0.0450</span><span class="p">],</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">genetic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">genetic_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genetic DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">)</span>

<span class="c1"># 1. Create correct chromosome ordering</span>
<span class="n">chrom_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr2&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr3&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr4&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr5&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr6&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Chr8&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr9&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr10&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr11&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr12&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr13&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr14&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Chr15&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr16&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr18&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr19&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr20&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr21&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr22&#39;</span><span class="p">,</span> <span class="s1">&#39;ChrX&#39;</span><span class="p">,</span> <span class="s1">&#39;ChrY&#39;</span><span class="p">]</span>
<span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Chromosome_Sorted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">],</span> 
                                               <span class="n">categories</span><span class="o">=</span><span class="n">chrom_order</span><span class="p">,</span> 
                                               <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 2. Create study category with custom order</span>
<span class="n">study_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">]</span>
<span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Study_Sorted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">],</span> 
                                           <span class="n">categories</span><span class="o">=</span><span class="n">study_order</span><span class="p">,</span> 
                                           <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 3. Sort by Chromosome (numerical), then by Study (custom order)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Sorted by Chromosome, then by Study (custom orders):&quot;</span><span class="p">)</span>
<span class="n">sorted_genetic</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Chromosome_Sorted&#39;</span><span class="p">,</span> <span class="s1">&#39;Study_Sorted&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sorted_genetic</span><span class="p">[[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">,</span> <span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="s1">&#39;Study&#39;</span><span class="p">]])</span>

<span class="c1"># 4. Sort by statistical significance (p-value) within each Chromosome</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Sorted by Chromosome, then by P-value (ascending) within each chromosome:&quot;</span><span class="p">)</span>
<span class="n">genetic_by_pvalue</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Chromosome_Sorted&#39;</span><span class="p">,</span> <span class="s1">&#39;PValue&#39;</span><span class="p">],</span> 
                                         <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_by_pvalue</span><span class="p">[[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">,</span> <span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="s1">&#39;PValue&#39;</span><span class="p">]])</span>

<span class="c1"># 5. Rank genes by effect size within each chromosome</span>
<span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;EffectRank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">)[</span><span class="s1">&#39;EffectSize&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Genes according to P-value and Effect Size within each Chromosome:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PValue&quot;</span><span class="p">,</span><span class="s2">&quot;EffectSize&quot;</span><span class="p">,</span> <span class="s2">&quot;Chromosome_Sorted&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">])[</span><span class="s2">&quot;Gene&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The most significant findings are in the DNA repair genes BRCA1 and BRCA2 (p-values 0.0001 and 0.0005), with BRCA1 carriers showing 2.5 times higher odds and BRCA2 carriers showing 2.7 times higher odds of developing breast cancer. Other genes showing significant but less pronounced associations include inflammatory pathway genes (TNF) and key tumor suppressor genes (TP53, PTEN), highlighting the multifactorial genetic architecture of breast cancer susceptibility that spans DNA repair, cell cycle regulation, and inflammatory response pathways</p>
</div>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Flexible Selection:</strong> Pandas provides multiple ways to select, filter, and extract data</p></li>
<li><p><strong>Structure Modification:</strong> Adding and removing columns/rows enables dataset evolution</p></li>
<li><p><strong>Meaningful Sorting:</strong> Proper sorting is essential for analysis and presentation</p></li>
<li><p><strong>Custom Orders:</strong> Categorical data types allow you to enforce domain-specific ordering</p></li>
<li><p><strong>Combined Operations:</strong> The real power comes from combining these techniques</p></li>
</ol>
</div>
</section>
</section>
<span id="document-11.Pandas_indexing_slicing"></span><section id="indexing-selection-slicing-in-pandas">
<h4>Indexing, Selection &amp; Slicing in Pandas<a class="headerlink" href="#indexing-selection-slicing-in-pandas" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Differentiate between label-based and position-based indexing and apply each method appropriately.</p></li>
<li><p>Use Boolean indexing to filter data based on specific conditions, connecting concepts from NumPy.</p></li>
<li><p>Apply <code class="docutils literal notranslate"><span class="pre">.loc</span></code>, <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>, and <code class="docutils literal notranslate"><span class="pre">.at</span></code> selection methods to extract desired data, and employ multi-level slicing techniques.</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>In the previous session, we introduced some basic ways to select data. Now we’ll dive deeper into Pandas’ powerful indexing systems.</p></li>
<li><p>Think of these techniques as the surgical tools that let you precisely extract exactly the data you need.</p></li>
<li><p>Understanding the differences between these indexing methods will make your code more efficient and help you avoid common errors.</p></li>
<li><p>These concepts build directly on your NumPy knowledge, but with added capabilities for labeled data.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>Precise data access is the foundation of efficient data analysis</p></li>
<li><p>Pandas offers multiple ways to access data, each with specific use cases</p></li>
</ul>
<section id="label-vs-position-based-indexing">
<h5>Label vs. Position-based Indexing<a class="headerlink" href="#label-vs-position-based-indexing" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Two Fundamental Indexing Approaches</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Indexing Type</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Use Case</p></th>
<th class="head"><p>NumPy Equivalent</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Label-based</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.loc[]</span></code></p></td>
<td><p>When you know the labels</p></td>
<td><p>N/A (NumPy is position-based)</p></td>
</tr>
<tr class="row-odd"><td><p>Position-based</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></p></td>
<td><p>When you know the positions</p></td>
<td><p>Standard NumPy indexing</p></td>
</tr>
<tr class="row-even"><td><p>Mixed</p></td>
<td><p>Direct <code class="docutils literal notranslate"><span class="pre">[]</span></code></p></td>
<td><p>Simple selection (but less explicit)</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
<section id="creating-a-dataframe-with-meaningful-indices">
<h6>Creating a DataFrame with Meaningful Indices<a class="headerlink" href="#creating-a-dataframe-with-meaningful-indices" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a DataFrame with custom indices</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Create a genetic dataset</span>
<span class="n">genetic_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gene&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">,</span> <span class="s1">&#39;TP53&#39;</span><span class="p">,</span> <span class="s1">&#39;APOE&#39;</span><span class="p">,</span> <span class="s1">&#39;PTEN&#39;</span><span class="p">,</span> <span class="s1">&#39;BRAF&#39;</span><span class="p">,</span> <span class="s1">&#39;KRAS&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;BRCA2&#39;</span><span class="p">,</span> <span class="s1">&#39;EGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;TNF&#39;</span><span class="p">,</span> <span class="s1">&#39;IL6&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Chromosome&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr19&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr10&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr12&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;Chr13&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr6&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Study&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0050</span><span class="p">,</span> <span class="mf">0.0200</span><span class="p">,</span> <span class="mf">0.0150</span><span class="p">,</span> <span class="mf">0.0300</span><span class="p">,</span> <span class="mf">0.0400</span><span class="p">,</span> 
              <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.0250</span><span class="p">,</span> <span class="mf">0.0100</span><span class="p">,</span> <span class="mf">0.0450</span><span class="p">],</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">genetic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">genetic_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genetic DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">)</span>

<span class="c1"># Set a meaningful index from an existing column</span>
<span class="n">genetic_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame with &#39;Gene&#39; as index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">)</span>

<span class="c1"># Reset index to return to default integer indexing</span>
<span class="n">df_reset</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame with default integer index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_reset</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Genetic DataFrame:
    Gene Chromosome   Study  PValue  EffectSize
0  BRCA1      Chr17  Study1  0.0001         2.5
1   TP53      Chr17  Study2  0.0050         1.8
2   APOE      Chr19  Study1  0.0200         3.2
3   PTEN      Chr10  Study3  0.0150         2.1
4   BRAF       Chr7  Study2  0.0300         1.5
5   KRAS      Chr12  Study3  0.0400         1.2
6  BRCA2      Chr13  Study1  0.0005         2.7
7   EGFR       Chr7  Study2  0.0250         1.9
8    TNF       Chr6  Study3  0.0100         2.3
9    IL6       Chr7  Study1  0.0450         1.1

DataFrame with &#39;Gene&#39; as index:
      Chromosome   Study  PValue  EffectSize
Gene
BRCA1      Chr17  Study1  0.0001         2.5
TP53       Chr17  Study2  0.0050         1.8
APOE       Chr19  Study1  0.0200         3.2
PTEN       Chr10  Study3  0.0150         2.1
BRAF        Chr7  Study2  0.0300         1.5
KRAS       Chr12  Study3  0.0400         1.2
BRCA2      Chr13  Study1  0.0005         2.7
EGFR        Chr7  Study2  0.0250         1.9
TNF         Chr6  Study3  0.0100         2.3
IL6         Chr7  Study1  0.0450         1.1

DataFrame with default integer index:
    Gene Chromosome   Study  PValue  EffectSize
0  BRCA1      Chr17  Study1  0.0001         2.5
1   TP53      Chr17  Study2  0.0050         1.8
2   APOE      Chr19  Study1  0.0200         3.2
3   PTEN      Chr10  Study3  0.0150         2.1
4   BRAF       Chr7  Study2  0.0300         1.5
5   KRAS      Chr12  Study3  0.0400         1.2
6  BRCA2      Chr13  Study1  0.0005         2.7
7   EGFR       Chr7  Study2  0.0250         1.9
8    TNF       Chr6  Study3  0.0100         2.3
9    IL6       Chr7  Study1  0.0450         1.1
</pre></div>
</div>
</div>
</section>
<section id="use-label-and-position-based-indexing">
<h6>Use Label and Position-based Indexing<a class="headerlink" href="#use-label-and-position-based-indexing" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Label-based indexing with <code class="docutils literal notranslate"><span class="pre">.loc</span></code></p></li>
<li><p>Select multiple rows by label</p></li>
<li><p>Select rows and columns by label</p></li>
<li><p>Slicing dataframe using labels</p></li>
<li><p>Position-based indexing with <code class="docutils literal notranslate"><span class="pre">.iloc</span></code></p></li>
<li><p>Select multiple rows by position</p></li>
<li><p>Slicing dataframe using indices (Select rows and columns by position)</p></li>
</ul>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the genetic_df with &#39;Gene&#39; as the index</span>

<span class="c1"># 1. Label-based indexing with .loc</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1.1. Label-based selection (.loc):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data for &#39;BRCA1&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">])</span>

<span class="c1"># Select multiple rows by label</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1.2. Data for &#39;TP53&#39; and &#39;APOE&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;TP53&#39;</span><span class="p">,</span> <span class="s1">&#39;APOE&#39;</span><span class="p">]])</span>

<span class="c1"># Select rows and columns by label</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1.3. Chromosome and PValue for &#39;BRAF&#39; and &#39;KRAS&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;BRAF&#39;</span><span class="p">,</span> <span class="s1">&#39;KRAS&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">,</span> <span class="s1">&#39;PValue&#39;</span><span class="p">]])</span>

<span class="c1"># Slicing dataframe using labels</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1.4. All the rows of Chromosome and PValue columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">,</span> <span class="s1">&#39;PValue&#39;</span><span class="p">]])</span>
<span class="n">gene_set</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BRCA1&quot;</span><span class="p">,</span> <span class="s2">&quot;BRCA2&quot;</span><span class="p">,</span> <span class="s2">&quot;TP53&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1.5. row indices in gene_set array and column indices - Study, EffectSize:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;BRCA1&quot;</span><span class="p">,</span><span class="s2">&quot;BRAF&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">,</span><span class="s2">&quot;EffectSize&quot;</span><span class="p">]])</span>

<span class="c1"># 2. Position-based indexing with .iloc</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2.1. Position-based selection (.iloc):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Third row (index position 2):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Select multiple rows by position</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2.2. First and fourth rows (positions 0 and 3):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>

<span class="c1"># Slicing dataframe using indices - Select rows and columns by position</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2.3. Rows 1-3, columns 0-1:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># 3. Mixed indexing (direct [])</span>
<span class="c1"># Mixing approaches (not recommended but sometimes seen)</span>
<span class="c1"># print(&quot;\nFirst two rows of &#39;Study&#39; column:&quot;)</span>
<span class="c1"># print(genetic_df[&#39;Study&#39;][0:2])  # Chained indexing - can lead to issues</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1.1. Label-based selection (.loc):
Data for &#39;BRCA1&#39;:
Chromosome     Chr17
Study         Study1
PValue        0.0001
EffectSize       2.5
Name: BRCA1, dtype: object

1.2. Data for &#39;TP53&#39; and &#39;APOE&#39;:
     Chromosome   Study  PValue  EffectSize
Gene
TP53      Chr17  Study2   0.005         1.8
APOE      Chr19  Study1   0.020         3.2

1.3. Chromosome and PValue for &#39;BRAF&#39; and &#39;KRAS&#39;:
     Chromosome  PValue
Gene
BRAF       Chr7    0.03
KRAS      Chr12    0.04

1.4. All the rows of Chromosome and PValue columns:
      Chromosome  PValue
Gene
BRCA1      Chr17  0.0001
TP53       Chr17  0.0050
APOE       Chr19  0.0200
PTEN       Chr10  0.0150
BRAF        Chr7  0.0300
KRAS       Chr12  0.0400
BRCA2      Chr13  0.0005
EGFR        Chr7  0.0250
TNF         Chr6  0.0100
IL6         Chr7  0.0450

1.5. row indices in gene_set array and column indices - Study, EffectSize:
        Study  EffectSize
Gene
BRCA1  Study1         2.5
BRAF   Study2         1.5

2.1. Position-based selection (.iloc):
Third row (index position 2):
Chromosome     Chr19
Study         Study1
PValue          0.02
EffectSize       3.2
Name: APOE, dtype: object

2.2. First and fourth rows (positions 0 and 3):
      Chromosome   Study  PValue  EffectSize
Gene
BRCA1      Chr17  Study1  0.0001         2.5
PTEN       Chr10  Study3  0.0150         2.1

2.3. Rows 1-3, columns 0-1:
     Chromosome   Study
Gene
TP53      Chr17  Study2
APOE      Chr19  Study1
PTEN      Chr10  Study3
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The key distinction is that <code class="docutils literal notranslate"><span class="pre">.loc</span></code> uses labels, while <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> uses integer positions.</p></li>
<li><p>Think of <code class="docutils literal notranslate"><span class="pre">.loc</span></code> as looking up data in a dictionary by key, and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> as accessing a list by position.</p></li>
<li><p>Label-based indexing is more intuitive when working with real-world data that has meaningful labels.</p></li>
<li><p>Position-based indexing connects directly to your NumPy knowledge and is useful for algorithms that need specific positions.</p></li>
<li><p>Using the direct <code class="docutils literal notranslate"><span class="pre">[]</span></code> approach is convenient but can be ambiguous and lead to unexpected behavior.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">df[mask]</span></code> can be thought as shorthand for <code class="docutils literal notranslate"><span class="pre">df.loc[mask,</span> <span class="pre">:]</span></code></p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is more explicit and makes your intentions clearer - you’re specifically asking for label-based indexing</p></li>
</ul>
</li>
<li><p>When filtering data with conditions, particularly with missing values, <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is generally safer.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> generally handles missing values more gracefully. If your mask involves columns containing NaN values, direct indexing might raise unexpected errors while <code class="docutils literal notranslate"><span class="pre">.loc</span></code> will typically handle them correctly</p></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<section id="boolean-indexing">
<h5>Boolean Indexing<a class="headerlink" href="#boolean-indexing" title="Link to this heading"></a></h5>
<p><strong>Boolean Indexing and Filtering:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Concept</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Connection to NumPy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Boolean masks</p></td>
<td><p>Arrays of True/False values</p></td>
<td><p>Direct equivalent in NumPy</p></td>
</tr>
<tr class="row-odd"><td><p>Comparison operators</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&gt;,</span> <span class="pre">&lt;,</span> <span class="pre">==,</span> <span class="pre">!=,</span> <span class="pre">&gt;=,</span> <span class="pre">&lt;=</span></code></p></td>
<td><p>Same as NumPy</p></td>
</tr>
<tr class="row-even"><td><p>Compound conditions</p></td>
<td><p>Combined with `&amp;,</p></td>
<td><p>, ~`</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">query()</span></code> method</p></td>
<td><p>SQL-like filtering</p></td>
<td><p>Pandas-specific, no NumPy equivalent</p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Simple boolean mask</p></li>
<li><p>Using the mask to filter rows</p></li>
<li><p>Inline boolean indexing</p></li>
<li><p>Multiple conditions with &amp; (and), | (or)</p></li>
</ul>
<p><strong>Creating and Using Boolean Masks:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset example</span>
<span class="n">genetic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">genetic_data</span><span class="p">)</span>
<span class="n">genetic_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Gene&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">)</span>

<span class="c1"># 1. Simple boolean mask</span>
<span class="n">low_pvalue_mask</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;PValue&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.01</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Boolean mask for low P-values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">low_pvalue_mask</span><span class="p">)</span>

<span class="c1"># Using the mask to filter rows</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Genes with low P-values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">low_pvalue_mask</span><span class="p">])</span>

<span class="c1"># 2. Inline boolean indexing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Genes on Chromosome 7:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">])</span>

<span class="c1"># 3. Multiple conditions with &amp; (and), | (or)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3a. Genes from Study1 with large effect size:&quot;</span><span class="p">)</span>
<span class="n">multi_cond_and</span> <span class="o">=</span> <span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Study1&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;EffectSize&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">multi_cond_and</span><span class="p">])</span> <span class="c1"># print(genetic_df.loc[multi_cond_and, :])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3b. Genes with either very low P-value or large effect size:&quot;</span><span class="p">)</span>
<span class="n">multi_cond_or</span> <span class="o">=</span> <span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;PValue&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.005</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;EffectSize&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">multi_cond_or</span><span class="p">])</span> <span class="c1"># print(genetic_df.loc[multi_cond_or, :])</span>

<span class="c1"># 4. Using .loc with boolean masks</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4.a Using .loc with boolean mask:&quot;</span><span class="p">)</span>
<span class="n">chr17_genes</span> <span class="o">=</span> <span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chr17&#39;</span><span class="p">)</span>
<span class="n">col_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">,</span> <span class="s1">&#39;EffectSize&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">chr17_genes</span><span class="p">,</span> <span class="n">col_list</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4.b Using .loc with boolean mask:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">multi_cond_and</span><span class="p">,</span> <span class="n">col_list</span><span class="p">])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Original</span> <span class="n">DataFrame</span><span class="p">:</span>
      <span class="n">Chromosome</span>   <span class="n">Study</span>  <span class="n">PValue</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">BRCA1</span>      <span class="n">Chr17</span>  <span class="n">Study1</span>  <span class="mf">0.0001</span>         <span class="mf">2.5</span>
<span class="n">TP53</span>       <span class="n">Chr17</span>  <span class="n">Study2</span>  <span class="mf">0.0050</span>         <span class="mf">1.8</span>
<span class="n">APOE</span>       <span class="n">Chr19</span>  <span class="n">Study1</span>  <span class="mf">0.0200</span>         <span class="mf">3.2</span>
<span class="n">PTEN</span>       <span class="n">Chr10</span>  <span class="n">Study3</span>  <span class="mf">0.0150</span>         <span class="mf">2.1</span>
<span class="n">BRAF</span>        <span class="n">Chr7</span>  <span class="n">Study2</span>  <span class="mf">0.0300</span>         <span class="mf">1.5</span>
<span class="n">KRAS</span>       <span class="n">Chr12</span>  <span class="n">Study3</span>  <span class="mf">0.0400</span>         <span class="mf">1.2</span>
<span class="n">BRCA2</span>      <span class="n">Chr13</span>  <span class="n">Study1</span>  <span class="mf">0.0005</span>         <span class="mf">2.7</span>
<span class="n">EGFR</span>        <span class="n">Chr7</span>  <span class="n">Study2</span>  <span class="mf">0.0250</span>         <span class="mf">1.9</span>
<span class="n">TNF</span>         <span class="n">Chr6</span>  <span class="n">Study3</span>  <span class="mf">0.0100</span>         <span class="mf">2.3</span>
<span class="n">IL6</span>         <span class="n">Chr7</span>  <span class="n">Study1</span>  <span class="mf">0.0450</span>         <span class="mf">1.1</span>

<span class="mf">1.</span> <span class="n">Boolean</span> <span class="n">mask</span> <span class="k">for</span> <span class="n">low</span> <span class="n">P</span><span class="o">-</span><span class="n">values</span><span class="p">:</span>
<span class="n">Gene</span>
<span class="n">BRCA1</span>     <span class="kc">True</span>
<span class="n">TP53</span>      <span class="kc">True</span>
<span class="n">APOE</span>     <span class="kc">False</span>
<span class="n">PTEN</span>     <span class="kc">False</span>
<span class="n">BRAF</span>     <span class="kc">False</span>
<span class="n">KRAS</span>     <span class="kc">False</span>
<span class="n">BRCA2</span>     <span class="kc">True</span>
<span class="n">EGFR</span>     <span class="kc">False</span>
<span class="n">TNF</span>      <span class="kc">False</span>
<span class="n">IL6</span>      <span class="kc">False</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">PValue</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">Genes</span> <span class="k">with</span> <span class="n">low</span> <span class="n">P</span><span class="o">-</span><span class="n">values</span><span class="p">:</span>
      <span class="n">Chromosome</span>   <span class="n">Study</span>  <span class="n">PValue</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">BRCA1</span>      <span class="n">Chr17</span>  <span class="n">Study1</span>  <span class="mf">0.0001</span>         <span class="mf">2.5</span>
<span class="n">TP53</span>       <span class="n">Chr17</span>  <span class="n">Study2</span>  <span class="mf">0.0050</span>         <span class="mf">1.8</span>
<span class="n">BRCA2</span>      <span class="n">Chr13</span>  <span class="n">Study1</span>  <span class="mf">0.0005</span>         <span class="mf">2.7</span>

<span class="mf">2.</span> <span class="n">Genes</span> <span class="n">on</span> <span class="n">Chromosome</span> <span class="mi">7</span><span class="p">:</span>
     <span class="n">Chromosome</span>   <span class="n">Study</span>  <span class="n">PValue</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">BRAF</span>       <span class="n">Chr7</span>  <span class="n">Study2</span>   <span class="mf">0.030</span>         <span class="mf">1.5</span>
<span class="n">EGFR</span>       <span class="n">Chr7</span>  <span class="n">Study2</span>   <span class="mf">0.025</span>         <span class="mf">1.9</span>
<span class="n">IL6</span>        <span class="n">Chr7</span>  <span class="n">Study1</span>   <span class="mf">0.045</span>         <span class="mf">1.1</span>

<span class="mi">3</span><span class="n">a</span><span class="o">.</span> <span class="n">Genes</span> <span class="kn">from</span><span class="w"> </span><span class="nn">Study1</span> <span class="k">with</span> <span class="n">large</span> <span class="n">effect</span> <span class="n">size</span><span class="p">:</span>
      <span class="n">Chromosome</span>   <span class="n">Study</span>  <span class="n">PValue</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">APOE</span>       <span class="n">Chr19</span>  <span class="n">Study1</span>  <span class="mf">0.0200</span>         <span class="mf">3.2</span>
<span class="n">BRCA2</span>      <span class="n">Chr13</span>  <span class="n">Study1</span>  <span class="mf">0.0005</span>         <span class="mf">2.7</span>

<span class="mi">3</span><span class="n">b</span><span class="o">.</span> <span class="n">Genes</span> <span class="k">with</span> <span class="n">either</span> <span class="n">very</span> <span class="n">low</span> <span class="n">P</span><span class="o">-</span><span class="n">value</span> <span class="ow">or</span> <span class="n">large</span> <span class="n">effect</span> <span class="n">size</span><span class="p">:</span>
      <span class="n">Chromosome</span>   <span class="n">Study</span>  <span class="n">PValue</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">BRCA1</span>      <span class="n">Chr17</span>  <span class="n">Study1</span>  <span class="mf">0.0001</span>         <span class="mf">2.5</span>
<span class="n">APOE</span>       <span class="n">Chr19</span>  <span class="n">Study1</span>  <span class="mf">0.0200</span>         <span class="mf">3.2</span>
<span class="n">BRCA2</span>      <span class="n">Chr13</span>  <span class="n">Study1</span>  <span class="mf">0.0005</span>         <span class="mf">2.7</span>

<span class="mf">4.</span><span class="n">a</span> <span class="n">Using</span> <span class="o">.</span><span class="n">loc</span> <span class="k">with</span> <span class="n">boolean</span> <span class="n">mask</span><span class="p">:</span>
        <span class="n">Study</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">BRCA1</span>  <span class="n">Study1</span>         <span class="mf">2.5</span>
<span class="n">TP53</span>   <span class="n">Study2</span>         <span class="mf">1.8</span>

<span class="mf">4.</span><span class="n">b</span> <span class="n">Using</span> <span class="o">.</span><span class="n">loc</span> <span class="k">with</span> <span class="n">boolean</span> <span class="n">mask</span><span class="p">:</span>
        <span class="n">Study</span>  <span class="n">EffectSize</span>
<span class="n">Gene</span>
<span class="n">APOE</span>   <span class="n">Study1</span>         <span class="mf">3.2</span>
<span class="n">BRCA2</span>  <span class="n">Study1</span>         <span class="mf">2.7</span>
</pre></div>
</div>
</div>
<section id="advanced-boolean-indexing-techniques">
<h6>Advanced Boolean Indexing Techniques<a class="headerlink" href="#advanced-boolean-indexing-techniques" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-3">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>String methods with boolean indexing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.isin()</span></code> for multiple value matching</p></li>
<li><p>Combining with function application</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. String methods with boolean indexing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Chromosomes starting with &#39;Chr1&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Chr1&#39;</span><span class="p">)])</span>

<span class="c1"># 2. isin() for multiple value matching</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Genes from Study1 or Study3:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">])])</span>

<span class="c1"># 3. Combining with function application</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_significant</span><span class="p">(</span><span class="n">p_value</span><span class="p">):</span>
    <span class="c1"># Consider p-values below P-value threshold as highly significant</span>
    <span class="k">return</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.001</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Highly significant genes using a function:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">[</span><span class="n">genetic_df</span><span class="p">[</span><span class="s1">&#39;PValue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_significant</span><span class="p">)])</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Chromosomes starting with &#39;Chr1&#39;:
      Chromosome   Study  PValue  EffectSize
Gene
BRCA1      Chr17  Study1  0.0001         2.5
TP53       Chr17  Study2  0.0050         1.8
APOE       Chr19  Study1  0.0200         3.2
PTEN       Chr10  Study3  0.0150         2.1
KRAS       Chr12  Study3  0.0400         1.2
BRCA2      Chr13  Study1  0.0005         2.7

2. Genes from Study1 or Study3:
      Chromosome   Study  PValue  EffectSize
Gene
BRCA1      Chr17  Study1  0.0001         2.5
APOE       Chr19  Study1  0.0200         3.2
PTEN       Chr10  Study3  0.0150         2.1
KRAS       Chr12  Study3  0.0400         1.2
BRCA2      Chr13  Study1  0.0005         2.7
TNF         Chr6  Study3  0.0100         2.3
IL6         Chr7  Study1  0.0450         1.1

3. Highly significant genes using a function:
      Chromosome   Study  PValue  EffectSize
Gene
BRCA1      Chr17  Study1  0.0001         2.5
BRCA2      Chr13  Study1  0.0005         2.7
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Boolean indexing is one of the most powerful features in Pandas and NumPy - it lets you filter data based on conditions.</p></li>
<li><p>The syntax is very similar to NumPy’s boolean masking, which you’re already familiar with.</p></li>
<li><p>Remember that when combining conditions, you need to use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> for AND and <code class="docutils literal notranslate"><span class="pre">|</span></code> for OR,</p>
<ul>
<li><p>not the Python keywords ‘and’ and ‘or’.</p></li>
<li><p>Each condition needs to be wrapped in parentheses when combining them - this is a common source of errors.</p></li>
</ul>
</li>
<li><p>You can combine boolean indexing with <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to filter rows and select specific columns in one operation.</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p>Boolean indexing using <code class="docutils literal notranslate"><span class="pre">students</span></code> dataframe to</p>
<ol class="arabic simple">
<li><p>Find all students who scored 90 or above</p></li>
<li><p>Find all Math students with grades below 80</p></li>
<li><p>Find all Science or Art students who are 17 years old</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a DataFrame of student data</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Emma&#39;</span><span class="p">,</span> <span class="s1">&#39;Noah&#39;</span><span class="p">,</span> <span class="s1">&#39;Olivia&#39;</span><span class="p">,</span> <span class="s1">&#39;Liam&#39;</span><span class="p">,</span> <span class="s1">&#39;Ava&#39;</span><span class="p">,</span> <span class="s1">&#39;William&#39;</span><span class="p">,</span> <span class="s1">&#39;Sophia&#39;</span><span class="p">,</span> <span class="s1">&#39;Mason&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Grade&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span>
    <span class="s1">&#39;Subject&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;Art&#39;</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;Art&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Students DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">students</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tasks:</span>
<span class="c1"># 1. Find all students who scored 90 or above</span>
<span class="n">high_performers</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. High performers (90+ grade):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_performers</span><span class="p">)</span>

<span class="c1"># 2. Find all Math students with grades below 80</span>
<span class="n">struggling_math</span> <span class="o">=</span> <span class="n">students</span><span class="p">[(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Math&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Math students with grades below 80:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">struggling_math</span><span class="p">)</span>

<span class="c1"># 3. Find all Science or Art students who are 17 years old</span>
<span class="n">science_art_17</span> <span class="o">=</span> <span class="n">students</span><span class="p">[(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;Art&#39;</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">17</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Science or Art students who are 17:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">science_art_17</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Selection Toolkit:</strong> Different indexing methods are optimized for different tasks</p></li>
<li><p><strong>Label vs. Position:</strong> <code class="docutils literal notranslate"><span class="pre">.loc</span></code> uses labels, <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> uses positions - choose based on what you know</p></li>
<li><p><strong>Boolean Filtering:</strong> Powerful way to extract data matching specific conditions</p></li>
</ol>
</div>
</section>
<section id="homework">
<h5>Homework<a class="headerlink" href="#homework" title="Link to this heading"></a></h5>
<div class="admonition-homework homework important admonition" id="homework-0">
<p class="admonition-title">Homework</p>
<p class="rubric" id="loc-iloc-and-at-selection-methods"><code class="docutils literal notranslate"><span class="pre">.loc</span></code>, .<code class="docutils literal notranslate"><span class="pre">iloc</span></code>, and <code class="docutils literal notranslate"><span class="pre">.at</span></code> Selection Methods</p>
<p><strong>Specialized Selection Methods:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Use Case</p></th>
<th class="head"><p>Performance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.loc[]</span></code></p></td>
<td><p>Label-based selection</p></td>
<td><p>Slicing, multi-label selection</p></td>
<td><p>Good for ranges</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></p></td>
<td><p>Position-based selection</p></td>
<td><p>Numerical indexing</p></td>
<td><p>Good for ranges</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.at[]</span></code></p></td>
<td><p>Single value by label</p></td>
<td><p>Fast scalar lookup</p></td>
<td><p>Fastest for single values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.iat[]</span></code></p></td>
<td><p>Single value by position</p></td>
<td><p>Fast scalar lookup</p></td>
<td><p>Fastest for single values</p></td>
</tr>
</tbody>
</table>
<p><strong>Comparing Selection Methods:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Department&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Management&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">75000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">,</span> <span class="mi">62000</span><span class="p">,</span> <span class="mi">95000</span><span class="p">,</span> <span class="mi">78000</span><span class="p">],</span>
    <span class="s1">&#39;Hire_Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2019-05-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-03-25&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-11-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-08-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-07-12&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Performance&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Using .loc for single value (by label)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1a. Bob&#39;s Department using .loc:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Department&#39;</span><span class="p">])</span>

<span class="c1"># 2. Using .iloc for single value (by position)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2a. Value at row 1, column 0 using .iloc:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># 3. Using .at for single value access (fastest)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Bob&#39;s Department using .at (fastest):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Department&#39;</span><span class="p">])</span>

<span class="c1"># 4. Using .iat for position-based single value access</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Value at row 1, column 0 using .iat (fastest):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># 5. Performance comparison for large DataFrame</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="c1"># Create a larger DataFrame</span>
<span class="n">large_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="c1"># Time comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Performance comparison:&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">large_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">loc_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loc time: </span><span class="si">{</span><span class="n">loc_time</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">large_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">at_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;at time: </span><span class="si">{</span><span class="n">at_time</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.at is approximately </span><span class="si">{</span><span class="n">loc_time</span><span class="o">/</span><span class="n">at_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x faster than .loc for single value access&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-3">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>While <code class="docutils literal notranslate"><span class="pre">.loc</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> are versatile, <code class="docutils literal notranslate"><span class="pre">.at</span></code> and <code class="docutils literal notranslate"><span class="pre">.iat</span></code> are optimized for single value lookup</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.at</span></code> and <code class="docutils literal notranslate"><span class="pre">.iat</span></code> when you need to access individual values repeatedly, such as in a loop.</p></li>
<li><p>The performance difference becomes significant with larger DataFrames</p></li>
<li><p>The general rule: Use the most specific tool for the job</p></li>
<li><p>For single value access: <code class="docutils literal notranslate"><span class="pre">.at</span></code>/<code class="docutils literal notranslate"><span class="pre">.iat</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">.loc</span></code>/<code class="docutils literal notranslate"><span class="pre">.iloc</span></code> &gt; direct indexing with <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p></li>
</ul>
</div>
</div>
<div class="docutils">
</div>
</section>
</section>
<span id="document-12.Handling_Missing_Data"></span><section id="handling-missing-data-in-pandas">
<h4>Handling Missing Data in Pandas<a class="headerlink" href="#handling-missing-data-in-pandas" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Identify missing values in DataFrames using <code class="docutils literal notranslate"><span class="pre">isna()</span></code> and methods.</p></li>
<li><p>Strategize the filling of missing values with <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> and interpolation methods tailored to scenario needs.</p></li>
<li><p>Demonstrate how to drop missing data with <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> and discuss various strategies for handling missing data.</p></li>
</ul>
</div>
<div class="admonition-time exercise important admonition" id="exercise-0">
<p class="admonition-title">Time</p>
<p>8 Minutes</p>
</div>
<ul class="simple">
<li><p>Missing data is ubiquitous in real-world datasets</p></li>
<li><p>Pandas represents missing values as <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number)</p></li>
<li><p>Proper handling of missing values is critical for accurate analysis</p></li>
<li><p>We’ll focus on the three most essential operations: detecting, filling, and dropping missing data</p></li>
</ul>
<section id="detecting-missing-values">
<h5>Detecting Missing Values<a class="headerlink" href="#detecting-missing-values" title="Link to this heading"></a></h5>
<section id="key-methods-for-finding-missing-data">
<h6>Key Methods for Finding Missing Data<a class="headerlink" href="#key-methods-for-finding-missing-data" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Returns</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isna()</span></code> / <code class="docutils literal notranslate"><span class="pre">isnull()</span></code></p></td>
<td><p>Boolean mask (True where missing)</p></td>
<td><p>Identify missing values</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">notna()</span></code> / <code class="docutils literal notranslate"><span class="pre">notnull()</span></code></p></td>
<td><p>Boolean mask (True where not missing)</p></td>
<td><p>Identify non-missing values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">isna().sum()</span></code></p></td>
<td><p>Count of missing values per column</p></td>
<td><p>Quantify missing data</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">isna().any()</span></code></p></td>
<td><p>Whether any value is missing per column</p></td>
<td><p>Quick presence check</p></td>
</tr>
</tbody>
</table>
<p><strong>Detecting Missing Values:</strong></p>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Detect missing values with <code class="docutils literal notranslate"><span class="pre">isna()</span></code></p></li>
<li><p>Count missing values per column</p></li>
<li><p>Count total missing values</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a DataFrame with different types of missing values</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>  <span class="c1"># None also represents missing value</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame with missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Detect missing values with isna()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Boolean mask of missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>  <span class="c1"># True where values are missing</span>

<span class="c1"># Count missing values per column</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Count of missing values per column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Count total missing values</span>
<span class="n">total_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Total missing values in DataFrame: </span><span class="si">{</span><span class="n">total_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Filter rows with any missing value</span>
<span class="n">rows_with_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rows_with_any_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rows_with_missing</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Rows with any missing value:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rows_with_any_missing</span><span class="p">)</span>

<span class="c1"># Filter rows with no missing values</span>
<span class="n">row_without_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">complete_rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_without_missing</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Rows with no missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">complete_rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Boolean mask of missing values:
       A      B      C      D      E
0  False  False  False   True  False
1  False   True  False   True  False
2   True  False  False   True   True
3  False  False   True   True  False
4  False   True  False   True  False
5  False  False  False  False  False

2. Count of missing values per column:
A    1
B    2
C    1
D    5
E    1
dtype: int64

3. Total missing values in DataFrame: 10

4. Rows with any missing value:
     A    B     C   D     E
0  1.0  6.0  10.0 NaN     a
1  2.0  NaN  11.0 NaN     b
2  NaN  8.0  12.0 NaN  None
3  4.0  9.0   NaN NaN     d
4  5.0  NaN  14.0 NaN     e

5. Rows with no missing values:
     A     B     C     D  E
5  8.0  15.0  20.0  15.0  h
</pre></div>
</div>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p>Check if <code class="docutils literal notranslate"><span class="pre">isna()</span></code> and <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> returns the same results?</p>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">==</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">isna()</span></code> can be thought as an alias for <code class="docutils literal notranslate"><span class="pre">isnull()</span></code></p></li>
<li><p>We can use <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> or <code class="docutils literal notranslate"><span class="pre">isna()</span></code> interchangeably</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Pandas provides a consistent interface for detecting missing values with <code class="docutils literal notranslate"><span class="pre">isna()</span></code> and <code class="docutils literal notranslate"><span class="pre">notna()</span></code>.</p></li>
<li><p>Notice that both <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code> are treated as missing values in Pandas.</p>
<ul>
<li><p>In Pandas, <code class="docutils literal notranslate"><span class="pre">None</span></code> values are treated as <code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></li>
</ul>
</li>
<li><p>Boolean masks generated by <code class="docutils literal notranslate"><span class="pre">isna()</span></code> can be used directly for filtering</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter controls whether operations are applied to rows or columns.</p></li>
</ul>
</div>
</section>
</section>
<section id="filling-missing-values">
<h5>Filling Missing Values<a class="headerlink" href="#filling-missing-values" title="Link to this heading"></a></h5>
<p><strong>Most Common Fill Strategies:</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Key Parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fillna(value)</span></code></p></td>
<td><p>Replace with specific value</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">inplace</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ffill()</span></code></p></td>
<td><p>Forward fill (use previous value)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bfill()</span></code></p></td>
<td><p>Backward fill (use next value)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<section id="basic-fill-methods">
<h6>Basic Fill Methods<a class="headerlink" href="#basic-fill-methods" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Fill all missing values with a single value <code class="docutils literal notranslate"><span class="pre">fillna(value)</span></code></p></li>
<li><p>Fill with different values for each column <code class="docutils literal notranslate"><span class="pre">fillna(dict)</span></code></p></li>
<li><p>Forward fill (propagate last valid observation forward)</p></li>
<li><p>Fill numeric columns with their means</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>  <span class="c1"># None also represents missing value</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Original DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Fill all missing values with a single value</span>
<span class="n">df_filled</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Fill all missing values with 0:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_filled</span><span class="p">)</span>

<span class="c1"># 2. Fill with different values for each column</span>
<span class="n">fill_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">999</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="s1">&#39;missing&#39;</span><span class="p">}</span>
<span class="n">df_custom_fill</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">fill_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Fill with custom values per column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_custom_fill</span><span class="p">)</span>

<span class="c1"># 3. Forward fill (propagate last valid observation forward)</span>
<span class="n">df_ffill</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Forward fill (ffill):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_ffill</span><span class="p">)</span>

<span class="c1"># 4. Fill numeric columns with their means</span>
<span class="n">df_mean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]:</span>
    <span class="n">df_mean</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df_mean</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Fill numeric columns with their means:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_mean</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
     A     B     C     D     E
0  1.0   6.0  10.0   NaN     a
1  2.0   NaN  11.0   NaN     b
2  NaN   8.0  12.0   NaN  None
3  4.0   9.0   NaN   NaN     d
4  5.0   NaN  14.0   NaN     e
5  8.0  15.0  20.0  15.0     h

1. Fill all missing values with 0:
     A     B     C     D  E
0  1.0   6.0  10.0   0.0  a
1  2.0   0.0  11.0   0.0  b
2  0.0   8.0  12.0   0.0  0
3  4.0   9.0   0.0   0.0  d
4  5.0   0.0  14.0   0.0  e
5  8.0  15.0  20.0  15.0  h

2. Fill with custom values per column:
     A     B      C     D        E
0  1.0   6.0   10.0   0.0        a
1  2.0  -1.0   11.0   0.0        b
2  0.0   8.0   12.0   0.0  missing
3  4.0   9.0  999.0   0.0        d
4  5.0  -1.0   14.0   0.0        e
5  8.0  15.0   20.0  15.0        h

3. Forward fill (ffill):
     A     B     C     D  E
0  1.0   6.0  10.0   NaN  a
1  2.0   6.0  11.0   NaN  b
2  2.0   8.0  12.0   NaN  b
3  4.0   9.0  12.0   NaN  d
4  5.0   9.0  14.0   NaN  e
5  8.0  15.0  20.0  15.0  h

4. Fill numeric columns with their means:
     A     B     C     D     E
0  1.0   6.0  10.0  15.0     a
1  2.0   9.5  11.0  15.0     b
2  4.0   8.0  12.0  15.0  None
3  4.0   9.0  13.4  15.0     d
4  5.0   9.5  14.0  15.0     e
5  8.0  15.0  20.0  15.0     h
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The choice of fill method should be based on the nature of your data and the analysis you’re conducting.</p></li>
<li><p>Forward fill and backward fill are especially useful for time series when you want to carry values forward or backward.</p></li>
<li><p>Statistical measures like mean, median, or mode are common choices for filling numeric data.</p></li>
<li><p>Remember that filling is modifying your data - it’s important to document your approach and consider its impact on analysis.</p></li>
<li><p>For categorical data, consider whether a missing value has meaning before deciding how to fill it.</p></li>
</ul>
</div>
</section>
</section>
<section id="dropping-missing-data">
<h5>Dropping Missing Data<a class="headerlink" href="#dropping-missing-data" title="Link to this heading"></a></h5>
<p><strong>Key Parameters for dropna():</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p></td>
<td><p>Specify rows or columns</p></td>
<td><p>0 for rows, 1 for columns</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p></td>
<td><p>Condition for dropping</p></td>
<td><p>‘any’ (default) or ‘all’</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">thresh</span></code></p></td>
<td><p>Minimum non-NaN values to keep</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">subset</span></code></p></td>
<td><p>Columns to consider</p></td>
<td><p>list of column names</p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<p><strong>Dropping Rows and Columns:</strong></p>
<ul class="simple">
<li><p>Drop rows with any missing values (any missing values)</p></li>
<li><p>Drop columns with any missing values</p></li>
<li><p>Drop columns where all values are missing</p></li>
<li><p>Keep rows with at least <code class="docutils literal notranslate"><span class="pre">n</span></code> non-NaN values</p></li>
<li><p>Drop rows with missing values in specific columns</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,]</span>  <span class="c1"># None also represents missing value</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Original DataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Drop rows with any missing values</span>
<span class="n">df_drop_rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. After dropping rows with any missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_drop_rows</span><span class="p">)</span>

<span class="c1"># 2. Drop columns with any missing values</span>
<span class="n">df_drop_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. After dropping columns with any missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_drop_cols</span><span class="p">)</span>

<span class="c1"># 3. Drop columns where all values are missing</span>
<span class="n">df_drop_all_na_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. After dropping columns where all values are missing:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_drop_all_na_cols</span><span class="p">)</span>

<span class="c1"># 4. Keep rows with at least 3 non-NaN values</span>
<span class="n">df_thresh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Keep rows with at least 3 non-NaN values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_thresh</span><span class="p">)</span>

<span class="c1"># 5. Drop rows with missing values in specific columns</span>
<span class="n">df_subset</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Drop rows with NaN in columns A or C:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_subset</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DataFrame:
     A    B     C   D     E
0  1.0  6.0  10.0 NaN     a
1  2.0  NaN  11.0 NaN     b
2  NaN  8.0  12.0 NaN  None
3  4.0  9.0   NaN NaN     d
4  5.0  NaN  14.0 NaN     e

2. After dropping columns with any missing values:
Empty DataFrame
Columns: []
Index: [0, 1, 2, 3, 4, 5]

3. After dropping columns where all values are missing:
     A    B     C     E
0  1.0  6.0  10.0     a
1  2.0  NaN  11.0     b
2  NaN  8.0  12.0  None
3  4.0  9.0   NaN     d
4  5.0  NaN  14.0     e

4. Keep rows with at least 3 non-NaN values:
     A    B     C   D  E
0  1.0  6.0  10.0 NaN  a
1  2.0  NaN  11.0 NaN  b
3  4.0  9.0   NaN NaN  d
4  5.0  NaN  14.0 NaN  e

5. Drop rows with NaN in columns A or C:
     A    B     C   D  E
0  1.0  6.0  10.0 NaN  a
1  2.0  NaN  11.0 NaN  b
4  5.0  NaN  14.0 NaN  e
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Dropping is the simplest strategy, but it can lead to data loss - use cautiously.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">how</span></code> parameter is critical - ‘any’ is much more restrictive than ‘all’.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter lets you keep rows with a minimum amount of data.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">subset</span></code> parameter allows targeted dropping based on specific columns.</p></li>
<li><p>Dropping is often appropriate when missing values are rare, or when you need a complete dataset for specific analyses.</p></li>
<li><p>Be aware of potential bias introduced by dropping - if missing data correlates with certain characteristics, dropping can skew results.</p></li>
</ul>
</div>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Always detect first:</strong> Understand the pattern and extent of missing values before taking action</p></li>
<li><p><strong>Choose the right strategy:</strong></p>
<ul class="simple">
<li><p>Fill when you can reasonably infer values or need to preserve data</p></li>
<li><p>Drop when missing data is minimal or would introduce bias if filled</p></li>
</ul>
</li>
<li><p><strong>Document your approach:</strong> Your handling choices affect analysis results</p></li>
</ol>
</div>
</section>
</section>
<span id="document-13.Merging_DataFrames"></span><section id="merging-dataframes-in-pandas">
<h4>Merging DataFrames in Pandas<a class="headerlink" href="#merging-dataframes-in-pandas" title="Link to this heading"></a></h4>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Illustrate how to concatenate DataFrames using <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> and understand its applications.</p></li>
<li><p>Explain database-style joins with the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function and illustrate the different join types (inner, outer, left, * right).</p></li>
</ul>
</div>
<div class="admonition-time exercise important admonition" id="exercise-0">
<p class="admonition-title">Time</p>
<p>8 Minutes</p>
</div>
<ul class="simple">
<li><p>In real-world data analysis, you rarely have all the data you need in a single file or table.</p></li>
<li><p>Combining data from multiple sources is a fundamental data wrangling skill.</p></li>
<li><p>Pandas gives us two main approaches: stacking data (concatenation) and joining data on common keys (merging)</p></li>
<li><p><strong>Concatenation</strong>: Stacking similar datasets (vertically or horizontally)</p></li>
<li><p><strong>Merging/Joining</strong>: Combining related datasets based on common keys</p></li>
</ul>
<section id="concatenation-with-pd-concat">
<h5>Concatenation with pd.concat()<a class="headerlink" href="#concatenation-with-pd-concat" title="Link to this heading"></a></h5>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Common Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">objs</span></code></p></td>
<td><p>List of DataFrames</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[df1,</span> <span class="pre">df2,</span> <span class="pre">...]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p></td>
<td><p>Direction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (vertical, default), <code class="docutils literal notranslate"><span class="pre">1</span></code> (horizontal)</p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Vertical concatenation (stacking)</p></li>
<li><p>Horizontal concatenation (side by side)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Create sample DataFrames</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">])</span>

<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="s1">&#39;C8&#39;</span><span class="p">],</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">,</span> <span class="s1">&#39;D8&#39;</span><span class="p">]</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;K6&#39;</span><span class="p">,</span> <span class="s1">&#39;K7&#39;</span><span class="p">,</span> <span class="s1">&#39;K8&#39;</span><span class="p">])</span>

<span class="c1"># Vertical concatenation (stacking)</span>
<span class="n">result1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Vertical concatenation (stacking)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result1</span><span class="p">)</span>

<span class="c1"># Horizontal concatenation (side by side)</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Horizontal concatenation (side by side)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result2</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Vertical concatenation (stacking)
     A   B
K0  A0  B0
K1  A1  B1
K2  A2  B2
K3  A3  B3
K4  A4  B4
K5  A5  B5
2. Horizontal concatenation (side by side)
      A    B    C    D
K0   A0   B0  NaN  NaN
K1   A1   B1  NaN  NaN
K2   A2   B2  NaN  NaN
K6  NaN  NaN   C6   D6
K7  NaN  NaN   C7   D7
K8  NaN  NaN   C8   D8
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Concatenation is like stacking datasets either vertically (axis=0) or horizontally (axis=1).</p></li>
<li><p>Vertical concatenation is useful when you have data from different dataframes in the same format.</p></li>
<li><p>Horizontal concatenation is useful when you have different features for the same observations</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> when original indices aren’t meaningful after combining</p>
<ul>
<li><p>e.g., <code class="docutils literal notranslate"><span class="pre">pd.concat([df1,</span> <span class="pre">df2],</span> <span class="pre">ignore_index=True)</span></code></p></li>
</ul>
</li>
</ul>
</div>
</div>
</section>
<section id="database-style-joins-with-merge">
<h5>Database-Style Joins with merge()<a class="headerlink" href="#database-style-joins-with-merge" title="Link to this heading"></a></h5>
<section id="key-parameters-for-pd-merge">
<h6>Key Parameters for pd.merge()<a class="headerlink" href="#key-parameters-for-pd-merge" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Common Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code></p></td>
<td><p>DataFrames to merge</p></td>
<td><p>DataFrame objects</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p></td>
<td><p>Type of join</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'inner'</span></code> (default), <code class="docutils literal notranslate"><span class="pre">'outer'</span></code>, <code class="docutils literal notranslate"><span class="pre">'left'</span></code>, <code class="docutils literal notranslate"><span class="pre">'right'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">on</span></code></p></td>
<td><p>Column(s) to join on</p></td>
<td><p>Column name or list of names</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code>, <code class="docutils literal notranslate"><span class="pre">right_on</span></code></p></td>
<td><p>Column(s) when names differ</p></td>
<td><p>Column name(s) for each DataFrame</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">suffixes</span></code></p></td>
<td><p>For duplicate columns</p></td>
<td><p>Tuple of strings, default <code class="docutils literal notranslate"><span class="pre">('_x',</span> <span class="pre">'_y')</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="basic-merge-examples">
<h6>Basic Merge Examples<a class="headerlink" href="#basic-merge-examples" title="Link to this heading"></a></h6>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Inner join (default) - only matching rows (intersect)</p></li>
<li><p>Left join - keep all rows from left DataFrame</p></li>
<li><p>Right join - keep all rows from right DataFrame</p></li>
<li><p>Outer join - keep all rows from both DataFrames (union)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create sample DataFrames for merging</span>
<span class="n">employees</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;employee_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eva&#39;</span><span class="p">],</span>
    <span class="s1">&#39;department_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">102</span><span class="p">]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original dataframe&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">employees</span><span class="p">)</span>

<span class="n">departments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;department_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">],</span>
    <span class="s1">&#39;department_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;Finance&#39;</span><span class="p">,</span> <span class="s1">&#39;Marketing&#39;</span><span class="p">],</span>
    <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;San Francisco&#39;</span><span class="p">,</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="s1">&#39;Boston&#39;</span><span class="p">]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original dataframe&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">departments</span><span class="p">)</span>

<span class="c1"># Inner join (default) - only matching rows</span>
<span class="n">inner_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">departments</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;department_id&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Inner join (default) - only matching rows&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inner_merge</span><span class="p">)</span>

<span class="c1"># Left join - keep all rows from left DataFrame</span>
<span class="n">left_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">departments</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;department_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Left join - keep all rows from left DataFrame&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left_merge</span><span class="p">)</span>

<span class="c1"># Right join - keep all rows from right DataFrame</span>
<span class="n">right_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">departments</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;department_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Right join - keep all rows from right DataFrame&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">right_merge</span><span class="p">)</span>

<span class="c1"># Outer join - keep all rows from both DataFrames</span>
<span class="n">outer_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">departments</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;department_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Outer join - keep all rows from both DataFrames&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outer_merge</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original dataframe
   employee_id     name  department_id
0            1    Alice            101
1            2      Bob            102
2            3  Charlie            101
3            4    David            103
4            5      Eva            102

Original dataframe
   department_id department_name       location
0            101              HR       New York
1            102     Engineering  San Francisco
2            103         Finance        Chicago
3            104       Marketing         Boston

1. Inner join (default) - only matching rows
   employee_id     name  department_id department_name       location
0            1    Alice            101              HR       New York
1            3  Charlie            101              HR       New York
2            2      Bob            102     Engineering  San Francisco
3            5      Eva            102     Engineering  San Francisco
4            4    David            103         Finance        Chicago

2. Left join - keep all rows from left DataFrame
   employee_id     name  department_id department_name       location
0            1    Alice            101              HR       New York
1            2      Bob            102     Engineering  San Francisco
2            3  Charlie            101              HR       New York
3            4    David            103         Finance        Chicago
4            5      Eva            102     Engineering  San Francisco

3. Right join - keep all rows from right DataFrame
   employee_id     name  department_id department_name       location
0          1.0    Alice            101              HR       New York
1          3.0  Charlie            101              HR       New York
2          2.0      Bob            102     Engineering  San Francisco
3          5.0      Eva            102     Engineering  San Francisco
4          4.0    David            103         Finance        Chicago
5          NaN      NaN            104       Marketing         Boston

4. Outer join - keep all rows from both DataFrames
   employee_id     name  department_id department_name       location
0          1.0    Alice            101              HR       New York
1          3.0  Charlie            101              HR       New York
2          2.0      Bob            102     Engineering  San Francisco
3          5.0      Eva            102     Engineering  San Francisco
4          4.0    David            103         Finance        Chicago
5          NaN      NaN            104       Marketing         Boston
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">merge()</span></code> function is modeled after SQL joins and is used to combine DataFrames based on common columns or indices.</p></li>
<li><p>The ‘how’ parameter determines which rows to keep: ‘inner’ (matching rows only), ‘left’ (all left rows), ‘right’ (all right rows), or ‘outer’ (all rows).</p></li>
<li><p>You can merge on multiple columns by passing lists to ‘on’, ‘left_on’, or ‘right_on’.</p></li>
<li><p>When merging on indices instead of columns, use ‘left_index=True’ and/or ‘right_index=True’.</p></li>
<li><p>Merging is a powerful way to enrich your dataset with additional information from other sources.</p></li>
</ul>
</div>
</section>
</section>
<section id="handling-duplicate-columns">
<h5>3. Handling Duplicate Columns<a class="headerlink" href="#handling-duplicate-columns" title="Link to this heading"></a></h5>
<p>When merging DataFrames with overlapping column names, you need to handle duplicates:</p>
<ul class="simple">
<li><p>Default behavior adds <code class="docutils literal notranslate"><span class="pre">_x</span></code> and <code class="docutils literal notranslate"><span class="pre">_y</span></code> suffixes or</p></li>
<li><p>Add custom suffixes</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># DataFrames with overlapping column names</span>
<span class="n">df_a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">df_b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">],</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">],</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Default behavior adds _x and _y suffixes</span>
<span class="n">merged_default</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Default behavior adds _x and _y suffixes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_default</span><span class="p">)</span>

<span class="c1"># Custom suffixes</span>
<span class="n">merged_custom</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Custom suffixes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_custom</span><span class="p">)</span>

</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Default behavior adds _x and _y suffixes
  key   A B_x B_y   C
0  K0  A0  B0  B3  C3
1  K2  A2  B2  B4  C4

2. Custom suffixes
  key   A B_left B_right   C
0  K0  A0     B0      B3  C3
1  K2  A2     B2      B4  C4
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>When merging DataFrames with duplicate column names, Pandas adds suffixes to make them unique.</p></li>
<li><p>You can customize these suffixes to make the result more readable.</p></li>
<li><p>Another approach is to select only the columns you need, either before or after merging</p></li>
<li><p>Duplicate indices can cause unexpected behavior, especially with joins.</p>
<ul>
<li><p>Be careful with duplicate values in join keys - each duplicate in one DataFrame will join with all matches in the other DataFrame, potentially creating many rows.</p></li>
</ul>
</li>
<li><p>Always inspect the result after merging, especially checking the row count to ensure it matches expectations.</p></li>
</ul>
</div>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Concatenation vs. Merging:</strong></p>
<ul class="simple">
<li><p>Use concatenation for stacking similar data</p></li>
<li><p>Use merging for combining related data on keys</p></li>
</ul>
</li>
<li><p><strong>Join Types:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inner</span></code>: Keep only matching data (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outer</span></code>: Keep everything</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code>/<code class="docutils literal notranslate"><span class="pre">right</span></code>: Keep all rows from one DataFrame</p></li>
</ul>
</li>
<li><p><strong>Best Practices:</strong></p>
<ul class="simple">
<li><p>Clean join keys before merging</p></li>
<li><p>Handle duplicate columns with suffixes or column selection</p></li>
<li><p>Always verify the shape of the result</p></li>
</ul>
</li>
</ol>
</div>
</section>
</section>
<span id="document-14.Pandas_summary_stats"></span><section id="summary-statistics-aggregations-in-pandas">
<h4>Summary Statistics &amp; Aggregations in Pandas<a class="headerlink" href="#summary-statistics-aggregations-in-pandas" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Data collection and cleaning are just the beginning</p></li>
<li><p>The real value comes from extracting meaningful insights</p></li>
<li><p>Summary statistics reduce complex data into understandable metrics</p></li>
<li><p>Aggregations allow us to analyze data at different levels of granularity</p></li>
<li><p>These operations form the foundation of data analysis</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>We’ve learned how to load, clean, and combine data in Pandas. Now we’ll explore how to extract insights from that data.</p></li>
<li><p>Summary statistics and aggregations are how we transform raw data into actionable information.</p></li>
<li><p>These techniques allow us to answer questions like ‘What’s the average customer spending?’ or ‘How do sales compare across different regions?’”</p></li>
<li><p>The methods connect directly to statistical concepts but are implemented with Pandas’ intuitive syntax.</p></li>
</ul>
</div>
<section id="basic-descriptive-statistics">
<h5>Basic Descriptive Statistics<a class="headerlink" href="#basic-descriptive-statistics" title="Link to this heading"></a></h5>
<section id="built-in-statistical-methods">
<h6>Built-in Statistical Methods<a class="headerlink" href="#built-in-statistical-methods" title="Link to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Returns</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">describe()</span></code></p></td>
<td><p>Comprehensive summary</p></td>
<td><p>DataFrame with count, mean, std, min, quartiles, max</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">median()</span></code></p></td>
<td><p>Central tendency</p></td>
<td><p>Series or scalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">min()</span></code>, <code class="docutils literal notranslate"><span class="pre">max()</span></code></p></td>
<td><p>Range boundaries</p></td>
<td><p>Series or scalar</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">std()</span></code>, <code class="docutils literal notranslate"><span class="pre">var()</span></code></p></td>
<td><p>Dispersion/spread</p></td>
<td><p>Series or scalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quantile([0.25,</span> <span class="pre">0.75])</span></code></p></td>
<td><p>Distribution points</p></td>
<td><p>Series or DataFrame</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></td>
<td><p>Non-null count</p></td>
<td><p>Series or scalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code></p></td>
<td><p>Sum of values</p></td>
<td><p>Series or scalar</p></td>
</tr>
</tbody>
</table>
<p><strong>Basic Statistical Methods:</strong></p>
<div class="admonition-demo demo admonition" id="demo-0">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Comprehensive statistical summary</p></li>
<li><p>Include all columns (even non-numeric)</p></li>
<li><p>Basic statistical methods</p>
<ul>
<li><p>Mean, Median, Minimum, Maximum, Standard deviation</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a sample gene expression DataFrame</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="c1"># Generate 15 sample genes</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gene_ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;GENE</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)],</span>
    <span class="s1">&#39;Expression_Level&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Log-normal for expression values</span>
    <span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Normal distribution for log2 fold changes</span>
    <span class="s1">&#39;P_Value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>  <span class="c1"># Beta distribution for p-values</span>
    <span class="s1">&#39;Tissue_Type&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;Brain&#39;</span><span class="p">,</span> <span class="s1">&#39;Liver&#39;</span><span class="p">,</span> <span class="s1">&#39;Kidney&#39;</span><span class="p">,</span> <span class="s1">&#39;Heart&#39;</span><span class="p">,</span> <span class="s1">&#39;Lung&#39;</span><span class="p">],</span> <span class="mi">15</span><span class="p">),</span>
    <span class="s1">&#39;Chromosome&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;chr2&#39;</span><span class="p">,</span> <span class="s1">&#39;chr3&#39;</span><span class="p">,</span> <span class="s1">&#39;chr4&#39;</span><span class="p">,</span> <span class="s1">&#39;chrX&#39;</span><span class="p">,</span> <span class="s1">&#39;chrY&#39;</span><span class="p">],</span> <span class="mi">15</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Add some missing values for realism</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;P_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Add a column for significance based on P_Value and Log2_Fold_Change</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Is_Significant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;P_Value&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample Gene Expression DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Comprehensive statistical summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Comprehensive statistical summary with describe():&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># 2. Include all columns (even non-numeric)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Describing all columns (including non-numeric):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>

<span class="c1"># 3. Basic statistical methods</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Basic statistical methods:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean expression level: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median log2 fold change: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum p-value: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;P_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of significant genes: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Is_Significant&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation of expression: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 4. Multiple statistics at once</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Multiple statistics for Expression Level:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]))</span>

<span class="c1"># 5. Quantiles/percentiles</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Expression level quartiles:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Sample Gene Expression DataFrame:
    Gene_ID  Expression_Level  Log2_Fold_Change  P_Value Tissue_Type Chromosome  Is_Significant
0   GENE001             89.72             -1.12   0.1445        Lung       chr4           False
1   GENE002             47.55             -2.03   0.0038      Kidney       chrY            True
2   GENE003            104.34              0.63   0.0458       Brain       chrX           False
3   GENE004            250.39             -1.82   0.0555        Lung       chrX           False
4   GENE005             43.20             -2.82      NaN       Liver       chr3           False
5   GENE006             43.20              2.93   0.0073      Kidney       chrX            True
6   GENE007            264.86             -0.45   0.0067       Brain       chr4           False
7   GENE008            117.62              0.14   0.2418       Liver       chrX           False
8   GENE009             34.14             -2.85   0.0479       Liver       chr3            True
9   GENE010             93.93               NaN   0.0076       Heart       chr3           False
10  GENE011             34.35              0.22   0.1132        Lung       chrY           False
11  GENE012             34.27             -2.30   0.1041      Kidney       chr4           False
12  GENE013             69.54              0.75   0.0723       Brain       chr2           False
13  GENE014              8.06             -1.20   0.0268       Heart       chr2            True
14  GENE015              9.73             -0.58   0.0947        Lung       chrX           False

2. Describing all columns (including non-numeric):
        Gene_ID  Expression_Level  Log2_Fold_Change    P_Value Tissue_Type Chromosome Is_Significant
count        15         15.000000         14.000000  14.000000          15         15             15
unique       15               NaN               NaN        NaN           5          5              2
top     GENE001               NaN               NaN        NaN        Lung       chrX          False
freq          1               NaN               NaN        NaN           4          5             11
mean        NaN         82.993333         -0.750000   0.069429         NaN        NaN            NaN
std         NaN         78.207700          1.611707   0.066835         NaN        NaN            NaN
min         NaN          8.060000         -2.850000   0.003800         NaN        NaN            NaN
25%         NaN         34.310000         -1.977500   0.012400         NaN        NaN            NaN
50%         NaN         47.550000         -0.850000   0.051700         NaN        NaN            NaN
75%         NaN         99.135000          0.200000   0.101750         NaN        NaN            NaN
max         NaN        264.860000          2.930000   0.241800         NaN        NaN            NaN

3. Basic statistical methods:
Mean expression level: 82.99
Median log2 fold change: -0.85
Minimum p-value: 0.0038
Number of significant genes: 4
Standard deviation of expression: 78.21

4. Multiple statistics for Expression Level:
min         8.060000
max       264.860000
mean       82.993333
median     47.550000
std        78.207700
Name: Expression_Level, dtype: float64

5. Expression level quartiles:
0.00      8.060
0.25     34.310
0.50     47.550
0.75     99.135
1.00    264.860
Name: Expression_Level, dtype: float64
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method gives you a quick overview of your data’s distribution.</p></li>
<li><p>Notice how Pandas handles missing values in statistical calculations - they’re automatically excluded.</p></li>
<li><p>These methods work column-wise by default, which makes sense for most statistical analyses.</p></li>
<li><p>You can compute multiple statistics at once with the <code class="docutils literal notranslate"><span class="pre">agg()</span></code> method, which we’ll explore further.</p></li>
<li><p>Statistical methods can be combined with grouping to compare metrics across categories.</p></li>
<li><p>Remember that these methods only make sense for numerical data - Pandas will ignore or handle non-numeric data differently.</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise</p>
<p><strong>Basic Statistics:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">students</span></code> database and</p>
<ul>
<li><p>Generate a comprehensive statistical summary of all numeric columns</p></li>
<li><p>Calculate the average score for each subject</p></li>
<li><p>Find the highest and lowest scoring student in each subject</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataset of student scores</span>
<span class="n">student_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Student_ID&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="s1">&#39;Science&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">89</span><span class="p">],</span>
    <span class="s1">&#39;English&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
    <span class="s1">&#39;Class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">student_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tasks:</span>
<span class="c1"># 1. Generate a comprehensive statistical summary of all numeric columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Statistical summary of student scores:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">students</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># 2. Calculate the average score for each subject</span>
<span class="n">subject_means</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Average scores by subject:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subject_means</span><span class="p">)</span>

<span class="c1"># 3. Find the highest and lowest scoring student in each subject</span>
<span class="n">highest_math</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;Math&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
<span class="n">lowest_english</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">students</span><span class="p">[</span><span class="s1">&#39;English&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Highest scoring student in Math:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">highest_math</span><span class="p">[[</span><span class="s1">&#39;Student_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Class&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Lowest scoring student in English:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lowest_english</span><span class="p">[[</span><span class="s1">&#39;Student_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span> <span class="s1">&#39;Class&#39;</span><span class="p">]])</span>

<span class="c1"># # 4. Compare average scores between classes</span>
<span class="c1"># class_comparison = students.groupby(&#39;Class&#39;)[[&#39;Math&#39;, &#39;Science&#39;, &#39;English&#39;]].mean()</span>
<span class="c1"># print(&quot;\n4. Average scores by class:&quot;)</span>
<span class="c1"># print(class_comparison)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="custom-aggregation-functions">
<h5>Custom Aggregation Functions<a class="headerlink" href="#custom-aggregation-functions" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Custom aggregation functions help perform beyond Built-in Statistics</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Approach</p></th>
<th class="head"><p>Use Case</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Built-in aggregations</p></td>
<td><p>Common statistics</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.agg(['mean',</span> <span class="pre">'median'])</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Lambda functions</p></td>
<td><p>Simple custom calculations</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.agg(lambda</span> <span class="pre">x:</span> <span class="pre">x.max()</span> <span class="pre">-</span> <span class="pre">x.min())</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Named functions</p></td>
<td><p>Complex custom calculations</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.agg(custom_function)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Dictionary approach</p></td>
<td><p>Different aggs per column</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.agg({'A':</span> <span class="pre">'sum',</span> <span class="pre">'B':</span> <span class="pre">'mean'})</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Multiple aggregations</p></td>
<td><p>Comprehensive analysis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.agg(['count',</span> <span class="pre">'mean',</span> <span class="pre">custom_func])</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition-demo demo admonition" id="demo-1">
<p class="admonition-title">Demo</p>
<ul class="simple">
<li><p>Simple custom aggregation with lambda</p></li>
<li><p>Define a custom function and use <code class="docutils literal notranslate"><span class="pre">agg</span></code></p></li>
<li><p>Different aggregations for different columns</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Create a sample gene expression DataFrame</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="c1"># Generate 15 sample genes</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gene_ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;GENE</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)],</span>
    <span class="s1">&#39;Expression_Level&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Log-normal for expression values</span>
    <span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Normal distribution for log2 fold changes</span>
    <span class="s1">&#39;P_Value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>  <span class="c1"># Beta distribution for p-values</span>
    <span class="s1">&#39;Tissue_Type&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;Brain&#39;</span><span class="p">,</span> <span class="s1">&#39;Liver&#39;</span><span class="p">,</span> <span class="s1">&#39;Kidney&#39;</span><span class="p">,</span> <span class="s1">&#39;Heart&#39;</span><span class="p">,</span> <span class="s1">&#39;Lung&#39;</span><span class="p">],</span> <span class="mi">15</span><span class="p">),</span>
    <span class="s1">&#39;Chromosome&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;chr1&#39;</span><span class="p">,</span> <span class="s1">&#39;chr2&#39;</span><span class="p">,</span> <span class="s1">&#39;chr3&#39;</span><span class="p">,</span> <span class="s1">&#39;chr4&#39;</span><span class="p">,</span> <span class="s1">&#39;chrX&#39;</span><span class="p">,</span> <span class="s1">&#39;chrY&#39;</span><span class="p">],</span> <span class="mi">15</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original dataframe&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># 1. Simple custom aggregation with lambda</span>
<span class="n">range_calc</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Expression Level range using lambda function:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">range_calc</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 2. Define a custom function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">range_ratio</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the ratio of max to min value&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Expression Level max/min ratio using custom function:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Expression_Level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">range_ratio</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. Different aggregations for different columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Different aggregations per column:&quot;</span><span class="p">)</span>
<span class="n">mixed_aggs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Expression_Level&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">],</span>
    <span class="s1">&#39;P_Value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Is_Significant&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mixed_aggs</span><span class="p">)</span>

<span class="c1"># 4. Genomics-specific custom aggregation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">differential_expression_score</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate a custom score based on fold change magnitude and significance&quot;&quot;&quot;</span>
    <span class="c1"># Higher absolute fold change and lower p-values yield higher scores</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;P_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Custom differential expression score:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Log2_Fold_Change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">differential_expression_score</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Expression Level range using lambda function:
256.80

2. Expression Level max/min ratio using custom function:
32.86

3. Different aggregations per column:
        Expression_Level  Log2_Fold_Change   P_Value  Is_Significant
min             8.060000               NaN  0.003800             NaN
max           264.860000               NaN       NaN             NaN
mean           82.993333               NaN  0.069429             NaN
median               NaN         -0.850000       NaN             NaN
std                  NaN          1.611707       NaN             NaN
sum                  NaN               NaN       NaN             4.0

4. Custom differential expression score:
1.64
</pre></div>
</div>
</div>
<section id="custom-aggregations-with-groupby">
<h6>Custom Aggregations with GroupBy<a class="headerlink" href="#custom-aggregations-with-groupby" title="Link to this heading"></a></h6>
<div class="admonition-additional-notes instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Additional notes</p>
<p><strong>Basic GroupBy Concept:</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> function allows us to split data into groups based on some criteria, apply a function to each group independently, and combine the results. Think of it as a “split-apply-combine” strategy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a genetic dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">genetic_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Gene&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BRCA1&#39;</span><span class="p">,</span> <span class="s1">&#39;TP53&#39;</span><span class="p">,</span> <span class="s1">&#39;APOE&#39;</span><span class="p">,</span> <span class="s1">&#39;PTEN&#39;</span><span class="p">,</span> <span class="s1">&#39;BRAF&#39;</span><span class="p">,</span> <span class="s1">&#39;KRAS&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;BRCA2&#39;</span><span class="p">,</span> <span class="s1">&#39;EGFR&#39;</span><span class="p">,</span> <span class="s1">&#39;TNF&#39;</span><span class="p">,</span> <span class="s1">&#39;IL6&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Chromosome&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr17&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr19&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr10&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr12&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;Chr13&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr6&#39;</span><span class="p">,</span> <span class="s1">&#39;Chr7&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Study&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Study1&#39;</span><span class="p">,</span> <span class="s1">&#39;Study2&#39;</span><span class="p">,</span> <span class="s1">&#39;Study3&#39;</span><span class="p">,</span> <span class="s1">&#39;Study1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0050</span><span class="p">,</span> <span class="mf">0.0200</span><span class="p">,</span> <span class="mf">0.0150</span><span class="p">,</span> <span class="mf">0.0300</span><span class="p">,</span> <span class="mf">0.0400</span><span class="p">,</span> 
              <span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.0250</span><span class="p">,</span> <span class="mf">0.0100</span><span class="p">,</span> <span class="mf">0.0450</span><span class="p">],</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">genetic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">genetic_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Genetic DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genetic_df</span><span class="p">)</span>

<span class="c1"># Group by Chromosome</span>
<span class="n">chromosome_groups</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">)</span>

<span class="c1"># View the groups</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available groups:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chromosome_groups</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

<span class="c1"># Access a specific group</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Genes on Chr17:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chromosome_groups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Chr17&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Genetic DataFrame:
    Gene Chromosome   Study  PValue  EffectSize
0  BRCA1      Chr17  Study1  0.0001         2.5
1   TP53      Chr17  Study2  0.0050         1.8
2   APOE      Chr19  Study1  0.0200         3.2
3   PTEN      Chr10  Study3  0.0150         2.1
4   BRAF       Chr7  Study2  0.0300         1.5
5   KRAS      Chr12  Study3  0.0400         1.2
6  BRCA2      Chr13  Study1  0.0005         2.7
7   EGFR       Chr7  Study2  0.0250         1.9
8    TNF       Chr6  Study3  0.0100         2.3
9    IL6       Chr7  Study1  0.0450         1.1
Available groups:
[&#39;Chr10&#39;, &#39;Chr12&#39;, &#39;Chr13&#39;, &#39;Chr17&#39;, &#39;Chr19&#39;, &#39;Chr6&#39;, &#39;Chr7&#39;]

Genes on Chr17:
    Gene Chromosome   Study  PValue  EffectSize
0  BRCA1      Chr17  Study1  0.0001         2.5
1   TP53      Chr17  Study2  0.0050         1.8
</pre></div>
</div>
</div>
<div class="admonition-demo demo admonition" id="demo-2">
<p class="admonition-title">Demo</p>
<p><strong>Aggregations - The Core of GroupBy:</strong></p>
<p>After grouping, we typically want to perform calculations on each group.</p>
<p class="rubric" id="basic-aggregation-functions">Basic Aggregation Functions</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean effect size and p-value for each chromosome</span>
<span class="n">chromosome_stats</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean statistics by chromosome:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chromosome_stats</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Mean statistics by chromosome:
              PValue  EffectSize
Chromosome
Chr10       0.015000        2.10
Chr12       0.040000        1.20
Chr13       0.000500        2.70
Chr17       0.002550        2.15
Chr19       0.020000        3.20
Chr6        0.010000        2.30
Chr7        0.033333        1.50
</pre></div>
</div>
<p><strong>Multiple Aggregations:</strong></p>
<p>We can apply multiple functions to each column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply multiple aggregations</span>
<span class="n">multi_agg</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Study&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple aggregations by study:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_agg</span><span class="p">)</span><span class="n">multi_agg</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Study&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple aggregations by study:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_agg</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Multiple aggregations by study:
        PValue                  EffectSize
           min    max      mean        min  max      mean       std
Study
Study1  0.0001  0.045  0.016400        1.1  3.2  2.375000  0.899537
Study2  0.0050  0.030  0.020000        1.5  1.9  1.733333  0.208167
Study3  0.0100  0.040  0.021667        1.2  2.3  1.866667  0.585947
</pre></div>
</div>
<p><strong>Custom Aggregation Functions:</strong></p>
<p>Sometimes built-in functions aren’t enough. Let’s create a custom function to calculate the coefficient of variation (CV):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom function for coefficient of variation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cv</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c1"># Apply our custom function</span>
<span class="n">custom_agg</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cv</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom aggregation by chromosome:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">custom_agg</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Custom aggregation by chromosome:
           EffectSize
                   cv count
Chromosome
Chr10             NaN     1
Chr12             NaN     1
Chr13             NaN     1
Chr17        0.230221     2
Chr19             NaN     1
Chr6              NaN     1
Chr7         0.266667     3
</pre></div>
</div>
<p><strong>Grouping by Multiple Columns:</strong></p>
<p>We can create hierarchical groups using multiple columns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by both Chromosome and Study</span>
<span class="n">multi_group</span> <span class="o">=</span> <span class="n">genetic_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Chromosome&#39;</span><span class="p">,</span> <span class="s1">&#39;Study&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;PValue&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EffectSize&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Grouping by multiple columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_group</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Grouping by multiple columns:
                   PValue  EffectSize
Chromosome Study
Chr10      Study3  0.0150         2.1
Chr12      Study3  0.0400         1.2
Chr13      Study1  0.0005         2.7
Chr17      Study1  0.0001         2.5
           Study2  0.0050         1.8
Chr19      Study1  0.0200         3.2
Chr6       Study3  0.0100         2.3
Chr7       Study1  0.0450         1.1
           Study2  0.0275         1.7
</pre></div>
</div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Built-in aggregations cover many common needs, but custom functions let you calculate any metric you can imagine.</p></li>
<li><p>Lambda functions are perfect for simple calculations that don’t need to be reused.</p></li>
<li><p>Named functions are better for complex calculations or ones you’ll reuse multiple times.</p></li>
<li><p>The dictionary approach gives you fine-grained control over which aggregations to apply to each column.</p></li>
<li><p>Custom aggregations really shine when combined with grouping operations.</p></li>
<li><p>Note how the result has a hierarchical index - flattening these can make the results more manageable.</p></li>
<li><p>These techniques are powerful because they let you create domain-specific metrics tailored to your analysis needs.</p></li>
</ul>
</div>
<div class="admonition-exercise exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise</p>
<p><strong>Custom Aggregations:</strong></p>
<p>Use <code class="docutils literal notranslate"><span class="pre">students</span></code> dataframe and execute:</p>
<ul class="simple">
<li><p>Calculate the range (max - min) for each subject</p></li>
<li><p>Define and apply a custom function to calculate the proportion of students scoring above 85</p>
<ul>
<li><p>Define a new function called <code class="docutils literal notranslate"><span class="pre">high_achievers</span></code> that takes in one parameter called <code class="docutils literal notranslate"><span class="pre">scores</span></code>. The <code class="docutils literal notranslate"><span class="pre">scores</span></code> parameter will be a series of scores for a particular subject</p></li>
<li><p>Perform a Boolean Comparison - compare each score in the scores series to 85. This will result in a Boolean mask</p></li>
<li><p>call <code class="docutils literal notranslate"><span class="pre">.mean()</span></code> on the Boolean series (average of the numerical representation of <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code>) and calculate the percentage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agg()</span></code> applying <code class="docutils literal notranslate"><span class="pre">high_achievers</span></code> function</p></li>
</ul>
</li>
<li><p>Calculate multiple statistics (‘mean’, ‘max’, high_achievers) by class</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">student_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Student_ID&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="s1">&#39;Science&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">89</span><span class="p">],</span>
    <span class="s1">&#39;English&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">93</span><span class="p">],</span>
    <span class="s1">&#39;Class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">student_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Student DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">students</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tasks:</span>
<span class="c1"># 1. Calculate the range (max - min) for each subject</span>
<span class="n">score_ranges</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="s1">&#39;Science&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="s1">&#39;English&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Score range for each subject:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">score_ranges</span><span class="p">)</span>

<span class="c1"># 2. Define and apply a custom function to calculate the proportion of students scoring above 85</span>
<span class="k">def</span><span class="w"> </span><span class="nf">high_achievers</span><span class="p">(</span><span class="n">scores</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">scores</span> <span class="o">&gt;</span> <span class="mi">85</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># Percentage of scores above 85</span>

<span class="n">high_performers</span> <span class="o">=</span> <span class="n">students</span><span class="p">[[</span><span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;Science&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">high_achievers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Percentage of high achievers (&gt;85) in each subject:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_performers</span><span class="p">)</span>

<span class="c1"># 3. Calculate multiple statistics by class</span>
<span class="n">class_stats</span> <span class="o">=</span> <span class="n">students</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">high_achievers</span><span class="p">],</span>
    <span class="s1">&#39;Science&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">high_achievers</span><span class="p">],</span>
    <span class="s1">&#39;English&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">high_achievers</span><span class="p">]</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Multiple statistics by class:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="key-takeaways">
<h5>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h5>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ol class="arabic simple">
<li><p><strong>Descriptive Statistics:</strong> Pandas provides comprehensive methods for calculating summary statistics on your data</p></li>
<li><p><strong>Custom Aggregations:</strong> When built-in statistics aren’t enough, you can create custom aggregation functions</p></li>
<li><p><strong>GroupBy Power:</strong> The split-apply-combine pattern enables sophisticated analyses across subsets of your data</p></li>
<li><p><strong>Multiple Dimensions:</strong> You can group by multiple columns to create hierarchical analyses</p></li>
<li><p><strong>Reshaping Results:</strong> Tools like unstack() and pivot_table() help transform grouped results into useful formats</p></li>
</ol>
</div>
</section>
<section id="homework">
<h5>Homework<a class="headerlink" href="#homework" title="Link to this heading"></a></h5>
<div class="admonition-homework homework important admonition" id="homework-0">
<p class="admonition-title">Homework</p>
<p class="rubric" id="groupby-operations-and-the-split-apply-combine-pattern-7-minutes">GroupBy Operations and the Split-Apply-Combine Pattern (7 minutes)</p>
<p><strong>The Split-Apply-Combine Workflow:</strong></p>
<p>Split-Apply-Combine Pattern</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Phase</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Pandas Implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Split</p></td>
<td><p>Divide data into groups</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df.groupby('column')</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Apply</p></td>
<td><p>Perform operation on each group</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">.agg()</span></code>, etc.</p></td>
</tr>
<tr class="row-even"><td><p>Combine</p></td>
<td><p>Bring results back together</p></td>
<td><p>Automatic in Pandas</p></td>
</tr>
</tbody>
</table>
<p><strong>Basic GroupBy Operations:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a more comprehensive dataset</span>
<span class="n">retail_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Product&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;Laptop&#39;</span><span class="p">,</span> <span class="s1">&#39;Phone&#39;</span><span class="p">,</span> <span class="s1">&#39;Tablet&#39;</span><span class="p">,</span> <span class="s1">&#39;Monitor&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;Electronics&#39;</span><span class="p">,</span> <span class="s1">&#39;Accessories&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Store&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">,</span> <span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="s1">&#39;West&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Units&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Unit_Price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;Discount&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="mi">20</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">sales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">retail_data</span><span class="p">)</span>
<span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Revenue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Discount&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retail Sales DataFrame:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sales</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># 1. Basic groupby with single column</span>
<span class="n">product_sales</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Total units sold by product:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_sales</span><span class="p">)</span>

<span class="c1"># 2. Groupby with multiple aggregations</span>
<span class="n">product_summary</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;Units&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Discount&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Product sales summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">product_summary</span><span class="p">)</span>

<span class="c1"># 3. Groupby with multiple columns</span>
<span class="n">store_product</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">])[</span><span class="s1">&#39;Revenue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Revenue by store and product:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store_product</span><span class="p">)</span>

<span class="c1"># 4. Unstack to reshape result</span>
<span class="n">store_product_unstacked</span> <span class="o">=</span> <span class="n">store_product</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Revenue by store and product (unstacked):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">store_product_unstacked</span><span class="p">)</span>

<span class="c1"># 5. Groupby with date components</span>
<span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">monthly_sales</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)[</span><span class="s1">&#39;Revenue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">5. Total monthly revenue:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">monthly_sales</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Advanced GroupBy Operations:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Filter groups based on a condition</span>
<span class="n">high_volume_products</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Units&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Products with more than 30 total units sold:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_volume_products</span><span class="p">[</span><span class="s1">&#39;Product&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="c1"># 2. Transform to fill missing values with group mean</span>
<span class="n">df_with_missing</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_with_missing</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">df_with_missing</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2a. DataFrame with missing values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_with_missing</span><span class="p">[</span><span class="n">df_with_missing</span><span class="p">[</span><span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()])</span>

<span class="c1"># Fill with product-specific means</span>
<span class="n">filled_df</span> <span class="o">=</span> <span class="n">df_with_missing</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">filled_df</span><span class="p">[</span><span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_with_missing</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Product&#39;</span><span class="p">)[</span><span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2b. After filling with product-specific means:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filled_df</span><span class="p">[</span><span class="n">df_with_missing</span><span class="p">[</span><span class="s1">&#39;Unit_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()])</span>

<span class="c1"># 3. Apply to manipulate each group</span>
<span class="k">def</span><span class="w"> </span><span class="nf">top_revenue_product</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">group</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Revenue&#39;</span><span class="p">)</span>

<span class="n">top_by_store</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Store&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">top_revenue_product</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Highest revenue product in each store:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top_by_store</span><span class="p">[[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenue&#39;</span><span class="p">]])</span>

<span class="c1"># 4. Calculating group-specific ranks</span>
<span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Revenue_Rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sales</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Store&#39;</span><span class="p">)[</span><span class="s1">&#39;Revenue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">top_sellers</span> <span class="o">=</span> <span class="n">sales</span><span class="p">[</span><span class="n">sales</span><span class="p">[</span><span class="s1">&#39;Revenue_Rank&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Top 2 sales by revenue in each store:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top_sellers</span><span class="p">[[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenue&#39;</span><span class="p">,</span> <span class="s1">&#39;Revenue_Rank&#39;</span><span class="p">]])</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-3">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>The GroupBy operation is one of the most powerful features in Pandas, inspired by the ‘split-apply-combine’ pattern from R.</p></li>
<li><p>First, data is split into groups based on one or more columns.</p></li>
<li><p>Next, operations are applied to each group independently.</p></li>
<li><p>Finally, results are combined back into a coherent structure.</p></li>
<li><p>This pattern is incredibly flexible - you can group by any column(s) and apply virtually any operation.”</p></li>
<li><p>The result of a groupby has a hierarchical index, which can be reshaped using <code class="docutils literal notranslate"><span class="pre">unstack()</span></code>.”</p></li>
<li><p>Beyond simple aggregations, groupby supports filtering, transformation, and applying custom functions to groups.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">transform()</span></code> method is particularly useful for filling missing values with group-specific statistics.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method allows for complex operations that operate on the entire group.</p></li>
<li><p>Groupby operations often form the backbone of business intelligence and reporting systems.</p></li>
</ul>
</div>
</div>
<div class="docutils">
</div>
</section>
</section>
<span id="document-15.Hands-on_expression_count_analysis"></span><section id="hands-on-rna-expression-analysis-alternative-method">
<h4>Hands-on: RNA Expression Analysis - alternative method<a class="headerlink" href="#hands-on-rna-expression-analysis-alternative-method" title="Link to this heading"></a></h4>
<section id="objectives">
<h5>Objectives<a class="headerlink" href="#objectives" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Examine differential expression of immune-related genes between patient groups previously classified as immunologically strong (‘istrong’) and immunologically weak (‘iweak’)</p></li>
<li><p>Apply an alternative analytical approach using Z-ratio methodology to complement standard differential expression tools like DESeq</p></li>
<li><p>Ranks immune-related genes based on their relative expression differences between the patient groups</p></li>
</ul>
</section>
<section id="rna-expression-analysis-steps">
<h5>RNA Expression Analysis Steps:<a class="headerlink" href="#rna-expression-analysis-steps" title="Link to this heading"></a></h5>
<ol class="arabic simple">
<li><p><strong>Data Loading and visualization</strong></p>
<ul class="simple">
<li><p>Load sample group information (iweak vs istrong)</p></li>
<li><p>Load gene expression count matrix</p></li>
<li><p>View first few rows/columns</p></li>
<li><p>View basic info</p></li>
</ul>
</li>
<li><p><strong>Sample Identification</strong></p>
<ul class="simple">
<li><p>Filter samples by group (iweak/istrong)</p></li>
<li><p>Match count matrix columns with sample IDs</p></li>
</ul>
</li>
<li><p><strong>Data Preprocessing</strong></p>
<ul class="simple">
<li><p>Convert count matrix to numeric values</p></li>
<li><p>Apply log2 transformation: log2(counts + 1)</p></li>
</ul>
</li>
<li><p><strong>Statistical Analysis</strong></p>
<ul class="simple">
<li><p>Calculate mean and std for each gene within each group</p></li>
<li><p>Compute Z-scores within each sample group</p></li>
<li><p>Calculate Z-score differences between groups</p></li>
<li><p>Compute standard deviation of all differences</p></li>
</ul>
</li>
<li><p><strong>Ranking Genes</strong></p>
<ul class="simple">
<li><p>Calculate Z-ratio: difference / std_difference</p></li>
<li><p>Rank genes by Z-ratio (highest to lowest)</p></li>
</ul>
</li>
</ol>
<p>This workflow standardizes the comparison between sample groups by accounting for the overall variability in gene expression across the entire experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-loading-and-visualization">
<h5>1. <strong>Data Loading and visualization</strong><a class="headerlink" href="#data-loading-and-visualization" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Load sample group information (iweak vs istrong)</p></li>
<li><p>Load gene expression count matrix</p></li>
<li><p>View first few rows/columns</p></li>
<li><p>View basic info</p></li>
</ul>
<section id="load-sample-group-information-iweak-vs-istrong">
<h6>Load sample group information (iweak vs istrong)<a class="headerlink" href="#load-sample-group-information-iweak-vs-istrong" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;test_data/Sample_group_info.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sample&quot;</span><span class="p">,</span> <span class="s2">&quot;Group&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Samples and Groups:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataframe info:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sample_info</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Number of samples in each group:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample_info</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Samples and Groups:
         Sample    Group
0  SH_TS_BC111    iweak
1  SH_TS_BC112    iweak
2  SH_TS_BC113    iweak
3  SH_TS_BC119  istrong
4  SH_TS_BC133    iweak
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 303 entries, 0 to 302
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   Sample  303 non-null    object
 1   Group   303 non-null    object
dtypes: object(2)
memory usage: 4.9+ KB
Dataframe info:
 None

Number of samples in each group:
Group
istrong    154
iweak      149
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-gene-expression-count-matrix">
<h6>Load gene expression count matrix<a class="headerlink" href="#load-gene-expression-count-matrix" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;test_data/count_matrix_with_row_indices.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Count matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataframe info:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Descriptive statistics (First 5 samples):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Count matrix:
           SH_TS_BC_C1  SH_TS_BC_C11  SH_TS_BC_C15  SH_TS_BC_C3  SH_TS_BC01
Gene                                                                      
ACTR3B             25           559           231           44          23
ANLN              173          2475           886          320           6
APOBEC3G          114          8806          2781          537          47
AURKA             626          7492          2829          564          14
BAG1              317          5949          2357          275          26
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 80 entries, ACTR3B to VEGFA
Columns: 483 entries, SH_TS_BC_C1 to UNC_TGS_BC_Y90_R1
dtypes: int64(483)
memory usage: 302.5+ KB
Dataframe info:
 None
Descriptive statistics (First 5 samples):
         SH_TS_BC_C1  SH_TS_BC_C11  SH_TS_BC_C15   SH_TS_BC_C3   SH_TS_BC01
count     80.000000      80.00000     80.000000     80.000000    80.000000
mean    1118.700000   20114.17500   6846.137500   1403.150000   126.212500
std     2627.440095   42620.73209  13895.968032   2411.549117   329.326881
min        1.000000      13.00000      6.000000      0.000000     0.000000
25%       58.500000    1758.50000    692.500000    207.000000     3.750000
50%      265.000000    5481.00000   1903.500000    529.000000    22.000000
75%      849.500000   15620.50000   5396.750000   1142.000000   100.250000
max    15912.000000  239031.00000  79955.000000  12397.000000  2352.000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of NaN values in each column:&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of NaN values in the dataframe:&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of NaN values in each column: SH_TS_BC_C1          0
SH_TS_BC_C11         0
SH_TS_BC_C15         0
SH_TS_BC_C3          0
SH_TS_BC01           0
                    ..
UNC_TGS_BC_9m        0
UNC_TGS_BC_Y23       0
UNC_TGS_BC_Y23_R1    0
UNC_TGS_BC_Y90       0
UNC_TGS_BC_Y90_R1    0
Length: 483, dtype: int64
Number of NaN values in the dataframe: 0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="sample-identification">
<h5>2. <strong>Sample Identification</strong><a class="headerlink" href="#sample-identification" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Filter samples by group (iweak/istrong)</p></li>
<li><p>Match count matrix columns with sample IDs</p></li>
</ul>
<section id="filter-samples-and-match-count-matrix-iweak">
<h6>Filter samples and match count matrix - iweak<a class="headerlink" href="#filter-samples-and-match-count-matrix-iweak" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display info about iweak samples</span>
<span class="n">iweak_samples</span> <span class="o">=</span> <span class="n">sample_info</span><span class="p">[</span><span class="n">sample_info</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;iweak&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak samples:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iweak_samples</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of iweak samples:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">iweak_samples</span><span class="p">))</span>
<span class="c1"># Display info about iweak samples</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak samples:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iweak_samples</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iweak samples:
        Sample  Group
0  SH_TS_BC111  iweak
1  SH_TS_BC112  iweak
2  SH_TS_BC113  iweak
4  SH_TS_BC133  iweak
5  SH_TS_BC134  iweak
Number of iweak samples: 149
iweak samples:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 149 entries, 0 to 302
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   Sample  149 non-null    object
 1   Group   149 non-null    object
dtypes: object(2)
memory usage: 3.5+ KB
None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify columns that match iweak sample IDs</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Samples in count matrix (first 10):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Type of count_matrix.columns:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="c1">## `pandas.core.indexes.base.Index` is not a NumPy ndarray, but it is built on top of NumPy arrays.</span>
<span class="c1">## In other words, while a Pandas Index can store data in a way that is compatible with NumPy</span>
<span class="c1">## `pandas.core.indexes.base.Index`  it is a separate object that provides additional functionality specific to indexing and more complex operations suited for Pandas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Samples in count matrix (first 10):
 Index([&#39;SH_TS_BC_C1&#39;, &#39;SH_TS_BC_C11&#39;, &#39;SH_TS_BC_C15&#39;, &#39;SH_TS_BC_C3&#39;,
       &#39;SH_TS_BC01&#39;, &#39;SH_TS_BC010_1&#39;, &#39;SH_TS_BC010_2&#39;, &#39;SH_TS_BC02&#39;,
       &#39;SH_TS_BC04&#39;, &#39;SH_TS_BC05&#39;],
      dtype=&#39;object&#39;)
Data Type of count_matrix.columns: &lt;class &#39;pandas.core.indexes.base.Index&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iweak_cols</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">iweak_samples</span><span class="p">[</span><span class="s2">&quot;Sample&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak column mask (first 10):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">iweak_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of iweak columns in iweak column mask:&quot;</span><span class="p">,</span> <span class="n">iweak_cols</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="c1"># print(&quot;Number of iweak columns in count matrix:&quot;, len(iweak_cols[iweak_cols]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">iweak column mask (first 30):&quot;</span><span class="p">,</span> <span class="n">iweak_cols</span><span class="p">[:</span><span class="mi">30</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First 30 columns of iweak: </span><span class="si">{</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">iweak_cols</span><span class="p">][:</span><span class="mi">30</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2"> Total number of iweak columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">iweak_cols</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iweak column mask (first 10):
[False False False False False False False False False False]
Number of iweak columns in iweak column mask: 54

iweak column mask (first 30): [False False False False False False False False False False False False
 False False False False False False False False False False False False
 False  True  True  True False False]
First 30 columns of iweak: Index([&#39;SH_TS_BC111&#39;, &#39;SH_TS_BC112&#39;, &#39;SH_TS_BC113&#39;, &#39;SH_TS_BC133&#39;,
       &#39;SH_TS_BC134&#39;, &#39;SH_TS_BC139&#39;, &#39;SH_TS_BC141&#39;, &#39;SH_TS_BC146&#39;,
       &#39;SH_TS_BC147&#39;, &#39;SH_TS_BC152&#39;, &#39;SH_TS_BC154&#39;, &#39;SH_TS_BC155&#39;,
       &#39;SH_TS_BC160&#39;, &#39;SH_TS_BC161&#39;, &#39;SH_TS_BC163&#39;, &#39;SH_TS_BC169&#39;,
       &#39;SH_TS_BC172&#39;, &#39;SH_TS_BC173&#39;, &#39;SH_TS_BC176&#39;, &#39;SH_TS_BC181&#39;,
       &#39;SH_TS_BC183&#39;, &#39;SH_TS_BC184&#39;, &#39;SH_TS_BC185&#39;, &#39;SH_TS_BC196&#39;,
       &#39;SH_TS_BC198&#39;, &#39;SH_TS_BC200&#39;, &#39;SH_TS_BC203&#39;, &#39;SH_TS_BC207&#39;,
       &#39;SH_TS_BC210&#39;, &#39;SH_TS_BC212&#39;],
      dtype=&#39;object&#39;)       
 Total number of iweak columns: 54
</pre></div>
</div>
</div>
</div>
</section>
<section id="filter-samples-and-match-count-matrix-istrong">
<h6>Filter samples and match count matrix - istrong<a class="headerlink" href="#filter-samples-and-match-count-matrix-istrong" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display info about istrong samples</span>
<span class="n">istrong_samples</span> <span class="o">=</span> <span class="n">sample_info</span><span class="p">[</span><span class="n">sample_info</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;istrong&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">istrong samples:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">istrong_samples</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of iweak samples:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">istrong_samples</span><span class="p">))</span>
<span class="c1"># Display info about iweak samples</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iweak samples:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">istrong_samples</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>istrong samples:
         Sample    Group
3   SH_TS_BC119  istrong
10  SH_TS_BC150  istrong
11  SH_TS_BC151  istrong
13  SH_TS_BC153  istrong
19  SH_TS_BC165  istrong
Number of iweak samples: 154
iweak samples:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 154 entries, 3 to 301
Data columns (total 2 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   Sample  154 non-null    object
 1   Group   154 non-null    object
dtypes: object(2)
memory usage: 3.6+ KB
None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">istrong_cols</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">istrong_samples</span><span class="p">[</span><span class="s2">&quot;Sample&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;istrong column mask (first 10):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">istrong_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of istrong columns in istrong column mask:&quot;</span><span class="p">,</span> <span class="n">istrong_cols</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">istrong column mask (first 30):&quot;</span><span class="p">,</span> <span class="n">istrong_cols</span><span class="p">[:</span><span class="mi">30</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;First 30 columns of istrong: </span><span class="si">{</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">istrong_cols</span><span class="p">][:</span><span class="mi">30</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2"> Total number of istrong columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">istrong_cols</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>istrong column mask (first 10):
[False False False False False False False False False False]
Number of istrong columns in istrong column mask: 37

istrong column mask (first 30): [False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False]
First 30 columns of istrong: Index([&#39;SH_TS_BC119&#39;, &#39;SH_TS_BC150&#39;, &#39;SH_TS_BC151&#39;, &#39;SH_TS_BC153&#39;,
       &#39;SH_TS_BC165&#39;, &#39;SH_TS_BC166&#39;, &#39;SH_TS_BC170&#39;, &#39;SH_TS_BC171&#39;,
       &#39;SH_TS_BC175&#39;, &#39;SH_TS_BC177&#39;, &#39;SH_TS_BC178&#39;, &#39;SH_TS_BC180&#39;,
       &#39;SH_TS_BC182&#39;, &#39;SH_TS_BC188&#39;, &#39;SH_TS_BC193&#39;, &#39;SH_TS_BC199&#39;,
       &#39;SH_TS_BC202&#39;, &#39;SH_TS_BC204&#39;, &#39;SH_TS_BC209&#39;, &#39;SH_TS_BC211&#39;,
       &#39;SH_TS_BC219&#39;, &#39;SH_TS_BC233&#39;, &#39;SH_TS_BC235&#39;, &#39;SH_TS_BC240&#39;,
       &#39;SH_TS_BC249&#39;, &#39;SH_TS_BC252&#39;, &#39;SH_TS_BC255&#39;, &#39;SH_TS_BC265&#39;,
       &#39;SH_TS_BC266&#39;, &#39;SH_TS_BC272&#39;],
      dtype=&#39;object&#39;)       
 Total number of istrong columns: 37
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-preprocessing">
<h5>3. <strong>Data Preprocessing</strong><a class="headerlink" href="#data-preprocessing" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>Convert count matrix to numeric values</p></li>
<li><p>Apply log2 transformation: log2(counts + 1)</p></li>
</ul>
<p><strong>Convert cm to log scale:</strong></p>
<ul class="simple">
<li><p>Gene expression count data often contains zeros (genes that weren’t detected)</p></li>
<li><p>Since log₂(0) is mathematically undefined (negative infinity), we add 1 to every value</p></li>
<li><p>This is called a “pseudo-count” approach, creating what’s known as “log₂(counts+1)”</p></li>
<li><p>Differences in log space correspond to fold changes in original space</p>
<ul>
<li><p>A difference of 1 in log₂ space = a 2-fold change in original counts</p></li>
<li><p>A difference of 2 in log₂ space = a 4-fold change in original counts</p></li>
</ul>
</li>
</ul>
<section id="convert-count-matrix-to-numeric-values">
<h6>Convert count matrix to numeric values<a class="headerlink" href="#convert-count-matrix-to-numeric-values" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert count matrix to numeric values</span>
<span class="n">count_matrix</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
<span class="n">count_matrix</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 80 entries, ACTR3B to VEGFA
Columns: 483 entries, SH_TS_BC_C1 to UNC_TGS_BC_Y90_R1
dtypes: float64(483)
memory usage: 302.5+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Counts of zeros in each column:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Total zeros in count matrix:&quot;</span><span class="p">,</span>
    <span class="n">count_matrix</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Counts of zeros in each column:
SH_TS_BC_C1          0
SH_TS_BC_C11         0
SH_TS_BC_C15         0
SH_TS_BC_C3          3
SH_TS_BC01           5
                    ..
UNC_TGS_BC_9m        1
UNC_TGS_BC_Y23       4
UNC_TGS_BC_Y23_R1    9
UNC_TGS_BC_Y90       2
UNC_TGS_BC_Y90_R1    3
Length: 483, dtype: int64
Total zeros in count matrix: 3150
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">count_matrix</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NumPy matrix shape:&quot;</span><span class="p">,</span> <span class="n">np_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Counts of zeros in each column:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">np_matrix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total Counts of zeros in matrix:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">np_matrix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NumPy matrix shape: (80, 483)
Counts of zeros in each column: [ 0  0  0  3  5  4  3  2  6  6  2  4  4  4  1  4  0  0  8  0 16  1  0  1
  3 37  2  4  2  4  4  1  2  2  3  3  2  6 17 10 11  5  8  2  3  0  1  1
  5  3  4  2  2  4  1  1 18  2  4  1  8  0  0  3  1  1  5  6  2  3  6  4
  6 24 15  4  7 36  3 18 10 28  2 20  2  7  3  3  2  9 18  3  3  4  8  1
 11  3  5 13  6 20  6 16 17  3 17  2  6  2  5 18  9  3 14  2 13  2  0  0
  0  1  3  8 11  1  8 17  2  4  6 17 19 12  5 21  3 36  2  1  2  5 32  1
  0  1  0  1  0  7  2  1  1  6 11  1  1  0  3  7  0  2  9 11  6  5  4  1
 16  6  6  1  1  1  2  2  3  1  3  0  2  1  3  1  1  2  3  6  4  2 34  1
  1  2  2 12 24 20  3  2 13  2  2 21 10  1  8  3 18 19  4 23 35  1  2  3
 10  1  0  0  6  8  0  0  1  1  0  1  1  1  1  1  2 15  4  6  2 12  3 11
  3  3 17  8  8  1 14  6 18  7  0  1 16  8 16  3  7  6  6 13 24 15  3  6
 15  1  0  2  1 16  1  9  2  1  1  0  0  2  9  0  0  4  1  0 11  1 10  3
  0  7  0  3  0  2 24  2  8  1  2  0 18  4 17 26 22  9 20 21  1  7 10  2
 13  1 23  5 17  8  7 19 13 28 25 24 21 11  4  4  3 15  9  2 12 11 16  1
  0  8  7  9 11 12  6  5  0  7 14 12  7 22  4  7 13 19 13  6  0  3  2 15
 11  6  1 11  0  8  9  3  9 19  1  5  5  7  1  4  6  5  7  2  3  2  5  7
 13 17  0  1  6  4  0  0  1  2  3  9  2  8 11  2 36  7  1  0  3  8  2  0
  2 24  4  6 10  2  1  3 12  8  7  6 23  1 10  3  0 15  3 12  3  6  2  8
  8 26 21 13  8  5 16 18 19  9  2  3  2  4  3  2  2  9  1  1  0 21  1  1
  1  0  0  1  2  1  1  6  1  1  0  6  5  2  2  8  1  4  2  4  2  4  1  4
  9  2  3]
Total Counts of zeros in matrix: 3150
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-log2-transformation-log2-counts-1">
<h6>Apply log2 transformation: log2(counts + 1)<a class="headerlink" href="#apply-log2-transformation-log2-counts-1" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert count_matrix to log2</span>
<span class="n">count_matrix_log2</span> <span class="o">=</span> <span class="n">count_matrix</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Log2 transformed count matrix (first 5 rows &amp; columns):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log2 transformed count matrix info:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Log2 transformed count matrix descriptive statistics (first 5 samples):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 transformed count matrix (first 5 rows &amp; columns):
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           SH_TS_BC_C1  SH_TS_BC_C11  SH_TS_BC_C15  SH_TS_BC_C3  SH_TS_BC01
Gene                                                                      
ACTR3B       4.700440      9.129283      7.857981     5.491853    4.584963
ANLN         7.442943     11.273796      9.792790     8.326429    2.807355
APOBEC3G     6.845490     13.104435     11.441907     9.071462    5.584963
AURKA        9.292322     12.871328     11.466586     9.142107    3.906891
BAG1         8.312883     12.538674     11.203348     8.108524    4.754888
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 80 entries, ACTR3B to VEGFA
Columns: 483 entries, SH_TS_BC_C1 to UNC_TGS_BC_Y90_R1
dtypes: float64(483)
memory usage: 302.5+ KB
Log2 transformed count matrix info:
 None
Log2 transformed count matrix descriptive statistics (first 5 samples):
        SH_TS_BC_C1  SH_TS_BC_C11  SH_TS_BC_C15  SH_TS_BC_C3  SH_TS_BC01
count    80.000000     80.000000     80.000000    80.000000   80.000000
mean      7.777790     12.376603     10.938512     8.774008    4.519537
std       2.917182      2.540082      2.458104     2.686284    2.755204
min       1.000000      3.807355      2.807355     0.000000    0.000000
25%       5.894663     10.780910      9.436778     7.698564    2.241446
50%       8.049386     12.419880     10.895191     9.049684    4.523562
75%       9.732161     13.931187     12.398038    10.158550    6.661454
max      13.957918     17.866844     16.286919    13.597820   11.200286
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistical-analysis">
<h6>4. <strong>Statistical Analysis</strong><a class="headerlink" href="#statistical-analysis" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Calculate mean and std for each gene within each group</p></li>
<li><p>Compute Z-scores within each sample group</p></li>
<li><p>Calculate Z-score differences between groups &amp; SD of the Z-score difference</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;iweak_cols mask: </span><span class="si">{</span><span class="n">iweak_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2">istrong_cols mask: </span><span class="si">{</span><span class="n">istrong_cols</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2">Total number of iweak columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">iweak_cols</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">      </span><span class="se">\n</span><span class="s2">Total number of istrong columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">istrong_cols</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iweak_cols mask: [False False False False False False False False False False]       
istrong_cols mask: [False False False False False False False False False False]       
Total number of iweak columns: 54       
Total number of istrong columns: 37
</pre></div>
</div>
</div>
</div>
<section id="calculate-mean-and-std-for-each-gene-within-each-group">
<h6 aria-level="7">Calculate mean and std for each gene within each group<a class="headerlink" href="#calculate-mean-and-std-for-each-gene-within-each-group" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean log2 value for iweak and istrong samples</span>
<span class="n">mean_iweak</span> <span class="o">=</span> <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">iweak_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mean_istrong</span> <span class="o">=</span> <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">istrong_cols</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean log2 value for iweak samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mean_iweak</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean log2 value for istrong samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mean_istrong</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean log2 value for iweak samples (first 5 rows):
 Gene
ACTR3B      7.860318
ANLN        8.870121
APOBEC3G    8.839295
AURKA       9.873015
BAG1        8.818064
dtype: float64
Mean log2 value for istrong samples (first 5 rows):
 Gene
ACTR3B       6.994971
ANLN         6.953521
APOBEC3G    10.527763
AURKA        9.192108
BAG1         9.029261
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean log2 value for iweak and istrong samples</span>
<span class="n">std_iweak</span> <span class="o">=</span> <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">iweak_cols</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">std_istrong</span> <span class="o">=</span> <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">istrong_cols</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Standard deviation log2 value for iweak samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">std_iweak</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Standard deviation log2 value for istrong samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">std_istrong</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Standard deviation log2 value for iweak samples (first 5 rows):
 Gene
ACTR3B      1.995958
ANLN        1.554415
APOBEC3G    2.074605
AURKA       1.191852
BAG1        2.199874
dtype: float64
Standard deviation log2 value for istrong samples (first 5 rows):
 Gene
ACTR3B      2.319413
ANLN        2.843593
APOBEC3G    1.321013
AURKA       2.242906
BAG1        2.019663
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">mean_iweak</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80, 483) (80,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-z-scores-within-each-sample-group">
<h6 aria-level="7">Compute Z-scores within each sample group<a class="headerlink" href="#compute-z-scores-within-each-sample-group" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Z-scores for iweak samples</span>
<span class="c1">## Numpy like operations</span>
<span class="n">z_iweak</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">iweak_cols</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean_iweak</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">std_iweak</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-scores for iweak samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z_iweak</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-scores for iweak samples (first 5 rows):

          SH_TS_BC111  SH_TS_BC112  SH_TS_BC113  SH_TS_BC133  SH_TS_BC134
Gene                                                                     
ACTR3B      -0.798379    -0.735487    -0.920836     0.458160    -0.943426
ANLN        -1.188713    -2.057170     0.161741     0.227662    -5.063077
APOBEC3G    -4.260712     0.307752    -0.569305     0.264495    -1.499743
AURKA       -1.109424    -1.367487     0.168751     1.121313    -2.346097
BAG1        -4.008440    -0.285580    -0.185771     0.582435    -1.021972
</pre></div>
</div>
</div>
</div>
<p><strong>Z-score calculation using pandas built-in <code class="docutils literal notranslate"><span class="pre">sub</span></code> and <code class="docutils literal notranslate"><span class="pre">div</span></code> functions:</strong></p>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">sub()</span></code> and <code class="docutils literal notranslate"><span class="pre">div()</span></code>:</strong></em></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.sub()</span></code>: is pandas’ method to perform element-wise subtraction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.div()</span></code>: is pandas’ method to perform element-wise division</p></li>
<li><p>Accepts a value, series, dataframe to subtract</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis=</span></code> - specify the axis along which to perform the operation</p></li>
<li><p>This is the preferred method as it is more readable and less error-prone</p></li>
</ul>
<p><em><strong>Note:</strong></em>
When you perform operations like subtraction using the sub() method, pandas typically follows its broadcasting rules to align indices. This can sometimes lead to unintended behavior if the shapes of the Series or DataFrames don’t match.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Z-scores for iweak samples, using `sub` and `div`</span>

<span class="n">z_iweak</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">iweak_cols</span><span class="p">]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">mean_iweak</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">std_iweak</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-scores for iweak samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z_iweak</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Z-scores for iweak samples Rows (Genes) and Columns (samples):&quot;</span><span class="p">,</span> <span class="n">z_iweak</span><span class="o">.</span><span class="n">shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-scores for iweak samples (first 5 rows):
           SH_TS_BC111  SH_TS_BC112  SH_TS_BC113  SH_TS_BC133  SH_TS_BC134
Gene                                                                     
ACTR3B      -0.798379    -0.735487    -0.920836     0.458160    -0.943426
ANLN        -1.188713    -2.057170     0.161741     0.227662    -5.063077
APOBEC3G    -4.260712     0.307752    -0.569305     0.264495    -1.499743
AURKA       -1.109424    -1.367487     0.168751     1.121313    -2.346097
BAG1        -4.008440    -0.285580    -0.185771     0.582435    -1.021972

 Z-scores for iweak samples Rows (Genes) and Columns (samples): (80, 54)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Z-scores for istrong samples, using `sub` and `div`</span>

<span class="n">z_istrong</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">count_matrix_log2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">istrong_cols</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">mean_istrong</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">std_istrong</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-scores for iweak samples (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z_istrong</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Z-scores for iweak samples Rows (Genes) and Columns (samples):&quot;</span><span class="p">,</span> <span class="n">z_istrong</span><span class="o">.</span><span class="n">shape</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Z-scores for iweak samples (first 5 rows):
           SH_TS_BC119  SH_TS_BC150  SH_TS_BC151  SH_TS_BC153  SH_TS_BC165
Gene                                                                     
ACTR3B       0.251123     0.745681     0.473303     1.138150     0.310111
ANLN         0.963558    -0.046892     0.846965     1.049066     0.320252
APOBEC3G     0.135300     0.285290     1.097819     1.213074     0.762314
AURKA        0.438189     0.594938     0.731543     0.743076     0.704167
BAG1         0.293509     1.148990     0.992325     0.364224    -0.072595

 Z-scores for iweak samples Rows (Genes) and Columns (samples): (80, 37)
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-z-score-differences-between-groups-sd-of-the-z-score-difference">
<h6 aria-level="7">Calculate Z-score differences between groups &amp; SD of the Z-score difference<a class="headerlink" href="#calculate-z-score-differences-between-groups-sd-of-the-z-score-difference" title="Link to this heading"></a></h6>
<ol class="arabic simple">
<li><p>Calculate mean z-score for each gene in two groups</p></li>
<li><p>Calculate z-score difference of each group</p></li>
<li><p>Calculate the SD</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean z-score for each gene in two groups</span>
<span class="c1"># Calcualte z-score difference of each group</span>

<span class="n">z_diff</span> <span class="o">=</span> <span class="n">z_istrong</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">z_iweak</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of z_diff:&quot;</span><span class="p">,</span> <span class="n">z_diff</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-score difference (istrong - iweak) (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z_diff</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of z_diff: (80,)
Z-score difference (istrong - iweak) (first 5 rows):
 Gene
ACTR3B      1.345857e-15
ANLN       -1.994845e-17
APOBEC3G   -7.123653e-16
AURKA      -4.685386e-16
BAG1        1.760576e-15
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SD of z-score difference</span>
<span class="n">z_diff_std</span> <span class="o">=</span> <span class="n">z_diff</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Type of z_diff_std:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">z_diff_std</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard deviation of z-score difference:&quot;</span><span class="p">,</span> <span class="n">z_diff_std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type of z_diff_std: &lt;class &#39;numpy.float64&#39;&gt;
Standard deviation of z-score difference: 1.4956431674223958e-15
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ranking-genes">
<h6>5. <strong>Ranking Genes</strong><a class="headerlink" href="#ranking-genes" title="Link to this heading"></a></h6>
<ul class="simple">
<li><p>Calculate Z-ratio: difference / std_difference</p></li>
<li><p>Rank genes by Z-ratio (highest to lowest)</p></li>
</ul>
<section id="calculate-z-ratio-z-score-difference-std-difference">
<h6 aria-level="7">Calculate Z-ratio: Z-score difference / std_difference<a class="headerlink" href="#calculate-z-ratio-z-score-difference-std-difference" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score_ratios</span> <span class="o">=</span> <span class="n">z_diff</span> <span class="o">/</span> <span class="n">z_diff_std</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of z_score_ratios:&quot;</span><span class="p">,</span> <span class="n">z_score_ratios</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-score ratios (istrong - iweak) (first 5 rows):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z_score_ratios</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of z_score_ratios: (80,)
Z-score ratios (istrong - iweak) (first 5 rows):
 Gene
ACTR3B      0.899852
ANLN       -0.013338
APOBEC3G   -0.476294
AURKA      -0.313269
BAG1        1.177136
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="rank-genes-by-z-ratio-highest-to-lowest">
<h6 aria-level="7">Rank genes by Z-ratio (highest to lowest)<a class="headerlink" href="#rank-genes-by-z-ratio-highest-to-lowest" title="Link to this heading"></a></h6>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score_ratios</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gene
GAPDH      3.143055
CCL5       2.748459
CD68       2.222521
HLA-DMA    2.007418
MKI67      1.917063
             ...   
MDM2      -1.469024
UBE2C     -1.492727
PSMC4     -1.776938
TYMS      -2.403611
NUF2      -2.414980
Length: 80, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">z_score_ratios</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Z-score ratios (istrong - iweak)&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Genes&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Z-score ratios&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Z-score ratios (istrong - iweak)&#39;}, xlabel=&#39;Genes&#39;, ylabel=&#39;Z-score ratios&#39;&gt;
</pre></div>
</div>
<img alt="_images/522d5072b3f0f8e5d5ad0cf78d76dce25ea5d0c3f47c8686b8b8156c5f4defa3.png" src="_images/522d5072b3f0f8e5d5ad0cf78d76dce25ea5d0c3f47c8686b8b8156c5f4defa3.png" />
</div>
</div>
</section>
</section>
</section>
</section>
</div>
</section>
</section>
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/b458a48eed87eb03931a8ce6efcdd351/Sample_group_info.csv"><span class="xref download myst">Download Test dataset 1: Sample_group_info.csv</span></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/ab7de98031b77441be14a9d7ba21466c/count_matrix.csv"><span class="xref download myst">count_matrix.csv</span></a></p></li>
</ul>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>All Python dependencies are listed in the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file</p></li>
<li><p><a class="reference download internal" download="" href="_downloads/6e07c75c5056c3a45979cc281eab1202/requirements.txt"><span class="xref download myst">Download requirements.txt</span></a></p></li>
</ul>
<section id="setup-python-environment">
<h3>Setup Python environment<a class="headerlink" href="#setup-python-environment" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Install Python3</p></li>
<li><p>Create a work-folder for the course exercises and hands-on sessions (e.g. <code class="docutils literal notranslate"><span class="pre">biont_module1</span></code>)</p></li>
<li><p>Move the <code class="docutils literal notranslate"><span class="pre">biont_module1</span></code> workfolder and download the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file</p></li>
<li><p>Follow steps below</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># work-folder: ~/playground/biont_module1</span>

<span class="c1"># Create Python environment (use python v.3.11 or above)</span>
python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>venv

<span class="c1"># Activate Python environment</span>
<span class="nb">source</span><span class="w"> </span>venv/bin/activate

<span class="c1"># Upgrade pip (not mandatory)</span>
pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip

<span class="c1"># Install dependencies</span>
pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</section>
</section>
<section id="credits">
<h2>Credits<a class="headerlink" href="#credits" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://biont-training.eu/">BioNT - The Bio Network for Training</a></p></li>
<li><p><a class="reference external" href="https://www.naic.no">Norwegian AI Cloud</a></p></li>
<li><p><a class="reference external" href="https://www.usit.uio.no/english/about/organisation/rde/scs/">Scientific Computing Services, Department Informatics, University of Oslo</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Norwegian Ai Cloud.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>